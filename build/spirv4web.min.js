var SPIRV=function(e){"use strict";var t,i=function(){this.version=0,this.shader_model=0,this.es=!1,this.set_version=!1,this.set_shader_model=!1,this.set_es=!1,this.dump_resources=!1,this.force_temporary=!1,this.flatten_ubo=!1,this.fixup=!1,this.yflip=!1,this.sso=!1,this.support_nonzero_baseinstance=!0,this.glsl_emit_push_constant_as_ubo=!1,this.glsl_emit_ubo_as_plain_uniforms=!1,this.glsl_force_flattened_io_blocks=!1,this.glsl_unnamed_ubo_to_global_uniforms=!1,this.glsl_ovr_multiview_view_count=0,this.glsl_ext_framebuffer_fetch=[],this.glsl_ext_framebuffer_fetch_noncoherent=!1,this.emit_line_directives=!1,this.enable_storage_image_qualifier_deduction=!0,this.force_zero_initialized_variables=!1,this.pls_in=[],this.pls_out=[],this.remaps=[],this.extensions=[],this.variable_type_remaps=[],this.interface_variable_renames=[],this.masked_stage_outputs=[],this.masked_stage_builtins=[],this.entry_point_rename=[],this.cpp=!1,this.flatten_multidimensional_arrays=!1,this.use_420pack_extension=!0,this.remove_unused=!0,this.combined_samplers_inherit_bindings=!1},r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function o(e,t,i){if(i||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}function s(e,t){for(var i=new Array(e),r=0;r<e;++r)i[r]=t(r);return i}function n(e,t){var i=e.length;if(e.length!==t.length)return!1;for(var r=0;r<i;++r)if(e[r]!==t[r])return!1;return!0}function c(e){return e.reduce((function(e){return e+1}),0)}!function(e){e[e.TypeNone=0]="TypeNone",e[e.TypeType=1]="TypeType",e[e.TypeVariable=2]="TypeVariable",e[e.TypeConstant=3]="TypeConstant",e[e.TypeFunction=4]="TypeFunction",e[e.TypeFunctionPrototype=5]="TypeFunctionPrototype",e[e.TypeBlock=6]="TypeBlock",e[e.TypeExtension=7]="TypeExtension",e[e.TypeExpression=8]="TypeExpression",e[e.TypeConstantOp=9]="TypeConstantOp",e[e.TypeCombinedImageSampler=10]="TypeCombinedImageSampler",e[e.TypeAccessChain=11]="TypeAccessChain",e[e.TypeUndef=12]="TypeUndef",e[e.TypeString=13]="TypeString",e[e.TypeCount=14]="TypeCount"}(t||(t={}));var _=function(){function e(e){this.holder=null,this.type=t.TypeNone,this.allow_type_rewrite=!1,this.group=e,this.createdIn=(new Error).stack}return e.prototype.set=function(e,i){if(this.holder&&this.group.pools[this.type].deallocate_opaque(this.holder),this.holder=null,!this.allow_type_rewrite&&this.type!==t.TypeNone&&this.type!==i)throw e&&this.group.pools[i].deallocate_opaque(e),new Error("Overwriting a variant with new type.");this.holder=e,this.type=i,this.allow_type_rewrite=!1},e.prototype.allocate_and_set=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var r=this.group.pools[e],a=r.allocate.apply(r,t);return this.set(a,e),a},e.prototype.get=function(e){if(!this.holder)throw new Error("nullptr");if(e.type!==this.type)throw new Error("Bad cast");return this.holder},e.prototype.get_type=function(){return this.type},e.prototype.get_id=function(){return this.holder?this.holder.self:0},e.prototype.empty=function(){return!this.holder},e.prototype.reset=function(){this.holder&&this.group.pools[this.type].deallocate_opaque(this.holder),this.holder=null,this.type=t.TypeNone},e.prototype.set_allow_type_rewrite=function(){this.allow_type_rewrite=!0},e}();function p(e,t){return t.get(e)}function l(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return t.allocate_and_set.apply(t,o([e.type],i,!1))}var u=function(){this.pools=new Array(t.TypeCount)};function h(e,t){for(var i in e)e.hasOwnProperty(i)&&(t[i]=f(e[i]))}function d(e,t){var i=new e;return h(t,i),i}function f(e){if(Array.isArray(e))return e.map((function(e){return f(e)}));if(e instanceof Set){var t=new Set;return e.forEach((function(e){t.add(f(e))})),t}var i=typeof e;if("object"===i){if("function"==typeof e.clone)return e.clone();if(e instanceof Set){var r=new Set;return e.forEach((function(e){return r.add(e)})),r}if(e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof BigInt64Array||e instanceof BigUint64Array||e instanceof Float32Array||e instanceof Float64Array)return e.slice();throw new Error("The object ".concat(e," does not have a clone function."))}return"function"!==i?e:void 0}var m,g,b,y=function(){function e(e){void 0===e&&(e=0),this.higher=new Set,this.lower=e}return e.prototype.get=function(e){return e<32?0!=(this.lower&1<<e):this.higher.has(e)},e.prototype.set=function(e){e<32?this.lower|=1<<e:this.higher.add(e)},e.prototype.clear=function(e){e<32?this.lower&=~(1<<e):this.higher.delete(e)},e.prototype.get_lower=function(){return this.lower},e.prototype.reset=function(){this.lower=0,this.higher.clear()},e.prototype.merge_and=function(e){this.lower&=e.lower;var t=new Set;this.higher.forEach((function(i){e.higher.has(i)&&t.add(i)})),this.higher=t},e.prototype.merge_or=function(e){var t=this;this.lower|=e.lower,e.higher.forEach((function(e){return t.higher.add(e)}))},e.prototype.equals=function(e){return this.lower===e.lower&&function(e,t){if(e.size!==t.size)return!1;for(var i=e.values(),r=null;r=i.next().value;)if(!t.has(r))return!1;return!0}(this.higher,e.higher)},e.prototype.for_each_bit=function(e){for(var t=0;t<32;t++)this.lower&1<<t&&e(t);if(0!==this.higher.size){var i=Array.from(this.higher);i.sort(),i.forEach(e)}},e.prototype.empty=function(){return 0===this.lower&&0===this.higher.size},e.prototype.clone=function(){return d(e,this)},e}();!function(e){e[e.BuiltInPosition=0]="BuiltInPosition",e[e.BuiltInPointSize=1]="BuiltInPointSize",e[e.BuiltInClipDistance=3]="BuiltInClipDistance",e[e.BuiltInCullDistance=4]="BuiltInCullDistance",e[e.BuiltInVertexId=5]="BuiltInVertexId",e[e.BuiltInInstanceId=6]="BuiltInInstanceId",e[e.BuiltInPrimitiveId=7]="BuiltInPrimitiveId",e[e.BuiltInInvocationId=8]="BuiltInInvocationId",e[e.BuiltInLayer=9]="BuiltInLayer",e[e.BuiltInViewportIndex=10]="BuiltInViewportIndex",e[e.BuiltInTessLevelOuter=11]="BuiltInTessLevelOuter",e[e.BuiltInTessLevelInner=12]="BuiltInTessLevelInner",e[e.BuiltInTessCoord=13]="BuiltInTessCoord",e[e.BuiltInPatchVertices=14]="BuiltInPatchVertices",e[e.BuiltInFragCoord=15]="BuiltInFragCoord",e[e.BuiltInPointCoord=16]="BuiltInPointCoord",e[e.BuiltInFrontFacing=17]="BuiltInFrontFacing",e[e.BuiltInSampleId=18]="BuiltInSampleId",e[e.BuiltInSamplePosition=19]="BuiltInSamplePosition",e[e.BuiltInSampleMask=20]="BuiltInSampleMask",e[e.BuiltInFragDepth=22]="BuiltInFragDepth",e[e.BuiltInHelperInvocation=23]="BuiltInHelperInvocation",e[e.BuiltInNumWorkgroups=24]="BuiltInNumWorkgroups",e[e.BuiltInWorkgroupSize=25]="BuiltInWorkgroupSize",e[e.BuiltInWorkgroupId=26]="BuiltInWorkgroupId",e[e.BuiltInLocalInvocationId=27]="BuiltInLocalInvocationId",e[e.BuiltInGlobalInvocationId=28]="BuiltInGlobalInvocationId",e[e.BuiltInLocalInvocationIndex=29]="BuiltInLocalInvocationIndex",e[e.BuiltInWorkDim=30]="BuiltInWorkDim",e[e.BuiltInGlobalSize=31]="BuiltInGlobalSize",e[e.BuiltInEnqueuedWorkgroupSize=32]="BuiltInEnqueuedWorkgroupSize",e[e.BuiltInGlobalOffset=33]="BuiltInGlobalOffset",e[e.BuiltInGlobalLinearId=34]="BuiltInGlobalLinearId",e[e.BuiltInSubgroupSize=36]="BuiltInSubgroupSize",e[e.BuiltInSubgroupMaxSize=37]="BuiltInSubgroupMaxSize",e[e.BuiltInNumSubgroups=38]="BuiltInNumSubgroups",e[e.BuiltInNumEnqueuedSubgroups=39]="BuiltInNumEnqueuedSubgroups",e[e.BuiltInSubgroupId=40]="BuiltInSubgroupId",e[e.BuiltInSubgroupLocalInvocationId=41]="BuiltInSubgroupLocalInvocationId",e[e.BuiltInVertexIndex=42]="BuiltInVertexIndex",e[e.BuiltInInstanceIndex=43]="BuiltInInstanceIndex",e[e.BuiltInSubgroupEqMask=4416]="BuiltInSubgroupEqMask",e[e.BuiltInSubgroupEqMaskKHR=4416]="BuiltInSubgroupEqMaskKHR",e[e.BuiltInSubgroupGeMask=4417]="BuiltInSubgroupGeMask",e[e.BuiltInSubgroupGeMaskKHR=4417]="BuiltInSubgroupGeMaskKHR",e[e.BuiltInSubgroupGtMask=4418]="BuiltInSubgroupGtMask",e[e.BuiltInSubgroupGtMaskKHR=4418]="BuiltInSubgroupGtMaskKHR",e[e.BuiltInSubgroupLeMask=4419]="BuiltInSubgroupLeMask",e[e.BuiltInSubgroupLeMaskKHR=4419]="BuiltInSubgroupLeMaskKHR",e[e.BuiltInSubgroupLtMask=4420]="BuiltInSubgroupLtMask",e[e.BuiltInSubgroupLtMaskKHR=4420]="BuiltInSubgroupLtMaskKHR",e[e.BuiltInBaseVertex=4424]="BuiltInBaseVertex",e[e.BuiltInBaseInstance=4425]="BuiltInBaseInstance",e[e.BuiltInDrawIndex=4426]="BuiltInDrawIndex",e[e.BuiltInPrimitiveShadingRateKHR=4432]="BuiltInPrimitiveShadingRateKHR",e[e.BuiltInDeviceIndex=4438]="BuiltInDeviceIndex",e[e.BuiltInViewIndex=4440]="BuiltInViewIndex",e[e.BuiltInShadingRateKHR=4444]="BuiltInShadingRateKHR",e[e.BuiltInBaryCoordNoPerspAMD=4992]="BuiltInBaryCoordNoPerspAMD",e[e.BuiltInBaryCoordNoPerspCentroidAMD=4993]="BuiltInBaryCoordNoPerspCentroidAMD",e[e.BuiltInBaryCoordNoPerspSampleAMD=4994]="BuiltInBaryCoordNoPerspSampleAMD",e[e.BuiltInBaryCoordSmoothAMD=4995]="BuiltInBaryCoordSmoothAMD",e[e.BuiltInBaryCoordSmoothCentroidAMD=4996]="BuiltInBaryCoordSmoothCentroidAMD",e[e.BuiltInBaryCoordSmoothSampleAMD=4997]="BuiltInBaryCoordSmoothSampleAMD",e[e.BuiltInBaryCoordPullModelAMD=4998]="BuiltInBaryCoordPullModelAMD",e[e.BuiltInFragStencilRefEXT=5014]="BuiltInFragStencilRefEXT",e[e.BuiltInViewportMaskNV=5253]="BuiltInViewportMaskNV",e[e.BuiltInSecondaryPositionNV=5257]="BuiltInSecondaryPositionNV",e[e.BuiltInSecondaryViewportMaskNV=5258]="BuiltInSecondaryViewportMaskNV",e[e.BuiltInPositionPerViewNV=5261]="BuiltInPositionPerViewNV",e[e.BuiltInViewportMaskPerViewNV=5262]="BuiltInViewportMaskPerViewNV",e[e.BuiltInFullyCoveredEXT=5264]="BuiltInFullyCoveredEXT",e[e.BuiltInTaskCountNV=5274]="BuiltInTaskCountNV",e[e.BuiltInPrimitiveCountNV=5275]="BuiltInPrimitiveCountNV",e[e.BuiltInPrimitiveIndicesNV=5276]="BuiltInPrimitiveIndicesNV",e[e.BuiltInClipDistancePerViewNV=5277]="BuiltInClipDistancePerViewNV",e[e.BuiltInCullDistancePerViewNV=5278]="BuiltInCullDistancePerViewNV",e[e.BuiltInLayerPerViewNV=5279]="BuiltInLayerPerViewNV",e[e.BuiltInMeshViewCountNV=5280]="BuiltInMeshViewCountNV",e[e.BuiltInMeshViewIndicesNV=5281]="BuiltInMeshViewIndicesNV",e[e.BuiltInBaryCoordNV=5286]="BuiltInBaryCoordNV",e[e.BuiltInBaryCoordNoPerspNV=5287]="BuiltInBaryCoordNoPerspNV",e[e.BuiltInFragSizeEXT=5292]="BuiltInFragSizeEXT",e[e.BuiltInFragmentSizeNV=5292]="BuiltInFragmentSizeNV",e[e.BuiltInFragInvocationCountEXT=5293]="BuiltInFragInvocationCountEXT",e[e.BuiltInInvocationsPerPixelNV=5293]="BuiltInInvocationsPerPixelNV",e[e.BuiltInLaunchIdKHR=5319]="BuiltInLaunchIdKHR",e[e.BuiltInLaunchIdNV=5319]="BuiltInLaunchIdNV",e[e.BuiltInLaunchSizeKHR=5320]="BuiltInLaunchSizeKHR",e[e.BuiltInLaunchSizeNV=5320]="BuiltInLaunchSizeNV",e[e.BuiltInWorldRayOriginKHR=5321]="BuiltInWorldRayOriginKHR",e[e.BuiltInWorldRayOriginNV=5321]="BuiltInWorldRayOriginNV",e[e.BuiltInWorldRayDirectionKHR=5322]="BuiltInWorldRayDirectionKHR",e[e.BuiltInWorldRayDirectionNV=5322]="BuiltInWorldRayDirectionNV",e[e.BuiltInObjectRayOriginKHR=5323]="BuiltInObjectRayOriginKHR",e[e.BuiltInObjectRayOriginNV=5323]="BuiltInObjectRayOriginNV",e[e.BuiltInObjectRayDirectionKHR=5324]="BuiltInObjectRayDirectionKHR",e[e.BuiltInObjectRayDirectionNV=5324]="BuiltInObjectRayDirectionNV",e[e.BuiltInRayTminKHR=5325]="BuiltInRayTminKHR",e[e.BuiltInRayTminNV=5325]="BuiltInRayTminNV",e[e.BuiltInRayTmaxKHR=5326]="BuiltInRayTmaxKHR",e[e.BuiltInRayTmaxNV=5326]="BuiltInRayTmaxNV",e[e.BuiltInInstanceCustomIndexKHR=5327]="BuiltInInstanceCustomIndexKHR",e[e.BuiltInInstanceCustomIndexNV=5327]="BuiltInInstanceCustomIndexNV",e[e.BuiltInObjectToWorldKHR=5330]="BuiltInObjectToWorldKHR",e[e.BuiltInObjectToWorldNV=5330]="BuiltInObjectToWorldNV",e[e.BuiltInWorldToObjectKHR=5331]="BuiltInWorldToObjectKHR",e[e.BuiltInWorldToObjectNV=5331]="BuiltInWorldToObjectNV",e[e.BuiltInHitTNV=5332]="BuiltInHitTNV",e[e.BuiltInHitKindKHR=5333]="BuiltInHitKindKHR",e[e.BuiltInHitKindNV=5333]="BuiltInHitKindNV",e[e.BuiltInIncomingRayFlagsKHR=5351]="BuiltInIncomingRayFlagsKHR",e[e.BuiltInIncomingRayFlagsNV=5351]="BuiltInIncomingRayFlagsNV",e[e.BuiltInRayGeometryIndexKHR=5352]="BuiltInRayGeometryIndexKHR",e[e.BuiltInWarpsPerSMNV=5374]="BuiltInWarpsPerSMNV",e[e.BuiltInSMCountNV=5375]="BuiltInSMCountNV",e[e.BuiltInWarpIDNV=5376]="BuiltInWarpIDNV",e[e.BuiltInSMIDNV=5377]="BuiltInSMIDNV",e[e.BuiltInMax=2147483647]="BuiltInMax"}(m||(m={})),function(e){e[e.FPRoundingModeRTE=0]="FPRoundingModeRTE",e[e.FPRoundingModeRTZ=1]="FPRoundingModeRTZ",e[e.FPRoundingModeRTP=2]="FPRoundingModeRTP",e[e.FPRoundingModeRTN=3]="FPRoundingModeRTN",e[e.FPRoundingModeMax=2147483647]="FPRoundingModeMax"}(g||(g={})),function(e){e[e.SPIRVCrossDecorationBufferBlockRepacked=0]="SPIRVCrossDecorationBufferBlockRepacked",e[e.SPIRVCrossDecorationPhysicalTypeID=1]="SPIRVCrossDecorationPhysicalTypeID",e[e.SPIRVCrossDecorationPhysicalTypePacked=2]="SPIRVCrossDecorationPhysicalTypePacked",e[e.SPIRVCrossDecorationPaddingTarget=3]="SPIRVCrossDecorationPaddingTarget",e[e.SPIRVCrossDecorationInterfaceMemberIndex=4]="SPIRVCrossDecorationInterfaceMemberIndex",e[e.SPIRVCrossDecorationInterfaceOrigID=5]="SPIRVCrossDecorationInterfaceOrigID",e[e.SPIRVCrossDecorationResourceIndexPrimary=6]="SPIRVCrossDecorationResourceIndexPrimary",e[e.SPIRVCrossDecorationResourceIndexSecondary=7]="SPIRVCrossDecorationResourceIndexSecondary",e[e.SPIRVCrossDecorationResourceIndexTertiary=8]="SPIRVCrossDecorationResourceIndexTertiary",e[e.SPIRVCrossDecorationResourceIndexQuaternary=9]="SPIRVCrossDecorationResourceIndexQuaternary",e[e.SPIRVCrossDecorationExplicitOffset=10]="SPIRVCrossDecorationExplicitOffset",e[e.SPIRVCrossDecorationBuiltInDispatchBase=11]="SPIRVCrossDecorationBuiltInDispatchBase",e[e.SPIRVCrossDecorationDynamicImageSampler=12]="SPIRVCrossDecorationDynamicImageSampler",e[e.SPIRVCrossDecorationBuiltInStageInputSize=13]="SPIRVCrossDecorationBuiltInStageInputSize",e[e.SPIRVCrossDecorationTessIOOriginalInputTypeID=14]="SPIRVCrossDecorationTessIOOriginalInputTypeID",e[e.SPIRVCrossDecorationInterpolantComponentExpr=15]="SPIRVCrossDecorationInterpolantComponentExpr",e[e.SPIRVCrossDecorationCount=16]="SPIRVCrossDecorationCount"}(b||(b={}));var v,S=function(){function e(){this.flags=new y,this.values=new Uint32Array(b.SPIRVCrossDecorationCount)}return e.prototype.clone=function(){return d(e,this)},e}(),I=function(){function e(){this.alias="",this.qualified_alias="",this.hlsl_semantic="",this.decoration_flags=new y,this.builtin_type=m.BuiltInMax,this.location=0,this.component=0,this.set=0,this.binding=0,this.offset=0,this.xfb_buffer=0,this.xfb_stride=0,this.stream=0,this.array_stride=0,this.matrix_stride=0,this.input_attachment=0,this.spec_id=0,this.index=0,this.fp_rounding_mode=g.FPRoundingModeMax,this.builtin=!1,this.extended=new S}return e.prototype.clone=function(){return d(e,this)},e}(),x=function(){this.decoration=new I,this.members=[],this.decoration_word_offset=[],this.hlsl_is_magic_counter_buffer=!1,this.hlsl_magic_counter_buffer=0},O=function(){function e(e,t){this.owner=e,this.propName=t}return e.prototype.get=function(){return this.owner[this.propName]},e.prototype.set=function(e){this.owner[this.propName]=e},e}(),k=function(){function e(){this.self=0}return e.prototype.clone=function(e){var t=e.allocate(this);return h(this,t),t},e}();!function(e){e[e.StorageClassUniformConstant=0]="StorageClassUniformConstant",e[e.StorageClassInput=1]="StorageClassInput",e[e.StorageClassUniform=2]="StorageClassUniform",e[e.StorageClassOutput=3]="StorageClassOutput",e[e.StorageClassWorkgroup=4]="StorageClassWorkgroup",e[e.StorageClassCrossWorkgroup=5]="StorageClassCrossWorkgroup",e[e.StorageClassPrivate=6]="StorageClassPrivate",e[e.StorageClassFunction=7]="StorageClassFunction",e[e.StorageClassGeneric=8]="StorageClassGeneric",e[e.StorageClassPushConstant=9]="StorageClassPushConstant",e[e.StorageClassAtomicCounter=10]="StorageClassAtomicCounter",e[e.StorageClassImage=11]="StorageClassImage",e[e.StorageClassStorageBuffer=12]="StorageClassStorageBuffer",e[e.StorageClassCallableDataKHR=5328]="StorageClassCallableDataKHR",e[e.StorageClassCallableDataNV=5328]="StorageClassCallableDataNV",e[e.StorageClassIncomingCallableDataKHR=5329]="StorageClassIncomingCallableDataKHR",e[e.StorageClassIncomingCallableDataNV=5329]="StorageClassIncomingCallableDataNV",e[e.StorageClassRayPayloadKHR=5338]="StorageClassRayPayloadKHR",e[e.StorageClassRayPayloadNV=5338]="StorageClassRayPayloadNV",e[e.StorageClassHitAttributeKHR=5339]="StorageClassHitAttributeKHR",e[e.StorageClassHitAttributeNV=5339]="StorageClassHitAttributeNV",e[e.StorageClassIncomingRayPayloadKHR=5342]="StorageClassIncomingRayPayloadKHR",e[e.StorageClassIncomingRayPayloadNV=5342]="StorageClassIncomingRayPayloadNV",e[e.StorageClassShaderRecordBufferKHR=5343]="StorageClassShaderRecordBufferKHR",e[e.StorageClassShaderRecordBufferNV=5343]="StorageClassShaderRecordBufferNV",e[e.StorageClassPhysicalStorageBuffer=5349]="StorageClassPhysicalStorageBuffer",e[e.StorageClassPhysicalStorageBufferEXT=5349]="StorageClassPhysicalStorageBufferEXT",e[e.StorageClassCodeSectionINTEL=5605]="StorageClassCodeSectionINTEL",e[e.StorageClassMax=2147483647]="StorageClassMax"}(v||(v={}));var L,E=function(e){function i(t,r,a,o){void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=0);var s=e.call(this)||this;return s.basetype=0,s.storage=v.StorageClassGeneric,s.decoration=0,s.initializer=0,s.basevariable=0,s.compat_builtin=!1,s.statically_assigned=!1,s.static_expression=0,s.dependees=[],s.forwardable=!0,s.deferred_declaration=!1,s.phi_variable=!1,s.allocate_temporary_copy=!1,s.remapped_variable=!1,s.remapped_components=0,s.dominator=0,s.loop_variable=!1,s.loop_variable_enable=!1,s.parameter=null,t instanceof i?h(t,s):(s.basetype=t,s.storage=r,s.initializer=a,s.basevariable=o),s}return a(i,e),i.type=t.TypeVariable,i}(k);!function(e){e[e.Unknown=0]="Unknown",e[e.Void=1]="Void",e[e.Boolean=2]="Boolean",e[e.SByte=3]="SByte",e[e.UByte=4]="UByte",e[e.Short=5]="Short",e[e.UShort=6]="UShort",e[e.Int=7]="Int",e[e.UInt=8]="UInt",e[e.Int64=9]="Int64",e[e.UInt64=10]="UInt64",e[e.AtomicCounter=11]="AtomicCounter",e[e.Half=12]="Half",e[e.Float=13]="Float",e[e.Double=14]="Double",e[e.Struct=15]="Struct",e[e.Image=16]="Image",e[e.SampledImage=17]="SampledImage",e[e.Sampler=18]="Sampler",e[e.AccelerationStructure=19]="AccelerationStructure",e[e.RayQuery=20]="RayQuery",e[e.ControlPointArray=21]="ControlPointArray",e[e.Interpolant=22]="Interpolant",e[e.Char=23]="Char"}(L||(L={}));var C=function(){function e(){}return e.prototype.clone=function(){return d(e,this)},e.prototype.equals=function(e){return this.type===e.type&&this.dim===e.dim&&this.depth===e.depth&&this.arrayed===e.arrayed&&this.ms===e.ms&&this.sampled===e.sampled&&this.format===e.format&&this.access===e.access},e}(),w=function(e){function i(t){var i=e.call(this)||this;return i.basetype=L.Unknown,i.width=0,i.vecsize=1,i.columns=1,i.array=[],i.array_size_literal=[],i.pointer_depth=0,i.pointer=!1,i.forward_pointer=!1,i.storage=v.StorageClassGeneric,i.member_types=[],i.member_type_index_redirection=[],i.image=new C,i.type_alias=0,i.parent_type=0,i.member_name_cache=new Set,t&&h(t,i),i}return a(i,e),i.type=t.TypeType,i}(k),T=new Uint32Array(1);function D(e){return T[0]=e,T[0]}var R,M,B,A,N,P=new DataView(new ArrayBuffer(4)),G=function(){function e(){this.value=new ArrayBuffer(16),this._dataView=new DataView(this.value)}return Object.defineProperty(e.prototype,"u32",{get:function(){return this._dataView.getUint32(0)},set:function(e){this._dataView.setUint32(0,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"i32",{get:function(){return this._dataView.getInt32(0)},set:function(e){this._dataView.setInt32(0,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f32",{get:function(){return this._dataView.getFloat32(0)},set:function(e){this._dataView.setFloat32(0,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"u64",{get:function(){return this._dataView.getBigUint64(0)},set:function(e){this._dataView.setBigUint64(0,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"i64",{get:function(){return this._dataView.getBigInt64(0)},set:function(e){this._dataView.setBigInt64(0,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"f64",{get:function(){return this._dataView.getFloat64(0)},set:function(e){this._dataView.setFloat64(0,e)},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return d(e,this)},e}(),F=function(){function e(){this.vecsize=1,this.r=s(4,(function(){return new G})),this.id=s(4,(function(){return 0}))}return e.prototype.clone=function(){return d(e,this)},e}(),z=function(){function e(){this.columns=1,this.c=s(4,(function(){return new F})),this.id=s(4,(function(){return 0}))}return e.prototype.clone=function(){return d(e,this)},e}(),U=function(e){function i(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=e.call(this)||this;return a.constant_type=0,a.m=new z,a.specialization=!1,a.is_used_as_array_length=!1,a.is_used_as_lut=!1,a.subconstants=new Uint32Array,a.specialization_constant_macro_name="",0===t.length||(1===t.length?t[0]instanceof i?h(t[0],a):a._construct(t[0]):"bigint"==typeof t[1]?a._constructScalar64(t[0],t[1],t[2]):"number"==typeof t[1]?a._constructScalar32(t[0],t[1],t[2]):"number"==typeof t[1][0]?a._constructArray(t[0],t[1],t[2],t[3]):a._constructVecMat(t[0],t[1],t[2],t[3])),a}return a(i,e),i.prototype.f16_to_f32=function(e){var t=e>>15&1,i=e>>10&31,r=e>>0&1023;if(0===i){if(0===r)return P.setUint32(0,t<<31),P.getFloat32(0);for(;0==(1024&r);)r<<=1,i--;i++,r=D(r&D(-1025))}else if(31===i)return 0===r?(P.setUint32(0,t<<31|2139095040),P.getFloat32(0)):(P.setUint32(0,t<<31|2139095040|r<<13),P.getFloat32(0));return i+=112,r<<=13,P.setUint32(0,t<<31|i<<23|r),P.getFloat32(0)},i.prototype.specialization_constant_id=function(e,t){return void 0===t?this.m.id[e]:this.m.c[e].id[t]},i.prototype.scalar=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),this.m.c[e].r[t].u32},i.prototype.scalar_i16=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),65535&this.m.c[e].r[t].u32},i.prototype.scalar_u16=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),65535&this.m.c[e].r[t].u32},i.prototype.scalar_i8=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),255&this.m.c[e].r[t].u32},i.prototype.scalar_u8=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),255&this.m.c[e].r[t].u32},i.prototype.scalar_f16=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),this.f16_to_f32(this.scalar_u16(e,t))},i.prototype.scalar_f32=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),this.m.c[e].r[t].f32},i.prototype.scalar_i32=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),this.m.c[e].r[t].i32},i.prototype.scalar_f64=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),this.m.c[e].r[t].f64},i.prototype.scalar_i64=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),this.m.c[e].r[t].i64},i.prototype.scalar_u64=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),this.m.c[e].r[t].u64},i.prototype.vector=function(){return this.m.c[0]},i.prototype.vector_size=function(){return this.m.c[0].vecsize},i.prototype.columns=function(){return this.m.columns},i.prototype.make_null=function(e){this.m=new z,this.m.columns=e.columns;for(var t=0,i=this.m.c;t<i.length;t++){i[t].vecsize=e.vecsize}},i.prototype.constant_is_null=function(){if(this.specialization)return!1;if(0!==this.subconstants.length)return!1;for(var e=0;e<this.columns();e++)for(var t=0;t<this.vector_size();t++)if(this.scalar_u64(e,t)!==BigInt(0))return!1;return!0},i.prototype._construct=function(e){this.constant_type=e},i.prototype._constructArray=function(e,t,i,r){this.constant_type=e,this.specialization=r,this.subconstants=t.slice()},i.prototype._constructScalar32=function(e,t,i){this.constant_type=e,this.specialization=i,this.m.c[0].r[0].u32=t,this.m.c[0].vecsize=1,this.m.columns=1},i.prototype._constructScalar64=function(e,t,i){this.constant_type=e,this.specialization=i,this.m.c[0].r[0].u64=t,this.m.c[0].vecsize=1,this.m.columns=1},i.prototype._constructVecMat=function(e,t,i,r){if(this.constant_type=e,this.specialization=r,t[0].m.c[0].vecsize>1){this.m.columns=i;for(var a=0;a<i;a++)this.m.c[a]=t[a].m.c[0],t[a].specialization&&(this.m.id[a]=t[a].self)}else{this.m.c[0].vecsize=i,this.m.columns=1;for(a=0;a<i;a++)this.m.c[0].r[a]=t[a].m.c[0].r[0],t[a].specialization&&(this.m.c[0].id[a]=t[a].self)}},i.type=t.TypeConstant,i}(k),V=function(e){function i(t,r,a){var o=e.call(this)||this;return o.arguments=[],t instanceof i?h(t,o):(o.basetype=t,o.opcode=r,o.arguments=a.slice()),o}return a(i,e),i.type=t.TypeConstantOp,i}(k),H=function(e){function t(t){var i=e.call(this)||this;return i.classRef=t,i}return a(t,e),t.prototype.allocate=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=this.classRef).bind.apply(e,o([void 0],t,!1)))},t.prototype.deallocate=function(e){},t.prototype.deallocate_opaque=function(e){this.deallocate(e)},t.prototype.clear=function(){},t}((function(){})),q=function(){function e(e,t,i,r,a){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===a&&(a=!1),this.type=e,this.id=t,this.read_count=i,this.write_count=r,this.alias_global_variable=a}return e.prototype.clone=function(){return d(e,this)},e}(),K=function(){function e(e,t,i,r,a,o){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),this.id=e,this.image_id=t,this.sampler_id=i,this.global_image=r,this.global_sampler=a,this.depth=o}return e.prototype.clone=function(){return d(e,this)},e}(),X=function(){function e(){this.file_id=0,this.line_literal=0}return e.prototype.clone=function(){return d(e,this)},e}(),j=function(e){function i(t,r){var a=e.call(this)||this;return a.arguments=[],a.shadow_arguments=[],a.local_variables=[],a.entry_block=0,a.blocks=[],a.combined_parameters=[],a.entry_line=new X,a.fixup_hooks_out=[],a.fixup_hooks_in=[],a.constant_arrays_needed_on_stack=[],a.active=!1,a.flush_undeclared=!0,a.do_combined_parameters=!0,t instanceof i?h(t,a):(a.return_type=t,a.function_type=r),a}return a(i,e),i.prototype.add_local_variable=function(e){this.local_variables.push(e)},i.prototype.add_parameter=function(e,t,i){void 0===i&&(i=!1),this.arguments.push(new q(e,t,0,0,i))},i.type=t.TypeFunction,i}(k),W=function(e){function i(t){var r=e.call(this)||this;return r.parameter_types=[],t instanceof i?h(t,r):r.return_type=t,r}return a(i,e),i.type=t.TypeFunctionPrototype,i}(k);!function(e){e[e.Unknown=0]="Unknown",e[e.Direct=1]="Direct",e[e.Select=2]="Select",e[e.MultiSelect=3]="MultiSelect",e[e.Return=4]="Return",e[e.Unreachable=5]="Unreachable",e[e.Kill=6]="Kill",e[e.IgnoreIntersection=7]="IgnoreIntersection",e[e.TerminateRay=8]="TerminateRay"}(R||(R={})),function(e){e[e.MergeNone=0]="MergeNone",e[e.MergeLoop=1]="MergeLoop",e[e.MergeSelection=2]="MergeSelection"}(M||(M={})),function(e){e[e.HintNone=0]="HintNone",e[e.HintUnroll=1]="HintUnroll",e[e.HintDontUnroll=2]="HintDontUnroll",e[e.HintFlatten=3]="HintFlatten",e[e.HintDontFlatten=4]="HintDontFlatten"}(B||(B={})),function(e){e[e.MergeToSelectForLoop=0]="MergeToSelectForLoop",e[e.MergeToDirectForLoop=1]="MergeToDirectForLoop",e[e.MergeToSelectContinueForLoop=2]="MergeToSelectContinueForLoop"}(A||(A={})),function(e){e[e.ContinueNone=0]="ContinueNone",e[e.ForLoop=1]="ForLoop",e[e.WhileLoop=2]="WhileLoop",e[e.DoWhileLoop=3]="DoWhileLoop",e[e.ComplexLoop=4]="ComplexLoop"}(N||(N={}));var Q,Y=function(){function e(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),this.local_variable=e,this.parent=t,this.function_variable=i}return e.prototype.clone=function(){return d(e,this)},e}(),Z=function(){function e(e,t){void 0===e&&(e=BigInt(0)),void 0===t&&(t=0),this.value=e,this.block=t}return e.prototype.clone=function(){return d(e,this)},e}(),J=function(e){function i(t){var i=e.call(this)||this;return i.terminator=R.Unknown,i.merge=M.MergeNone,i.hint=B.HintNone,i.next_block=0,i.merge_block=0,i.continue_block=0,i.return_value=0,i.condition=0,i.true_block=0,i.false_block=0,i.default_block=0,i.ops=[],i.phi_variables=[],i.declare_temporary=[],i.potential_declare_temporary=[],i.cases_32bit=[],i.cases_64bit=[],i.disable_block_optimization=!1,i.complex_continue=!1,i.need_ladder_break=!1,i.ignore_phi_from_block=0,i.loop_dominator=0,i.dominated_variables=[],i.loop_variables=[],i.invalidate_expressions=[],t&&h(t,i),i}return a(i,e),i.type=t.TypeBlock,i.NoDominator=4294967295,i}(k);!function(e){e[e.Unsupported=0]="Unsupported",e[e.GLSL=1]="GLSL",e[e.SPV_debug_info=2]="SPV_debug_info",e[e.SPV_AMD_shader_ballot=3]="SPV_AMD_shader_ballot",e[e.SPV_AMD_shader_explicit_vertex_parameter=4]="SPV_AMD_shader_explicit_vertex_parameter",e[e.SPV_AMD_shader_trinary_minmax=5]="SPV_AMD_shader_trinary_minmax",e[e.SPV_AMD_gcn_shader=6]="SPV_AMD_gcn_shader"}(Q||(Q={}));var $,ee,te,ie,re,ae=function(e){function i(t){var r=e.call(this)||this;return t instanceof i?h(t,r):r.ext=t,r}return a(i,e),i.type=t.TypeExtension,i}(k),oe=function(e){function i(t,r,a){void 0===t&&(t="");var o=e.call(this)||this;return o.base_expression=0,o.expression="",o.expression_type=0,o.loaded_from=0,o.immutable=!1,o.need_transpose=!1,o.access_chain=!1,o.expression_dependencies=[],o.implied_read_expressions=[],o.emitted_loop_level=0,t instanceof i?h(t,o):(o.expression=t,o.expression_type=r,o.immutable=a),o}return a(i,e),i.type=t.TypeExpression,i}(k),se=function(e){function i(t,r,a){var o=e.call(this)||this;return t instanceof i?h(t,o):(o.combined_type=t,o.image=r,o.sampler=a),o}return a(i,e),i.type=t.TypeCombinedImageSampler,i}(k),ne=function(e){function i(t,r,a,o,s){void 0===t&&(t=0);var n=e.call(this)||this;return n.loaded_from=0,n.matrix_stride=0,n.array_stride=0,n.row_major_matrix=!1,n.immutable=!1,n.implied_read_expressions=[],t instanceof i?h(t,n):(n.basetype=t,n.storage=r,n.base=a,n.dynamic_index=o,n.static_index=s),n}return a(i,e),i.type=t.TypeAccessChain,i}(k),ce=function(e){function i(t){var r=e.call(this)||this;return t instanceof i?h(t,r):r.basetype=t,r}return a(i,e),i.type=t.TypeUndef,i}(k),_e=function(e){function i(t){var r=e.call(this)||this;return t instanceof i?h(t,r):r.str=t,r}return a(i,e),i.type=t.TypeString,i}(k);function pe(e,t,i){return e.substring(0,t)+i+e.substring(t+1)}function le(e,t,i){return void 0===t?e.toString():e.toString()+(i?"ll":"l")}!function(e){e[e.AddressingModelLogical=0]="AddressingModelLogical",e[e.AddressingModelPhysical32=1]="AddressingModelPhysical32",e[e.AddressingModelPhysical64=2]="AddressingModelPhysical64",e[e.AddressingModelPhysicalStorageBuffer64=5348]="AddressingModelPhysicalStorageBuffer64",e[e.AddressingModelPhysicalStorageBuffer64EXT=5348]="AddressingModelPhysicalStorageBuffer64EXT",e[e.AddressingModelMax=2147483647]="AddressingModelMax"}($||($={})),function(e){e[e.MemoryModelSimple=0]="MemoryModelSimple",e[e.MemoryModelGLSL450=1]="MemoryModelGLSL450",e[e.MemoryModelOpenCL=2]="MemoryModelOpenCL",e[e.MemoryModelVulkan=3]="MemoryModelVulkan",e[e.MemoryModelVulkanKHR=3]="MemoryModelVulkanKHR",e[e.MemoryModelMax=2147483647]="MemoryModelMax"}(ee||(ee={})),function(e){e[e.DecorationRelaxedPrecision=0]="DecorationRelaxedPrecision",e[e.DecorationSpecId=1]="DecorationSpecId",e[e.DecorationBlock=2]="DecorationBlock",e[e.DecorationBufferBlock=3]="DecorationBufferBlock",e[e.DecorationRowMajor=4]="DecorationRowMajor",e[e.DecorationColMajor=5]="DecorationColMajor",e[e.DecorationArrayStride=6]="DecorationArrayStride",e[e.DecorationMatrixStride=7]="DecorationMatrixStride",e[e.DecorationGLSLShared=8]="DecorationGLSLShared",e[e.DecorationGLSLPacked=9]="DecorationGLSLPacked",e[e.DecorationCPacked=10]="DecorationCPacked",e[e.DecorationBuiltIn=11]="DecorationBuiltIn",e[e.DecorationNoPerspective=13]="DecorationNoPerspective",e[e.DecorationFlat=14]="DecorationFlat",e[e.DecorationPatch=15]="DecorationPatch",e[e.DecorationCentroid=16]="DecorationCentroid",e[e.DecorationSample=17]="DecorationSample",e[e.DecorationInvariant=18]="DecorationInvariant",e[e.DecorationRestrict=19]="DecorationRestrict",e[e.DecorationAliased=20]="DecorationAliased",e[e.DecorationVolatile=21]="DecorationVolatile",e[e.DecorationConstant=22]="DecorationConstant",e[e.DecorationCoherent=23]="DecorationCoherent",e[e.DecorationNonWritable=24]="DecorationNonWritable",e[e.DecorationNonReadable=25]="DecorationNonReadable",e[e.DecorationUniform=26]="DecorationUniform",e[e.DecorationUniformId=27]="DecorationUniformId",e[e.DecorationSaturatedConversion=28]="DecorationSaturatedConversion",e[e.DecorationStream=29]="DecorationStream",e[e.DecorationLocation=30]="DecorationLocation",e[e.DecorationComponent=31]="DecorationComponent",e[e.DecorationIndex=32]="DecorationIndex",e[e.DecorationBinding=33]="DecorationBinding",e[e.DecorationDescriptorSet=34]="DecorationDescriptorSet",e[e.DecorationOffset=35]="DecorationOffset",e[e.DecorationXfbBuffer=36]="DecorationXfbBuffer",e[e.DecorationXfbStride=37]="DecorationXfbStride",e[e.DecorationFuncParamAttr=38]="DecorationFuncParamAttr",e[e.DecorationFPRoundingMode=39]="DecorationFPRoundingMode",e[e.DecorationFPFastMathMode=40]="DecorationFPFastMathMode",e[e.DecorationLinkageAttributes=41]="DecorationLinkageAttributes",e[e.DecorationNoContraction=42]="DecorationNoContraction",e[e.DecorationInputAttachmentIndex=43]="DecorationInputAttachmentIndex",e[e.DecorationAlignment=44]="DecorationAlignment",e[e.DecorationMaxByteOffset=45]="DecorationMaxByteOffset",e[e.DecorationAlignmentId=46]="DecorationAlignmentId",e[e.DecorationMaxByteOffsetId=47]="DecorationMaxByteOffsetId",e[e.DecorationNoSignedWrap=4469]="DecorationNoSignedWrap",e[e.DecorationNoUnsignedWrap=4470]="DecorationNoUnsignedWrap",e[e.DecorationExplicitInterpAMD=4999]="DecorationExplicitInterpAMD",e[e.DecorationOverrideCoverageNV=5248]="DecorationOverrideCoverageNV",e[e.DecorationPassthroughNV=5250]="DecorationPassthroughNV",e[e.DecorationViewportRelativeNV=5252]="DecorationViewportRelativeNV",e[e.DecorationSecondaryViewportRelativeNV=5256]="DecorationSecondaryViewportRelativeNV",e[e.DecorationPerPrimitiveNV=5271]="DecorationPerPrimitiveNV",e[e.DecorationPerViewNV=5272]="DecorationPerViewNV",e[e.DecorationPerTaskNV=5273]="DecorationPerTaskNV",e[e.DecorationPerVertexNV=5285]="DecorationPerVertexNV",e[e.DecorationNonUniform=5300]="DecorationNonUniform",e[e.DecorationNonUniformEXT=5300]="DecorationNonUniformEXT",e[e.DecorationRestrictPointer=5355]="DecorationRestrictPointer",e[e.DecorationRestrictPointerEXT=5355]="DecorationRestrictPointerEXT",e[e.DecorationAliasedPointer=5356]="DecorationAliasedPointer",e[e.DecorationAliasedPointerEXT=5356]="DecorationAliasedPointerEXT",e[e.DecorationReferencedIndirectlyINTEL=5602]="DecorationReferencedIndirectlyINTEL",e[e.DecorationCounterBuffer=5634]="DecorationCounterBuffer",e[e.DecorationHlslCounterBufferGOOGLE=5634]="DecorationHlslCounterBufferGOOGLE",e[e.DecorationHlslSemanticGOOGLE=5635]="DecorationHlslSemanticGOOGLE",e[e.DecorationUserSemantic=5635]="DecorationUserSemantic",e[e.DecorationUserTypeGOOGLE=5636]="DecorationUserTypeGOOGLE",e[e.DecorationRegisterINTEL=5825]="DecorationRegisterINTEL",e[e.DecorationMemoryINTEL=5826]="DecorationMemoryINTEL",e[e.DecorationNumbanksINTEL=5827]="DecorationNumbanksINTEL",e[e.DecorationBankwidthINTEL=5828]="DecorationBankwidthINTEL",e[e.DecorationMaxPrivateCopiesINTEL=5829]="DecorationMaxPrivateCopiesINTEL",e[e.DecorationSinglepumpINTEL=5830]="DecorationSinglepumpINTEL",e[e.DecorationDoublepumpINTEL=5831]="DecorationDoublepumpINTEL",e[e.DecorationMaxReplicatesINTEL=5832]="DecorationMaxReplicatesINTEL",e[e.DecorationSimpleDualPortINTEL=5833]="DecorationSimpleDualPortINTEL",e[e.DecorationMergeINTEL=5834]="DecorationMergeINTEL",e[e.DecorationBankBitsINTEL=5835]="DecorationBankBitsINTEL",e[e.DecorationForcePow2DepthINTEL=5836]="DecorationForcePow2DepthINTEL",e[e.DecorationMax=2147483647]="DecorationMax"}(te||(te={})),function(e){e[e.OpNop=0]="OpNop",e[e.OpUndef=1]="OpUndef",e[e.OpSourceContinued=2]="OpSourceContinued",e[e.OpSource=3]="OpSource",e[e.OpSourceExtension=4]="OpSourceExtension",e[e.OpName=5]="OpName",e[e.OpMemberName=6]="OpMemberName",e[e.OpString=7]="OpString",e[e.OpLine=8]="OpLine",e[e.OpExtension=10]="OpExtension",e[e.OpExtInstImport=11]="OpExtInstImport",e[e.OpExtInst=12]="OpExtInst",e[e.OpMemoryModel=14]="OpMemoryModel",e[e.OpEntryPoint=15]="OpEntryPoint",e[e.OpExecutionMode=16]="OpExecutionMode",e[e.OpCapability=17]="OpCapability",e[e.OpTypeVoid=19]="OpTypeVoid",e[e.OpTypeBool=20]="OpTypeBool",e[e.OpTypeInt=21]="OpTypeInt",e[e.OpTypeFloat=22]="OpTypeFloat",e[e.OpTypeVector=23]="OpTypeVector",e[e.OpTypeMatrix=24]="OpTypeMatrix",e[e.OpTypeImage=25]="OpTypeImage",e[e.OpTypeSampler=26]="OpTypeSampler",e[e.OpTypeSampledImage=27]="OpTypeSampledImage",e[e.OpTypeArray=28]="OpTypeArray",e[e.OpTypeRuntimeArray=29]="OpTypeRuntimeArray",e[e.OpTypeStruct=30]="OpTypeStruct",e[e.OpTypeOpaque=31]="OpTypeOpaque",e[e.OpTypePointer=32]="OpTypePointer",e[e.OpTypeFunction=33]="OpTypeFunction",e[e.OpTypeEvent=34]="OpTypeEvent",e[e.OpTypeDeviceEvent=35]="OpTypeDeviceEvent",e[e.OpTypeReserveId=36]="OpTypeReserveId",e[e.OpTypeQueue=37]="OpTypeQueue",e[e.OpTypePipe=38]="OpTypePipe",e[e.OpTypeForwardPointer=39]="OpTypeForwardPointer",e[e.OpConstantTrue=41]="OpConstantTrue",e[e.OpConstantFalse=42]="OpConstantFalse",e[e.OpConstant=43]="OpConstant",e[e.OpConstantComposite=44]="OpConstantComposite",e[e.OpConstantSampler=45]="OpConstantSampler",e[e.OpConstantNull=46]="OpConstantNull",e[e.OpSpecConstantTrue=48]="OpSpecConstantTrue",e[e.OpSpecConstantFalse=49]="OpSpecConstantFalse",e[e.OpSpecConstant=50]="OpSpecConstant",e[e.OpSpecConstantComposite=51]="OpSpecConstantComposite",e[e.OpSpecConstantOp=52]="OpSpecConstantOp",e[e.OpFunction=54]="OpFunction",e[e.OpFunctionParameter=55]="OpFunctionParameter",e[e.OpFunctionEnd=56]="OpFunctionEnd",e[e.OpFunctionCall=57]="OpFunctionCall",e[e.OpVariable=59]="OpVariable",e[e.OpImageTexelPointer=60]="OpImageTexelPointer",e[e.OpLoad=61]="OpLoad",e[e.OpStore=62]="OpStore",e[e.OpCopyMemory=63]="OpCopyMemory",e[e.OpCopyMemorySized=64]="OpCopyMemorySized",e[e.OpAccessChain=65]="OpAccessChain",e[e.OpInBoundsAccessChain=66]="OpInBoundsAccessChain",e[e.OpPtrAccessChain=67]="OpPtrAccessChain",e[e.OpArrayLength=68]="OpArrayLength",e[e.OpGenericPtrMemSemantics=69]="OpGenericPtrMemSemantics",e[e.OpInBoundsPtrAccessChain=70]="OpInBoundsPtrAccessChain",e[e.OpDecorate=71]="OpDecorate",e[e.OpMemberDecorate=72]="OpMemberDecorate",e[e.OpDecorationGroup=73]="OpDecorationGroup",e[e.OpGroupDecorate=74]="OpGroupDecorate",e[e.OpGroupMemberDecorate=75]="OpGroupMemberDecorate",e[e.OpVectorExtractDynamic=77]="OpVectorExtractDynamic",e[e.OpVectorInsertDynamic=78]="OpVectorInsertDynamic",e[e.OpVectorShuffle=79]="OpVectorShuffle",e[e.OpCompositeConstruct=80]="OpCompositeConstruct",e[e.OpCompositeExtract=81]="OpCompositeExtract",e[e.OpCompositeInsert=82]="OpCompositeInsert",e[e.OpCopyObject=83]="OpCopyObject",e[e.OpTranspose=84]="OpTranspose",e[e.OpSampledImage=86]="OpSampledImage",e[e.OpImageSampleImplicitLod=87]="OpImageSampleImplicitLod",e[e.OpImageSampleExplicitLod=88]="OpImageSampleExplicitLod",e[e.OpImageSampleDrefImplicitLod=89]="OpImageSampleDrefImplicitLod",e[e.OpImageSampleDrefExplicitLod=90]="OpImageSampleDrefExplicitLod",e[e.OpImageSampleProjImplicitLod=91]="OpImageSampleProjImplicitLod",e[e.OpImageSampleProjExplicitLod=92]="OpImageSampleProjExplicitLod",e[e.OpImageSampleProjDrefImplicitLod=93]="OpImageSampleProjDrefImplicitLod",e[e.OpImageSampleProjDrefExplicitLod=94]="OpImageSampleProjDrefExplicitLod",e[e.OpImageFetch=95]="OpImageFetch",e[e.OpImageGather=96]="OpImageGather",e[e.OpImageDrefGather=97]="OpImageDrefGather",e[e.OpImageRead=98]="OpImageRead",e[e.OpImageWrite=99]="OpImageWrite",e[e.OpImage=100]="OpImage",e[e.OpImageQueryFormat=101]="OpImageQueryFormat",e[e.OpImageQueryOrder=102]="OpImageQueryOrder",e[e.OpImageQuerySizeLod=103]="OpImageQuerySizeLod",e[e.OpImageQuerySize=104]="OpImageQuerySize",e[e.OpImageQueryLod=105]="OpImageQueryLod",e[e.OpImageQueryLevels=106]="OpImageQueryLevels",e[e.OpImageQuerySamples=107]="OpImageQuerySamples",e[e.OpConvertFToU=109]="OpConvertFToU",e[e.OpConvertFToS=110]="OpConvertFToS",e[e.OpConvertSToF=111]="OpConvertSToF",e[e.OpConvertUToF=112]="OpConvertUToF",e[e.OpUConvert=113]="OpUConvert",e[e.OpSConvert=114]="OpSConvert",e[e.OpFConvert=115]="OpFConvert",e[e.OpQuantizeToF16=116]="OpQuantizeToF16",e[e.OpConvertPtrToU=117]="OpConvertPtrToU",e[e.OpSatConvertSToU=118]="OpSatConvertSToU",e[e.OpSatConvertUToS=119]="OpSatConvertUToS",e[e.OpConvertUToPtr=120]="OpConvertUToPtr",e[e.OpPtrCastToGeneric=121]="OpPtrCastToGeneric",e[e.OpGenericCastToPtr=122]="OpGenericCastToPtr",e[e.OpGenericCastToPtrExplicit=123]="OpGenericCastToPtrExplicit",e[e.OpBitcast=124]="OpBitcast",e[e.OpSNegate=126]="OpSNegate",e[e.OpFNegate=127]="OpFNegate",e[e.OpIAdd=128]="OpIAdd",e[e.OpFAdd=129]="OpFAdd",e[e.OpISub=130]="OpISub",e[e.OpFSub=131]="OpFSub",e[e.OpIMul=132]="OpIMul",e[e.OpFMul=133]="OpFMul",e[e.OpUDiv=134]="OpUDiv",e[e.OpSDiv=135]="OpSDiv",e[e.OpFDiv=136]="OpFDiv",e[e.OpUMod=137]="OpUMod",e[e.OpSRem=138]="OpSRem",e[e.OpSMod=139]="OpSMod",e[e.OpFRem=140]="OpFRem",e[e.OpFMod=141]="OpFMod",e[e.OpVectorTimesScalar=142]="OpVectorTimesScalar",e[e.OpMatrixTimesScalar=143]="OpMatrixTimesScalar",e[e.OpVectorTimesMatrix=144]="OpVectorTimesMatrix",e[e.OpMatrixTimesVector=145]="OpMatrixTimesVector",e[e.OpMatrixTimesMatrix=146]="OpMatrixTimesMatrix",e[e.OpOuterProduct=147]="OpOuterProduct",e[e.OpDot=148]="OpDot",e[e.OpIAddCarry=149]="OpIAddCarry",e[e.OpISubBorrow=150]="OpISubBorrow",e[e.OpUMulExtended=151]="OpUMulExtended",e[e.OpSMulExtended=152]="OpSMulExtended",e[e.OpAny=154]="OpAny",e[e.OpAll=155]="OpAll",e[e.OpIsNan=156]="OpIsNan",e[e.OpIsInf=157]="OpIsInf",e[e.OpIsFinite=158]="OpIsFinite",e[e.OpIsNormal=159]="OpIsNormal",e[e.OpSignBitSet=160]="OpSignBitSet",e[e.OpLessOrGreater=161]="OpLessOrGreater",e[e.OpOrdered=162]="OpOrdered",e[e.OpUnordered=163]="OpUnordered",e[e.OpLogicalEqual=164]="OpLogicalEqual",e[e.OpLogicalNotEqual=165]="OpLogicalNotEqual",e[e.OpLogicalOr=166]="OpLogicalOr",e[e.OpLogicalAnd=167]="OpLogicalAnd",e[e.OpLogicalNot=168]="OpLogicalNot",e[e.OpSelect=169]="OpSelect",e[e.OpIEqual=170]="OpIEqual",e[e.OpINotEqual=171]="OpINotEqual",e[e.OpUGreaterThan=172]="OpUGreaterThan",e[e.OpSGreaterThan=173]="OpSGreaterThan",e[e.OpUGreaterThanEqual=174]="OpUGreaterThanEqual",e[e.OpSGreaterThanEqual=175]="OpSGreaterThanEqual",e[e.OpULessThan=176]="OpULessThan",e[e.OpSLessThan=177]="OpSLessThan",e[e.OpULessThanEqual=178]="OpULessThanEqual",e[e.OpSLessThanEqual=179]="OpSLessThanEqual",e[e.OpFOrdEqual=180]="OpFOrdEqual",e[e.OpFUnordEqual=181]="OpFUnordEqual",e[e.OpFOrdNotEqual=182]="OpFOrdNotEqual",e[e.OpFUnordNotEqual=183]="OpFUnordNotEqual",e[e.OpFOrdLessThan=184]="OpFOrdLessThan",e[e.OpFUnordLessThan=185]="OpFUnordLessThan",e[e.OpFOrdGreaterThan=186]="OpFOrdGreaterThan",e[e.OpFUnordGreaterThan=187]="OpFUnordGreaterThan",e[e.OpFOrdLessThanEqual=188]="OpFOrdLessThanEqual",e[e.OpFUnordLessThanEqual=189]="OpFUnordLessThanEqual",e[e.OpFOrdGreaterThanEqual=190]="OpFOrdGreaterThanEqual",e[e.OpFUnordGreaterThanEqual=191]="OpFUnordGreaterThanEqual",e[e.OpShiftRightLogical=194]="OpShiftRightLogical",e[e.OpShiftRightArithmetic=195]="OpShiftRightArithmetic",e[e.OpShiftLeftLogical=196]="OpShiftLeftLogical",e[e.OpBitwiseOr=197]="OpBitwiseOr",e[e.OpBitwiseXor=198]="OpBitwiseXor",e[e.OpBitwiseAnd=199]="OpBitwiseAnd",e[e.OpNot=200]="OpNot",e[e.OpBitFieldInsert=201]="OpBitFieldInsert",e[e.OpBitFieldSExtract=202]="OpBitFieldSExtract",e[e.OpBitFieldUExtract=203]="OpBitFieldUExtract",e[e.OpBitReverse=204]="OpBitReverse",e[e.OpBitCount=205]="OpBitCount",e[e.OpDPdx=207]="OpDPdx",e[e.OpDPdy=208]="OpDPdy",e[e.OpFwidth=209]="OpFwidth",e[e.OpDPdxFine=210]="OpDPdxFine",e[e.OpDPdyFine=211]="OpDPdyFine",e[e.OpFwidthFine=212]="OpFwidthFine",e[e.OpDPdxCoarse=213]="OpDPdxCoarse",e[e.OpDPdyCoarse=214]="OpDPdyCoarse",e[e.OpFwidthCoarse=215]="OpFwidthCoarse",e[e.OpEmitVertex=218]="OpEmitVertex",e[e.OpEndPrimitive=219]="OpEndPrimitive",e[e.OpEmitStreamVertex=220]="OpEmitStreamVertex",e[e.OpEndStreamPrimitive=221]="OpEndStreamPrimitive",e[e.OpControlBarrier=224]="OpControlBarrier",e[e.OpMemoryBarrier=225]="OpMemoryBarrier",e[e.OpAtomicLoad=227]="OpAtomicLoad",e[e.OpAtomicStore=228]="OpAtomicStore",e[e.OpAtomicExchange=229]="OpAtomicExchange",e[e.OpAtomicCompareExchange=230]="OpAtomicCompareExchange",e[e.OpAtomicCompareExchangeWeak=231]="OpAtomicCompareExchangeWeak",e[e.OpAtomicIIncrement=232]="OpAtomicIIncrement",e[e.OpAtomicIDecrement=233]="OpAtomicIDecrement",e[e.OpAtomicIAdd=234]="OpAtomicIAdd",e[e.OpAtomicISub=235]="OpAtomicISub",e[e.OpAtomicSMin=236]="OpAtomicSMin",e[e.OpAtomicUMin=237]="OpAtomicUMin",e[e.OpAtomicSMax=238]="OpAtomicSMax",e[e.OpAtomicUMax=239]="OpAtomicUMax",e[e.OpAtomicAnd=240]="OpAtomicAnd",e[e.OpAtomicOr=241]="OpAtomicOr",e[e.OpAtomicXor=242]="OpAtomicXor",e[e.OpPhi=245]="OpPhi",e[e.OpLoopMerge=246]="OpLoopMerge",e[e.OpSelectionMerge=247]="OpSelectionMerge",e[e.OpLabel=248]="OpLabel",e[e.OpBranch=249]="OpBranch",e[e.OpBranchConditional=250]="OpBranchConditional",e[e.OpSwitch=251]="OpSwitch",e[e.OpKill=252]="OpKill",e[e.OpReturn=253]="OpReturn",e[e.OpReturnValue=254]="OpReturnValue",e[e.OpUnreachable=255]="OpUnreachable",e[e.OpLifetimeStart=256]="OpLifetimeStart",e[e.OpLifetimeStop=257]="OpLifetimeStop",e[e.OpGroupAsyncCopy=259]="OpGroupAsyncCopy",e[e.OpGroupWaitEvents=260]="OpGroupWaitEvents",e[e.OpGroupAll=261]="OpGroupAll",e[e.OpGroupAny=262]="OpGroupAny",e[e.OpGroupBroadcast=263]="OpGroupBroadcast",e[e.OpGroupIAdd=264]="OpGroupIAdd",e[e.OpGroupFAdd=265]="OpGroupFAdd",e[e.OpGroupFMin=266]="OpGroupFMin",e[e.OpGroupUMin=267]="OpGroupUMin",e[e.OpGroupSMin=268]="OpGroupSMin",e[e.OpGroupFMax=269]="OpGroupFMax",e[e.OpGroupUMax=270]="OpGroupUMax",e[e.OpGroupSMax=271]="OpGroupSMax",e[e.OpReadPipe=274]="OpReadPipe",e[e.OpWritePipe=275]="OpWritePipe",e[e.OpReservedReadPipe=276]="OpReservedReadPipe",e[e.OpReservedWritePipe=277]="OpReservedWritePipe",e[e.OpReserveReadPipePackets=278]="OpReserveReadPipePackets",e[e.OpReserveWritePipePackets=279]="OpReserveWritePipePackets",e[e.OpCommitReadPipe=280]="OpCommitReadPipe",e[e.OpCommitWritePipe=281]="OpCommitWritePipe",e[e.OpIsValidReserveId=282]="OpIsValidReserveId",e[e.OpGetNumPipePackets=283]="OpGetNumPipePackets",e[e.OpGetMaxPipePackets=284]="OpGetMaxPipePackets",e[e.OpGroupReserveReadPipePackets=285]="OpGroupReserveReadPipePackets",e[e.OpGroupReserveWritePipePackets=286]="OpGroupReserveWritePipePackets",e[e.OpGroupCommitReadPipe=287]="OpGroupCommitReadPipe",e[e.OpGroupCommitWritePipe=288]="OpGroupCommitWritePipe",e[e.OpEnqueueMarker=291]="OpEnqueueMarker",e[e.OpEnqueueKernel=292]="OpEnqueueKernel",e[e.OpGetKernelNDrangeSubGroupCount=293]="OpGetKernelNDrangeSubGroupCount",e[e.OpGetKernelNDrangeMaxSubGroupSize=294]="OpGetKernelNDrangeMaxSubGroupSize",e[e.OpGetKernelWorkGroupSize=295]="OpGetKernelWorkGroupSize",e[e.OpGetKernelPreferredWorkGroupSizeMultiple=296]="OpGetKernelPreferredWorkGroupSizeMultiple",e[e.OpRetainEvent=297]="OpRetainEvent",e[e.OpReleaseEvent=298]="OpReleaseEvent",e[e.OpCreateUserEvent=299]="OpCreateUserEvent",e[e.OpIsValidEvent=300]="OpIsValidEvent",e[e.OpSetUserEventStatus=301]="OpSetUserEventStatus",e[e.OpCaptureEventProfilingInfo=302]="OpCaptureEventProfilingInfo",e[e.OpGetDefaultQueue=303]="OpGetDefaultQueue",e[e.OpBuildNDRange=304]="OpBuildNDRange",e[e.OpImageSparseSampleImplicitLod=305]="OpImageSparseSampleImplicitLod",e[e.OpImageSparseSampleExplicitLod=306]="OpImageSparseSampleExplicitLod",e[e.OpImageSparseSampleDrefImplicitLod=307]="OpImageSparseSampleDrefImplicitLod",e[e.OpImageSparseSampleDrefExplicitLod=308]="OpImageSparseSampleDrefExplicitLod",e[e.OpImageSparseSampleProjImplicitLod=309]="OpImageSparseSampleProjImplicitLod",e[e.OpImageSparseSampleProjExplicitLod=310]="OpImageSparseSampleProjExplicitLod",e[e.OpImageSparseSampleProjDrefImplicitLod=311]="OpImageSparseSampleProjDrefImplicitLod",e[e.OpImageSparseSampleProjDrefExplicitLod=312]="OpImageSparseSampleProjDrefExplicitLod",e[e.OpImageSparseFetch=313]="OpImageSparseFetch",e[e.OpImageSparseGather=314]="OpImageSparseGather",e[e.OpImageSparseDrefGather=315]="OpImageSparseDrefGather",e[e.OpImageSparseTexelsResident=316]="OpImageSparseTexelsResident",e[e.OpNoLine=317]="OpNoLine",e[e.OpAtomicFlagTestAndSet=318]="OpAtomicFlagTestAndSet",e[e.OpAtomicFlagClear=319]="OpAtomicFlagClear",e[e.OpImageSparseRead=320]="OpImageSparseRead",e[e.OpSizeOf=321]="OpSizeOf",e[e.OpTypePipeStorage=322]="OpTypePipeStorage",e[e.OpConstantPipeStorage=323]="OpConstantPipeStorage",e[e.OpCreatePipeFromPipeStorage=324]="OpCreatePipeFromPipeStorage",e[e.OpGetKernelLocalSizeForSubgroupCount=325]="OpGetKernelLocalSizeForSubgroupCount",e[e.OpGetKernelMaxNumSubgroups=326]="OpGetKernelMaxNumSubgroups",e[e.OpTypeNamedBarrier=327]="OpTypeNamedBarrier",e[e.OpNamedBarrierInitialize=328]="OpNamedBarrierInitialize",e[e.OpMemoryNamedBarrier=329]="OpMemoryNamedBarrier",e[e.OpModuleProcessed=330]="OpModuleProcessed",e[e.OpExecutionModeId=331]="OpExecutionModeId",e[e.OpDecorateId=332]="OpDecorateId",e[e.OpGroupNonUniformElect=333]="OpGroupNonUniformElect",e[e.OpGroupNonUniformAll=334]="OpGroupNonUniformAll",e[e.OpGroupNonUniformAny=335]="OpGroupNonUniformAny",e[e.OpGroupNonUniformAllEqual=336]="OpGroupNonUniformAllEqual",e[e.OpGroupNonUniformBroadcast=337]="OpGroupNonUniformBroadcast",e[e.OpGroupNonUniformBroadcastFirst=338]="OpGroupNonUniformBroadcastFirst",e[e.OpGroupNonUniformBallot=339]="OpGroupNonUniformBallot",e[e.OpGroupNonUniformInverseBallot=340]="OpGroupNonUniformInverseBallot",e[e.OpGroupNonUniformBallotBitExtract=341]="OpGroupNonUniformBallotBitExtract",e[e.OpGroupNonUniformBallotBitCount=342]="OpGroupNonUniformBallotBitCount",e[e.OpGroupNonUniformBallotFindLSB=343]="OpGroupNonUniformBallotFindLSB",e[e.OpGroupNonUniformBallotFindMSB=344]="OpGroupNonUniformBallotFindMSB",e[e.OpGroupNonUniformShuffle=345]="OpGroupNonUniformShuffle",e[e.OpGroupNonUniformShuffleXor=346]="OpGroupNonUniformShuffleXor",e[e.OpGroupNonUniformShuffleUp=347]="OpGroupNonUniformShuffleUp",e[e.OpGroupNonUniformShuffleDown=348]="OpGroupNonUniformShuffleDown",e[e.OpGroupNonUniformIAdd=349]="OpGroupNonUniformIAdd",e[e.OpGroupNonUniformFAdd=350]="OpGroupNonUniformFAdd",e[e.OpGroupNonUniformIMul=351]="OpGroupNonUniformIMul",e[e.OpGroupNonUniformFMul=352]="OpGroupNonUniformFMul",e[e.OpGroupNonUniformSMin=353]="OpGroupNonUniformSMin",e[e.OpGroupNonUniformUMin=354]="OpGroupNonUniformUMin",e[e.OpGroupNonUniformFMin=355]="OpGroupNonUniformFMin",e[e.OpGroupNonUniformSMax=356]="OpGroupNonUniformSMax",e[e.OpGroupNonUniformUMax=357]="OpGroupNonUniformUMax",e[e.OpGroupNonUniformFMax=358]="OpGroupNonUniformFMax",e[e.OpGroupNonUniformBitwiseAnd=359]="OpGroupNonUniformBitwiseAnd",e[e.OpGroupNonUniformBitwiseOr=360]="OpGroupNonUniformBitwiseOr",e[e.OpGroupNonUniformBitwiseXor=361]="OpGroupNonUniformBitwiseXor",e[e.OpGroupNonUniformLogicalAnd=362]="OpGroupNonUniformLogicalAnd",e[e.OpGroupNonUniformLogicalOr=363]="OpGroupNonUniformLogicalOr",e[e.OpGroupNonUniformLogicalXor=364]="OpGroupNonUniformLogicalXor",e[e.OpGroupNonUniformQuadBroadcast=365]="OpGroupNonUniformQuadBroadcast",e[e.OpGroupNonUniformQuadSwap=366]="OpGroupNonUniformQuadSwap",e[e.OpCopyLogical=400]="OpCopyLogical",e[e.OpPtrEqual=401]="OpPtrEqual",e[e.OpPtrNotEqual=402]="OpPtrNotEqual",e[e.OpPtrDiff=403]="OpPtrDiff",e[e.OpTerminateInvocation=4416]="OpTerminateInvocation",e[e.OpSubgroupBallotKHR=4421]="OpSubgroupBallotKHR",e[e.OpSubgroupFirstInvocationKHR=4422]="OpSubgroupFirstInvocationKHR",e[e.OpSubgroupAllKHR=4428]="OpSubgroupAllKHR",e[e.OpSubgroupAnyKHR=4429]="OpSubgroupAnyKHR",e[e.OpSubgroupAllEqualKHR=4430]="OpSubgroupAllEqualKHR",e[e.OpSubgroupReadInvocationKHR=4432]="OpSubgroupReadInvocationKHR",e[e.OpTraceRayKHR=4445]="OpTraceRayKHR",e[e.OpExecuteCallableKHR=4446]="OpExecuteCallableKHR",e[e.OpConvertUToAccelerationStructureKHR=4447]="OpConvertUToAccelerationStructureKHR",e[e.OpIgnoreIntersectionKHR=4448]="OpIgnoreIntersectionKHR",e[e.OpTerminateRayKHR=4449]="OpTerminateRayKHR",e[e.OpTypeRayQueryKHR=4472]="OpTypeRayQueryKHR",e[e.OpRayQueryInitializeKHR=4473]="OpRayQueryInitializeKHR",e[e.OpRayQueryTerminateKHR=4474]="OpRayQueryTerminateKHR",e[e.OpRayQueryGenerateIntersectionKHR=4475]="OpRayQueryGenerateIntersectionKHR",e[e.OpRayQueryConfirmIntersectionKHR=4476]="OpRayQueryConfirmIntersectionKHR",e[e.OpRayQueryProceedKHR=4477]="OpRayQueryProceedKHR",e[e.OpRayQueryGetIntersectionTypeKHR=4479]="OpRayQueryGetIntersectionTypeKHR",e[e.OpGroupIAddNonUniformAMD=5e3]="OpGroupIAddNonUniformAMD",e[e.OpGroupFAddNonUniformAMD=5001]="OpGroupFAddNonUniformAMD",e[e.OpGroupFMinNonUniformAMD=5002]="OpGroupFMinNonUniformAMD",e[e.OpGroupUMinNonUniformAMD=5003]="OpGroupUMinNonUniformAMD",e[e.OpGroupSMinNonUniformAMD=5004]="OpGroupSMinNonUniformAMD",e[e.OpGroupFMaxNonUniformAMD=5005]="OpGroupFMaxNonUniformAMD",e[e.OpGroupUMaxNonUniformAMD=5006]="OpGroupUMaxNonUniformAMD",e[e.OpGroupSMaxNonUniformAMD=5007]="OpGroupSMaxNonUniformAMD",e[e.OpFragmentMaskFetchAMD=5011]="OpFragmentMaskFetchAMD",e[e.OpFragmentFetchAMD=5012]="OpFragmentFetchAMD",e[e.OpReadClockKHR=5056]="OpReadClockKHR",e[e.OpImageSampleFootprintNV=5283]="OpImageSampleFootprintNV",e[e.OpGroupNonUniformPartitionNV=5296]="OpGroupNonUniformPartitionNV",e[e.OpWritePackedPrimitiveIndices4x8NV=5299]="OpWritePackedPrimitiveIndices4x8NV",e[e.OpReportIntersectionKHR=5334]="OpReportIntersectionKHR",e[e.OpReportIntersectionNV=5334]="OpReportIntersectionNV",e[e.OpIgnoreIntersectionNV=5335]="OpIgnoreIntersectionNV",e[e.OpTerminateRayNV=5336]="OpTerminateRayNV",e[e.OpTraceNV=5337]="OpTraceNV",e[e.OpTypeAccelerationStructureKHR=5341]="OpTypeAccelerationStructureKHR",e[e.OpTypeAccelerationStructureNV=5341]="OpTypeAccelerationStructureNV",e[e.OpExecuteCallableNV=5344]="OpExecuteCallableNV",e[e.OpTypeCooperativeMatrixNV=5358]="OpTypeCooperativeMatrixNV",e[e.OpCooperativeMatrixLoadNV=5359]="OpCooperativeMatrixLoadNV",e[e.OpCooperativeMatrixStoreNV=5360]="OpCooperativeMatrixStoreNV",e[e.OpCooperativeMatrixMulAddNV=5361]="OpCooperativeMatrixMulAddNV",e[e.OpCooperativeMatrixLengthNV=5362]="OpCooperativeMatrixLengthNV",e[e.OpBeginInvocationInterlockEXT=5364]="OpBeginInvocationInterlockEXT",e[e.OpEndInvocationInterlockEXT=5365]="OpEndInvocationInterlockEXT",e[e.OpDemoteToHelperInvocationEXT=5380]="OpDemoteToHelperInvocationEXT",e[e.OpIsHelperInvocationEXT=5381]="OpIsHelperInvocationEXT",e[e.OpSubgroupShuffleINTEL=5571]="OpSubgroupShuffleINTEL",e[e.OpSubgroupShuffleDownINTEL=5572]="OpSubgroupShuffleDownINTEL",e[e.OpSubgroupShuffleUpINTEL=5573]="OpSubgroupShuffleUpINTEL",e[e.OpSubgroupShuffleXorINTEL=5574]="OpSubgroupShuffleXorINTEL",e[e.OpSubgroupBlockReadINTEL=5575]="OpSubgroupBlockReadINTEL",e[e.OpSubgroupBlockWriteINTEL=5576]="OpSubgroupBlockWriteINTEL",e[e.OpSubgroupImageBlockReadINTEL=5577]="OpSubgroupImageBlockReadINTEL",e[e.OpSubgroupImageBlockWriteINTEL=5578]="OpSubgroupImageBlockWriteINTEL",e[e.OpSubgroupImageMediaBlockReadINTEL=5580]="OpSubgroupImageMediaBlockReadINTEL",e[e.OpSubgroupImageMediaBlockWriteINTEL=5581]="OpSubgroupImageMediaBlockWriteINTEL",e[e.OpUCountLeadingZerosINTEL=5585]="OpUCountLeadingZerosINTEL",e[e.OpUCountTrailingZerosINTEL=5586]="OpUCountTrailingZerosINTEL",e[e.OpAbsISubINTEL=5587]="OpAbsISubINTEL",e[e.OpAbsUSubINTEL=5588]="OpAbsUSubINTEL",e[e.OpIAddSatINTEL=5589]="OpIAddSatINTEL",e[e.OpUAddSatINTEL=5590]="OpUAddSatINTEL",e[e.OpIAverageINTEL=5591]="OpIAverageINTEL",e[e.OpUAverageINTEL=5592]="OpUAverageINTEL",e[e.OpIAverageRoundedINTEL=5593]="OpIAverageRoundedINTEL",e[e.OpUAverageRoundedINTEL=5594]="OpUAverageRoundedINTEL",e[e.OpISubSatINTEL=5595]="OpISubSatINTEL",e[e.OpUSubSatINTEL=5596]="OpUSubSatINTEL",e[e.OpIMul32x16INTEL=5597]="OpIMul32x16INTEL",e[e.OpUMul32x16INTEL=5598]="OpUMul32x16INTEL",e[e.OpFunctionPointerINTEL=5600]="OpFunctionPointerINTEL",e[e.OpFunctionPointerCallINTEL=5601]="OpFunctionPointerCallINTEL",e[e.OpDecorateString=5632]="OpDecorateString",e[e.OpDecorateStringGOOGLE=5632]="OpDecorateStringGOOGLE",e[e.OpMemberDecorateString=5633]="OpMemberDecorateString",e[e.OpMemberDecorateStringGOOGLE=5633]="OpMemberDecorateStringGOOGLE",e[e.OpVmeImageINTEL=5699]="OpVmeImageINTEL",e[e.OpTypeVmeImageINTEL=5700]="OpTypeVmeImageINTEL",e[e.OpTypeAvcImePayloadINTEL=5701]="OpTypeAvcImePayloadINTEL",e[e.OpTypeAvcRefPayloadINTEL=5702]="OpTypeAvcRefPayloadINTEL",e[e.OpTypeAvcSicPayloadINTEL=5703]="OpTypeAvcSicPayloadINTEL",e[e.OpTypeAvcMcePayloadINTEL=5704]="OpTypeAvcMcePayloadINTEL",e[e.OpTypeAvcMceResultINTEL=5705]="OpTypeAvcMceResultINTEL",e[e.OpTypeAvcImeResultINTEL=5706]="OpTypeAvcImeResultINTEL",e[e.OpTypeAvcImeResultSingleReferenceStreamoutINTEL=5707]="OpTypeAvcImeResultSingleReferenceStreamoutINTEL",e[e.OpTypeAvcImeResultDualReferenceStreamoutINTEL=5708]="OpTypeAvcImeResultDualReferenceStreamoutINTEL",e[e.OpTypeAvcImeSingleReferenceStreaminINTEL=5709]="OpTypeAvcImeSingleReferenceStreaminINTEL",e[e.OpTypeAvcImeDualReferenceStreaminINTEL=5710]="OpTypeAvcImeDualReferenceStreaminINTEL",e[e.OpTypeAvcRefResultINTEL=5711]="OpTypeAvcRefResultINTEL",e[e.OpTypeAvcSicResultINTEL=5712]="OpTypeAvcSicResultINTEL",e[e.OpSubgroupAvcMceGetDefaultInterBaseMultiReferencePenaltyINTEL=5713]="OpSubgroupAvcMceGetDefaultInterBaseMultiReferencePenaltyINTEL",e[e.OpSubgroupAvcMceSetInterBaseMultiReferencePenaltyINTEL=5714]="OpSubgroupAvcMceSetInterBaseMultiReferencePenaltyINTEL",e[e.OpSubgroupAvcMceGetDefaultInterShapePenaltyINTEL=5715]="OpSubgroupAvcMceGetDefaultInterShapePenaltyINTEL",e[e.OpSubgroupAvcMceSetInterShapePenaltyINTEL=5716]="OpSubgroupAvcMceSetInterShapePenaltyINTEL",e[e.OpSubgroupAvcMceGetDefaultInterDirectionPenaltyINTEL=5717]="OpSubgroupAvcMceGetDefaultInterDirectionPenaltyINTEL",e[e.OpSubgroupAvcMceSetInterDirectionPenaltyINTEL=5718]="OpSubgroupAvcMceSetInterDirectionPenaltyINTEL",e[e.OpSubgroupAvcMceGetDefaultIntraLumaShapePenaltyINTEL=5719]="OpSubgroupAvcMceGetDefaultIntraLumaShapePenaltyINTEL",e[e.OpSubgroupAvcMceGetDefaultInterMotionVectorCostTableINTEL=5720]="OpSubgroupAvcMceGetDefaultInterMotionVectorCostTableINTEL",e[e.OpSubgroupAvcMceGetDefaultHighPenaltyCostTableINTEL=5721]="OpSubgroupAvcMceGetDefaultHighPenaltyCostTableINTEL",e[e.OpSubgroupAvcMceGetDefaultMediumPenaltyCostTableINTEL=5722]="OpSubgroupAvcMceGetDefaultMediumPenaltyCostTableINTEL",e[e.OpSubgroupAvcMceGetDefaultLowPenaltyCostTableINTEL=5723]="OpSubgroupAvcMceGetDefaultLowPenaltyCostTableINTEL",e[e.OpSubgroupAvcMceSetMotionVectorCostFunctionINTEL=5724]="OpSubgroupAvcMceSetMotionVectorCostFunctionINTEL",e[e.OpSubgroupAvcMceGetDefaultIntraLumaModePenaltyINTEL=5725]="OpSubgroupAvcMceGetDefaultIntraLumaModePenaltyINTEL",e[e.OpSubgroupAvcMceGetDefaultNonDcLumaIntraPenaltyINTEL=5726]="OpSubgroupAvcMceGetDefaultNonDcLumaIntraPenaltyINTEL",e[e.OpSubgroupAvcMceGetDefaultIntraChromaModeBasePenaltyINTEL=5727]="OpSubgroupAvcMceGetDefaultIntraChromaModeBasePenaltyINTEL",e[e.OpSubgroupAvcMceSetAcOnlyHaarINTEL=5728]="OpSubgroupAvcMceSetAcOnlyHaarINTEL",e[e.OpSubgroupAvcMceSetSourceInterlacedFieldPolarityINTEL=5729]="OpSubgroupAvcMceSetSourceInterlacedFieldPolarityINTEL",e[e.OpSubgroupAvcMceSetSingleReferenceInterlacedFieldPolarityINTEL=5730]="OpSubgroupAvcMceSetSingleReferenceInterlacedFieldPolarityINTEL",e[e.OpSubgroupAvcMceSetDualReferenceInterlacedFieldPolaritiesINTEL=5731]="OpSubgroupAvcMceSetDualReferenceInterlacedFieldPolaritiesINTEL",e[e.OpSubgroupAvcMceConvertToImePayloadINTEL=5732]="OpSubgroupAvcMceConvertToImePayloadINTEL",e[e.OpSubgroupAvcMceConvertToImeResultINTEL=5733]="OpSubgroupAvcMceConvertToImeResultINTEL",e[e.OpSubgroupAvcMceConvertToRefPayloadINTEL=5734]="OpSubgroupAvcMceConvertToRefPayloadINTEL",e[e.OpSubgroupAvcMceConvertToRefResultINTEL=5735]="OpSubgroupAvcMceConvertToRefResultINTEL",e[e.OpSubgroupAvcMceConvertToSicPayloadINTEL=5736]="OpSubgroupAvcMceConvertToSicPayloadINTEL",e[e.OpSubgroupAvcMceConvertToSicResultINTEL=5737]="OpSubgroupAvcMceConvertToSicResultINTEL",e[e.OpSubgroupAvcMceGetMotionVectorsINTEL=5738]="OpSubgroupAvcMceGetMotionVectorsINTEL",e[e.OpSubgroupAvcMceGetInterDistortionsINTEL=5739]="OpSubgroupAvcMceGetInterDistortionsINTEL",e[e.OpSubgroupAvcMceGetBestInterDistortionsINTEL=5740]="OpSubgroupAvcMceGetBestInterDistortionsINTEL",e[e.OpSubgroupAvcMceGetInterMajorShapeINTEL=5741]="OpSubgroupAvcMceGetInterMajorShapeINTEL",e[e.OpSubgroupAvcMceGetInterMinorShapeINTEL=5742]="OpSubgroupAvcMceGetInterMinorShapeINTEL",e[e.OpSubgroupAvcMceGetInterDirectionsINTEL=5743]="OpSubgroupAvcMceGetInterDirectionsINTEL",e[e.OpSubgroupAvcMceGetInterMotionVectorCountINTEL=5744]="OpSubgroupAvcMceGetInterMotionVectorCountINTEL",e[e.OpSubgroupAvcMceGetInterReferenceIdsINTEL=5745]="OpSubgroupAvcMceGetInterReferenceIdsINTEL",e[e.OpSubgroupAvcMceGetInterReferenceInterlacedFieldPolaritiesINTEL=5746]="OpSubgroupAvcMceGetInterReferenceInterlacedFieldPolaritiesINTEL",e[e.OpSubgroupAvcImeInitializeINTEL=5747]="OpSubgroupAvcImeInitializeINTEL",e[e.OpSubgroupAvcImeSetSingleReferenceINTEL=5748]="OpSubgroupAvcImeSetSingleReferenceINTEL",e[e.OpSubgroupAvcImeSetDualReferenceINTEL=5749]="OpSubgroupAvcImeSetDualReferenceINTEL",e[e.OpSubgroupAvcImeRefWindowSizeINTEL=5750]="OpSubgroupAvcImeRefWindowSizeINTEL",e[e.OpSubgroupAvcImeAdjustRefOffsetINTEL=5751]="OpSubgroupAvcImeAdjustRefOffsetINTEL",e[e.OpSubgroupAvcImeConvertToMcePayloadINTEL=5752]="OpSubgroupAvcImeConvertToMcePayloadINTEL",e[e.OpSubgroupAvcImeSetMaxMotionVectorCountINTEL=5753]="OpSubgroupAvcImeSetMaxMotionVectorCountINTEL",e[e.OpSubgroupAvcImeSetUnidirectionalMixDisableINTEL=5754]="OpSubgroupAvcImeSetUnidirectionalMixDisableINTEL",e[e.OpSubgroupAvcImeSetEarlySearchTerminationThresholdINTEL=5755]="OpSubgroupAvcImeSetEarlySearchTerminationThresholdINTEL",e[e.OpSubgroupAvcImeSetWeightedSadINTEL=5756]="OpSubgroupAvcImeSetWeightedSadINTEL",e[e.OpSubgroupAvcImeEvaluateWithSingleReferenceINTEL=5757]="OpSubgroupAvcImeEvaluateWithSingleReferenceINTEL",e[e.OpSubgroupAvcImeEvaluateWithDualReferenceINTEL=5758]="OpSubgroupAvcImeEvaluateWithDualReferenceINTEL",e[e.OpSubgroupAvcImeEvaluateWithSingleReferenceStreaminINTEL=5759]="OpSubgroupAvcImeEvaluateWithSingleReferenceStreaminINTEL",e[e.OpSubgroupAvcImeEvaluateWithDualReferenceStreaminINTEL=5760]="OpSubgroupAvcImeEvaluateWithDualReferenceStreaminINTEL",e[e.OpSubgroupAvcImeEvaluateWithSingleReferenceStreamoutINTEL=5761]="OpSubgroupAvcImeEvaluateWithSingleReferenceStreamoutINTEL",e[e.OpSubgroupAvcImeEvaluateWithDualReferenceStreamoutINTEL=5762]="OpSubgroupAvcImeEvaluateWithDualReferenceStreamoutINTEL",e[e.OpSubgroupAvcImeEvaluateWithSingleReferenceStreaminoutINTEL=5763]="OpSubgroupAvcImeEvaluateWithSingleReferenceStreaminoutINTEL",e[e.OpSubgroupAvcImeEvaluateWithDualReferenceStreaminoutINTEL=5764]="OpSubgroupAvcImeEvaluateWithDualReferenceStreaminoutINTEL",e[e.OpSubgroupAvcImeConvertToMceResultINTEL=5765]="OpSubgroupAvcImeConvertToMceResultINTEL",e[e.OpSubgroupAvcImeGetSingleReferenceStreaminINTEL=5766]="OpSubgroupAvcImeGetSingleReferenceStreaminINTEL",e[e.OpSubgroupAvcImeGetDualReferenceStreaminINTEL=5767]="OpSubgroupAvcImeGetDualReferenceStreaminINTEL",e[e.OpSubgroupAvcImeStripSingleReferenceStreamoutINTEL=5768]="OpSubgroupAvcImeStripSingleReferenceStreamoutINTEL",e[e.OpSubgroupAvcImeStripDualReferenceStreamoutINTEL=5769]="OpSubgroupAvcImeStripDualReferenceStreamoutINTEL",e[e.OpSubgroupAvcImeGetStreamoutSingleReferenceMajorShapeMotionVectorsINTEL=5770]="OpSubgroupAvcImeGetStreamoutSingleReferenceMajorShapeMotionVectorsINTEL",e[e.OpSubgroupAvcImeGetStreamoutSingleReferenceMajorShapeDistortionsINTEL=5771]="OpSubgroupAvcImeGetStreamoutSingleReferenceMajorShapeDistortionsINTEL",e[e.OpSubgroupAvcImeGetStreamoutSingleReferenceMajorShapeReferenceIdsINTEL=5772]="OpSubgroupAvcImeGetStreamoutSingleReferenceMajorShapeReferenceIdsINTEL",e[e.OpSubgroupAvcImeGetStreamoutDualReferenceMajorShapeMotionVectorsINTEL=5773]="OpSubgroupAvcImeGetStreamoutDualReferenceMajorShapeMotionVectorsINTEL",e[e.OpSubgroupAvcImeGetStreamoutDualReferenceMajorShapeDistortionsINTEL=5774]="OpSubgroupAvcImeGetStreamoutDualReferenceMajorShapeDistortionsINTEL",e[e.OpSubgroupAvcImeGetStreamoutDualReferenceMajorShapeReferenceIdsINTEL=5775]="OpSubgroupAvcImeGetStreamoutDualReferenceMajorShapeReferenceIdsINTEL",e[e.OpSubgroupAvcImeGetBorderReachedINTEL=5776]="OpSubgroupAvcImeGetBorderReachedINTEL",e[e.OpSubgroupAvcImeGetTruncatedSearchIndicationINTEL=5777]="OpSubgroupAvcImeGetTruncatedSearchIndicationINTEL",e[e.OpSubgroupAvcImeGetUnidirectionalEarlySearchTerminationINTEL=5778]="OpSubgroupAvcImeGetUnidirectionalEarlySearchTerminationINTEL",e[e.OpSubgroupAvcImeGetWeightingPatternMinimumMotionVectorINTEL=5779]="OpSubgroupAvcImeGetWeightingPatternMinimumMotionVectorINTEL",e[e.OpSubgroupAvcImeGetWeightingPatternMinimumDistortionINTEL=5780]="OpSubgroupAvcImeGetWeightingPatternMinimumDistortionINTEL",e[e.OpSubgroupAvcFmeInitializeINTEL=5781]="OpSubgroupAvcFmeInitializeINTEL",e[e.OpSubgroupAvcBmeInitializeINTEL=5782]="OpSubgroupAvcBmeInitializeINTEL",e[e.OpSubgroupAvcRefConvertToMcePayloadINTEL=5783]="OpSubgroupAvcRefConvertToMcePayloadINTEL",e[e.OpSubgroupAvcRefSetBidirectionalMixDisableINTEL=5784]="OpSubgroupAvcRefSetBidirectionalMixDisableINTEL",e[e.OpSubgroupAvcRefSetBilinearFilterEnableINTEL=5785]="OpSubgroupAvcRefSetBilinearFilterEnableINTEL",e[e.OpSubgroupAvcRefEvaluateWithSingleReferenceINTEL=5786]="OpSubgroupAvcRefEvaluateWithSingleReferenceINTEL",e[e.OpSubgroupAvcRefEvaluateWithDualReferenceINTEL=5787]="OpSubgroupAvcRefEvaluateWithDualReferenceINTEL",e[e.OpSubgroupAvcRefEvaluateWithMultiReferenceINTEL=5788]="OpSubgroupAvcRefEvaluateWithMultiReferenceINTEL",e[e.OpSubgroupAvcRefEvaluateWithMultiReferenceInterlacedINTEL=5789]="OpSubgroupAvcRefEvaluateWithMultiReferenceInterlacedINTEL",e[e.OpSubgroupAvcRefConvertToMceResultINTEL=5790]="OpSubgroupAvcRefConvertToMceResultINTEL",e[e.OpSubgroupAvcSicInitializeINTEL=5791]="OpSubgroupAvcSicInitializeINTEL",e[e.OpSubgroupAvcSicConfigureSkcINTEL=5792]="OpSubgroupAvcSicConfigureSkcINTEL",e[e.OpSubgroupAvcSicConfigureIpeLumaINTEL=5793]="OpSubgroupAvcSicConfigureIpeLumaINTEL",e[e.OpSubgroupAvcSicConfigureIpeLumaChromaINTEL=5794]="OpSubgroupAvcSicConfigureIpeLumaChromaINTEL",e[e.OpSubgroupAvcSicGetMotionVectorMaskINTEL=5795]="OpSubgroupAvcSicGetMotionVectorMaskINTEL",e[e.OpSubgroupAvcSicConvertToMcePayloadINTEL=5796]="OpSubgroupAvcSicConvertToMcePayloadINTEL",e[e.OpSubgroupAvcSicSetIntraLumaShapePenaltyINTEL=5797]="OpSubgroupAvcSicSetIntraLumaShapePenaltyINTEL",e[e.OpSubgroupAvcSicSetIntraLumaModeCostFunctionINTEL=5798]="OpSubgroupAvcSicSetIntraLumaModeCostFunctionINTEL",e[e.OpSubgroupAvcSicSetIntraChromaModeCostFunctionINTEL=5799]="OpSubgroupAvcSicSetIntraChromaModeCostFunctionINTEL",e[e.OpSubgroupAvcSicSetBilinearFilterEnableINTEL=5800]="OpSubgroupAvcSicSetBilinearFilterEnableINTEL",e[e.OpSubgroupAvcSicSetSkcForwardTransformEnableINTEL=5801]="OpSubgroupAvcSicSetSkcForwardTransformEnableINTEL",e[e.OpSubgroupAvcSicSetBlockBasedRawSkipSadINTEL=5802]="OpSubgroupAvcSicSetBlockBasedRawSkipSadINTEL",e[e.OpSubgroupAvcSicEvaluateIpeINTEL=5803]="OpSubgroupAvcSicEvaluateIpeINTEL",e[e.OpSubgroupAvcSicEvaluateWithSingleReferenceINTEL=5804]="OpSubgroupAvcSicEvaluateWithSingleReferenceINTEL",e[e.OpSubgroupAvcSicEvaluateWithDualReferenceINTEL=5805]="OpSubgroupAvcSicEvaluateWithDualReferenceINTEL",e[e.OpSubgroupAvcSicEvaluateWithMultiReferenceINTEL=5806]="OpSubgroupAvcSicEvaluateWithMultiReferenceINTEL",e[e.OpSubgroupAvcSicEvaluateWithMultiReferenceInterlacedINTEL=5807]="OpSubgroupAvcSicEvaluateWithMultiReferenceInterlacedINTEL",e[e.OpSubgroupAvcSicConvertToMceResultINTEL=5808]="OpSubgroupAvcSicConvertToMceResultINTEL",e[e.OpSubgroupAvcSicGetIpeLumaShapeINTEL=5809]="OpSubgroupAvcSicGetIpeLumaShapeINTEL",e[e.OpSubgroupAvcSicGetBestIpeLumaDistortionINTEL=5810]="OpSubgroupAvcSicGetBestIpeLumaDistortionINTEL",e[e.OpSubgroupAvcSicGetBestIpeChromaDistortionINTEL=5811]="OpSubgroupAvcSicGetBestIpeChromaDistortionINTEL",e[e.OpSubgroupAvcSicGetPackedIpeLumaModesINTEL=5812]="OpSubgroupAvcSicGetPackedIpeLumaModesINTEL",e[e.OpSubgroupAvcSicGetIpeChromaModeINTEL=5813]="OpSubgroupAvcSicGetIpeChromaModeINTEL",e[e.OpSubgroupAvcSicGetPackedSkcLumaCountThresholdINTEL=5814]="OpSubgroupAvcSicGetPackedSkcLumaCountThresholdINTEL",e[e.OpSubgroupAvcSicGetPackedSkcLumaSumThresholdINTEL=5815]="OpSubgroupAvcSicGetPackedSkcLumaSumThresholdINTEL",e[e.OpSubgroupAvcSicGetInterRawSadsINTEL=5816]="OpSubgroupAvcSicGetInterRawSadsINTEL",e[e.OpLoopControlINTEL=5887]="OpLoopControlINTEL",e[e.OpReadPipeBlockingINTEL=5946]="OpReadPipeBlockingINTEL",e[e.OpWritePipeBlockingINTEL=5947]="OpWritePipeBlockingINTEL",e[e.OpFPGARegINTEL=5949]="OpFPGARegINTEL",e[e.OpRayQueryGetRayTMinKHR=6016]="OpRayQueryGetRayTMinKHR",e[e.OpRayQueryGetRayFlagsKHR=6017]="OpRayQueryGetRayFlagsKHR",e[e.OpRayQueryGetIntersectionTKHR=6018]="OpRayQueryGetIntersectionTKHR",e[e.OpRayQueryGetIntersectionInstanceCustomIndexKHR=6019]="OpRayQueryGetIntersectionInstanceCustomIndexKHR",e[e.OpRayQueryGetIntersectionInstanceIdKHR=6020]="OpRayQueryGetIntersectionInstanceIdKHR",e[e.OpRayQueryGetIntersectionInstanceShaderBindingTableRecordOffsetKHR=6021]="OpRayQueryGetIntersectionInstanceShaderBindingTableRecordOffsetKHR",e[e.OpRayQueryGetIntersectionGeometryIndexKHR=6022]="OpRayQueryGetIntersectionGeometryIndexKHR",e[e.OpRayQueryGetIntersectionPrimitiveIndexKHR=6023]="OpRayQueryGetIntersectionPrimitiveIndexKHR",e[e.OpRayQueryGetIntersectionBarycentricsKHR=6024]="OpRayQueryGetIntersectionBarycentricsKHR",e[e.OpRayQueryGetIntersectionFrontFaceKHR=6025]="OpRayQueryGetIntersectionFrontFaceKHR",e[e.OpRayQueryGetIntersectionCandidateAABBOpaqueKHR=6026]="OpRayQueryGetIntersectionCandidateAABBOpaqueKHR",e[e.OpRayQueryGetIntersectionObjectRayDirectionKHR=6027]="OpRayQueryGetIntersectionObjectRayDirectionKHR",e[e.OpRayQueryGetIntersectionObjectRayOriginKHR=6028]="OpRayQueryGetIntersectionObjectRayOriginKHR",e[e.OpRayQueryGetWorldRayDirectionKHR=6029]="OpRayQueryGetWorldRayDirectionKHR",e[e.OpRayQueryGetWorldRayOriginKHR=6030]="OpRayQueryGetWorldRayOriginKHR",e[e.OpRayQueryGetIntersectionObjectToWorldKHR=6031]="OpRayQueryGetIntersectionObjectToWorldKHR",e[e.OpRayQueryGetIntersectionWorldToObjectKHR=6032]="OpRayQueryGetIntersectionWorldToObjectKHR",e[e.OpAtomicFAddEXT=6035]="OpAtomicFAddEXT",e[e.OpMax=2147483647]="OpMax"}(ie||(ie={})),function(e){e[e.BLOCK_META_LOOP_HEADER_BIT=1]="BLOCK_META_LOOP_HEADER_BIT",e[e.BLOCK_META_CONTINUE_BIT=2]="BLOCK_META_CONTINUE_BIT",e[e.BLOCK_META_LOOP_MERGE_BIT=4]="BLOCK_META_LOOP_MERGE_BIT",e[e.BLOCK_META_SELECTION_MERGE_BIT=8]="BLOCK_META_SELECTION_MERGE_BIT",e[e.BLOCK_META_MULTISELECT_MERGE_BIT=16]="BLOCK_META_MULTISELECT_MERGE_BIT"}(re||(re={}));var ue=function(){this.version=0,this.es=!1,this.known=!1,this.hlsl=!1},he=function(){function e(e){this.lock=e,this.lock.set(this.lock.get()+1)}return e.prototype.dispose=function(){this.lock.set(this.lock.get()-1)},e}(),de=function(){function e(){this.ids=[],this.meta=[],this.ids_for_type=new Array(t.TypeCount),this.ids_for_constant_or_type=[],this.ids_for_constant_or_variable=[],this.load_type_width=[],this.declared_capabilities=[],this.declared_extensions=[],this.block_meta=[],this.continue_block_to_loop_header=[],this.entry_points=[],this.default_entry_point=0,this.source=new ue,this.addressing_model=$.AddressingModelMax,this.memory_model=ee.MemoryModelMax,this.loop_iteration_depth_hard=0,this.loop_iteration_depth_soft=0,this.empty_string="",this.cleared_bitset=new y,this.meta_needing_name_fixup=new Set;for(var e=0;e<this.ids_for_type.length;++e)this.ids_for_type[e]=[];this.pool_group=new u,this.pool_group.pools[t.TypeType]=new H(w),this.pool_group.pools[t.TypeVariable]=new H(E),this.pool_group.pools[t.TypeConstant]=new H(U),this.pool_group.pools[t.TypeFunction]=new H(j),this.pool_group.pools[t.TypeFunctionPrototype]=new H(W),this.pool_group.pools[t.TypeBlock]=new H(J),this.pool_group.pools[t.TypeExtension]=new H(ae),this.pool_group.pools[t.TypeExpression]=new H(oe),this.pool_group.pools[t.TypeConstantOp]=new H(V),this.pool_group.pools[t.TypeCombinedImageSampler]=new H(se),this.pool_group.pools[t.TypeAccessChain]=new H(ne),this.pool_group.pools[t.TypeUndef]=new H(ce),this.pool_group.pools[t.TypeString]=new H(_e)}return e.prototype.set_id_bounds=function(e){var t=this;this.ids=s(e,(function(){return new _(t.pool_group)})),this.block_meta=s(e,(function(){return 0}))},e.prototype.set_name=function(e,t){this.get_meta(e).decoration.alias=t,ge(t)&&!ye(t,!1,!1)||this.meta_needing_name_fixup.add(e)},e.prototype.get_name=function(e){var t=this.find_meta(e);return t?t.decoration.alias:this.empty_string},e.prototype.set_decoration=function(e,t,i){void 0===i&&(i=0);var r=this.get_meta(e).decoration;switch(r.decoration_flags.set(t),t){case te.DecorationBuiltIn:r.builtin=!0,r.builtin_type=i;break;case te.DecorationLocation:r.location=i;break;case te.DecorationComponent:r.component=i;break;case te.DecorationOffset:r.offset=i;break;case te.DecorationXfbBuffer:r.xfb_buffer=i;break;case te.DecorationXfbStride:r.xfb_stride=i;break;case te.DecorationStream:r.stream=i;break;case te.DecorationArrayStride:r.array_stride=i;break;case te.DecorationMatrixStride:r.matrix_stride=i;break;case te.DecorationBinding:r.binding=i;break;case te.DecorationDescriptorSet:r.set=i;break;case te.DecorationInputAttachmentIndex:r.input_attachment=i;break;case te.DecorationSpecId:r.spec_id=i;break;case te.DecorationIndex:r.index=i;break;case te.DecorationHlslCounterBufferGOOGLE:this.get_meta(e).hlsl_magic_counter_buffer=i,this.meta[i].hlsl_is_magic_counter_buffer=!0;break;case te.DecorationFPRoundingMode:r.fp_rounding_mode=i}},e.prototype.set_decoration_string=function(e,t,i){var r=this.get_meta(e).decoration;if(r.decoration_flags.set(t),t===te.DecorationHlslSemanticGOOGLE)r.hlsl_semantic=i},e.prototype.has_decoration=function(e,t){return this.get_decoration_bitset(e).get(t)},e.prototype.get_decoration=function(e,t){var i=this.find_meta(e);if(!i)return 0;var r=i.decoration;if(!r.decoration_flags.get(t))return 0;switch(t){case te.DecorationBuiltIn:return r.builtin_type;case te.DecorationLocation:return r.location;case te.DecorationComponent:return r.component;case te.DecorationOffset:return r.offset;case te.DecorationXfbBuffer:return r.xfb_buffer;case te.DecorationXfbStride:return r.xfb_stride;case te.DecorationStream:return r.stream;case te.DecorationBinding:return r.binding;case te.DecorationDescriptorSet:return r.set;case te.DecorationInputAttachmentIndex:return r.input_attachment;case te.DecorationSpecId:return r.spec_id;case te.DecorationArrayStride:return r.array_stride;case te.DecorationMatrixStride:return r.matrix_stride;case te.DecorationIndex:return r.index;case te.DecorationFPRoundingMode:return r.fp_rounding_mode;default:return 1}},e.prototype.get_decoration_string=function(e,t){var i=this.find_meta(e);if(!i)return this.empty_string;var r=i.decoration;return r.decoration_flags.get(t)&&t===te.DecorationHlslSemanticGOOGLE?r.hlsl_semantic:this.empty_string},e.prototype.get_decoration_bitset=function(e){var t=this.find_meta(e);return t?t.decoration.decoration_flags:this.cleared_bitset},e.prototype.unset_decoration=function(e,t){var i=this.get_meta(e).decoration;switch(i.decoration_flags.clear(t),t){case te.DecorationBuiltIn:i.builtin=!1;break;case te.DecorationLocation:i.location=0;break;case te.DecorationComponent:i.component=0;break;case te.DecorationOffset:i.offset=0;break;case te.DecorationXfbBuffer:i.xfb_buffer=0;break;case te.DecorationXfbStride:i.xfb_stride=0;break;case te.DecorationStream:i.stream=0;break;case te.DecorationBinding:i.binding=0;break;case te.DecorationDescriptorSet:i.set=0;break;case te.DecorationInputAttachmentIndex:i.input_attachment=0;break;case te.DecorationSpecId:i.spec_id=0;break;case te.DecorationHlslSemanticGOOGLE:i.hlsl_semantic="";break;case te.DecorationFPRoundingMode:i.fp_rounding_mode=g.FPRoundingModeMax;break;case te.DecorationHlslCounterBufferGOOGLE:var r=this.get_meta(e),a=r.hlsl_magic_counter_buffer;a&&(this.meta[a].hlsl_is_magic_counter_buffer=!1,r.hlsl_magic_counter_buffer=0)}},e.prototype.resize_members=function(e,t){var i=e.length;e.length=t;for(var r=i;r<t;++r)e[r]=new I},e.prototype.set_member_name=function(e,t,i){var r=this.get_meta(e);this.resize_members(r.members,Math.max(r.members.length,t+1)),r.members[t].alias=i,ge(i)&&!ye(i,!0,!1)||this.meta_needing_name_fixup.add(e)},e.prototype.get_member_name=function(e,t){var i=this.find_meta(e);return i?t>=i.members.length?this.empty_string:i.members[t].alias:this.empty_string},e.prototype.set_member_decoration=function(e,t,i,r){void 0===r&&(r=0);var a=this.get_meta(e);this.resize_members(a.members,Math.max(a.members.length,t+1));var o=a.members[t];switch(o.decoration_flags.set(i),i){case te.DecorationBuiltIn:o.builtin=!0,o.builtin_type=r;break;case te.DecorationLocation:o.location=r;break;case te.DecorationComponent:o.component=r;break;case te.DecorationBinding:o.binding=r;break;case te.DecorationOffset:o.offset=r;break;case te.DecorationXfbBuffer:o.xfb_buffer=r;break;case te.DecorationXfbStride:o.xfb_stride=r;break;case te.DecorationStream:o.stream=r;break;case te.DecorationSpecId:o.spec_id=r;break;case te.DecorationMatrixStride:o.matrix_stride=r;break;case te.DecorationIndex:o.index=r}},e.prototype.set_member_decoration_string=function(e,t,i,r){var a=this.get_meta(e);this.resize_members(a.members,Math.max(a.members.length,t+1));var o=a.members[t];if(o.decoration_flags.set(i),i===te.DecorationHlslSemanticGOOGLE)o.hlsl_semantic=r},e.prototype.get_member_decoration=function(e,t,i){var r=this.find_meta(e);if(!r)return 0;if(t>=r.members.length)return 0;var a=r.members[t];if(!a.decoration_flags.get(i))return 0;switch(i){case te.DecorationBuiltIn:return a.builtin_type;case te.DecorationLocation:return a.location;case te.DecorationComponent:return a.component;case te.DecorationBinding:return a.binding;case te.DecorationOffset:return a.offset;case te.DecorationXfbBuffer:return a.xfb_buffer;case te.DecorationXfbStride:return a.xfb_stride;case te.DecorationStream:return a.stream;case te.DecorationSpecId:return a.spec_id;case te.DecorationIndex:return a.index;default:return 1}},e.prototype.get_member_decoration_string=function(e,t,i){var r=this.find_meta(e);if(r){if(!this.has_member_decoration(e,t,i))return this.empty_string;var a=r.members[t];return i===te.DecorationHlslSemanticGOOGLE?a.hlsl_semantic:this.empty_string}return this.empty_string},e.prototype.has_member_decoration=function(e,t,i){return this.get_member_decoration_bitset(e,t).get(i)},e.prototype.get_member_decoration_bitset=function(e,t){var i=this.find_meta(e);return i?t>=i.members.length?this.cleared_bitset.clone():i.members[t].decoration_flags:this.cleared_bitset.clone()},e.prototype.unset_member_decoration=function(e,t,i){var r=this.get_meta(e);if(!(t>=r.members.length)){var a=r.members[t];switch(a.decoration_flags.clear(i),i){case te.DecorationBuiltIn:a.builtin=!1;break;case te.DecorationLocation:a.location=0;break;case te.DecorationComponent:a.component=0;break;case te.DecorationOffset:a.offset=0;break;case te.DecorationXfbBuffer:a.xfb_buffer=0;break;case te.DecorationXfbStride:a.xfb_stride=0;break;case te.DecorationStream:a.stream=0;break;case te.DecorationSpecId:a.spec_id=0;break;case te.DecorationHlslSemanticGOOGLE:a.hlsl_semantic=""}}},e.prototype.mark_used_as_array_length=function(e){switch(this.ids[e].get_type()){case t.TypeConstant:this.get(U,e).is_used_as_array_length=!0;break;case t.TypeConstantOp:var i=this.get(V,e);if(i.opcode===ie.OpCompositeExtract)this.mark_used_as_array_length(i.arguments[0]);else if(i.opcode===ie.OpCompositeInsert)this.mark_used_as_array_length(i.arguments[0]),this.mark_used_as_array_length(i.arguments[1]);else for(var r=0,a=i.arguments;r<a.length;r++){var o=a[r];this.mark_used_as_array_length(o)}break;case t.TypeUndef:break;default:throw new Error("Shouldn't reach this branch")}},e.prototype.get_buffer_block_flags=function(e){var t,i=this.get(w,e.basetype);if(i.basetype!==L.Struct)throw new Error("Assertion failure");var r=this.find_meta(e.self);if(t=r?r.decoration.decoration_flags.clone():new y,0===i.member_types.length)return(null==t?void 0:t.clone())||new y;var a=this.get_buffer_block_type_flags(i);return t.merge_or(a),t},e.prototype.get_buffer_block_type_flags=function(e){if(0===e.member_types.length)return new y;for(var t=this.get_member_decoration_bitset(e.self,0).clone(),i=1;i<e.member_types.length;i++)t.merge_and(this.get_member_decoration_bitset(e.self,i));return t},e.prototype.add_typed_id=function(e,i){if(0!==this.loop_iteration_depth_hard)throw new Error("Cannot add typed ID while looping over it.");var r=this.ids[i];if(0!==this.loop_iteration_depth_soft&&!r.empty())throw new Error("Cannot override IDs when loop is soft locked.");if(r.empty()||r.get_type()!==e)switch(e){case t.TypeConstant:this.ids_for_constant_or_variable.push(i),this.ids_for_constant_or_type.push(i);break;case t.TypeVariable:this.ids_for_constant_or_variable.push(i);break;case t.TypeType:case t.TypeConstantOp:this.ids_for_constant_or_type.push(i)}r.empty()?this.ids_for_type[e].push(i):r.get_type()!==e&&(this.remove_typed_id(r.get_type(),i),this.ids_for_type[e].push(i))},e.prototype.remove_typed_id=function(e,t){!function(e,t){for(var i=e.indexOf(t);i>=0;i=e.indexOf(t))e.splice(i,1)}(this.ids_for_type[e],t)},e.prototype.create_loop_hard_lock=function(){return new he(new O(this,"loop_iteration_depth_hard"))},e.prototype.create_loop_soft_lock=function(){return new he(new O(this,"loop_iteration_depth_soft"))},e.prototype.for_each_typed_id=function(e,t){for(var i=this.create_loop_hard_lock(),r=0,a=this.ids_for_type[e.type];r<a.length;r++){var o=a[r];this.ids[o].get_type()===e.type&&t(o,this.get(e,o))}i.dispose()},e.prototype.reset_all_of_type=function(e){if("number"==typeof e){for(var t=0,i=this.ids_for_type[e];t<i.length;t++){var r=i[t];this.ids[r].get_type()===e&&this.ids[r].reset()}this.ids_for_type[e]=[]}else this.reset_all_of_type(e.type)},e.prototype.get_meta=function(e){return this.meta[e]||(this.meta[e]=new x),this.meta[e]},e.prototype.find_meta=function(e){return this.meta[e]},e.prototype.get_empty_string=function(){return this.empty_string},e.prototype.make_constant_null=function(e,i,r){var a=this.get(w,i);if(a.pointer)r&&this.add_typed_id(t.TypeConstant,e),(_=l(U,this.ids[e],i)).self=e,_.make_null(a);else if(0!==a.array.length){console.assert(a.parent_type);var o=this.increase_bound_by(1);this.make_constant_null(o,a.parent_type,r);for(var s=[],n=0;n<a.array.length;n++)s[n]=o;r&&this.add_typed_id(t.TypeConstant,e),l(U,this.ids[e],i,s,s.length,!1).self=e}else if(0!==a.member_types.length){var c=this.increase_bound_by(a.member_types.length);for(s=[],n=0;n<a.member_types.length;n++)this.make_constant_null(c+n,a.member_types[n],r),s[n]=c+n;r&&this.add_typed_id(t.TypeConstant,e),l(U,this.ids[e],i,s,s.length,!1).self=e}else{var _;r&&this.add_typed_id(t.TypeConstant,e),(_=l(U,this.ids[e],i)).self=e,_.make_null(a)}},e.prototype.fixup_reserved_names=function(){for(var t=this.meta_needing_name_fixup.values(),i=null;i=t.next().value;){var r=this.get_meta(i);r.decoration.alias=e.sanitize_identifier(r.decoration.alias,!1,!1);for(var a=0,o=r.members;a<o.length;a++){var s=o[a];s.alias=e.sanitize_identifier(s.alias,!0,!1)}}this.meta_needing_name_fixup.clear()},e.sanitize_identifier=function(e,t,i){return ge(e)||(e=ve(e)),ye(e,t,i)&&(e=function(e){return be(e)?"_RESERVED_IDENTIFIER_FIXUP_"+e:"_RESERVED_IDENTIFIER_FIXUP"+e}(e)),e},e.sanitize_underscores=function(e){return e.replace(/_+/g,"_")},e.is_globally_reserved_identifier=function(e,t){return ye(e,!1,t)},e.prototype.increase_bound_by=function(e){var t=this.ids.length,i=t+e;this.ids.length+=e;for(var r=0;r<e;r++)this.ids[r]=new _(this.pool_group);return this.block_meta.length=i,t},e.prototype.get_spirv_version=function(){return this.spirv[1]},e.prototype.get=function(e,t){return p(e,this.ids[t])},e}();function fe(e){return e>="0"&&e<="9"}function me(e){return function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}(e)||fe(e)}function ge(e){if(""===e)return!0;if(fe(e[0]))return!1;for(var t=0;t<e.length;++t){if(!me(r=e.charAt(t))&&"_"!==r)return!1}var i=!1;for(t=0;t<e.length;++t){var r,a="_"===(r=e.charAt(t));if(a&&i)return!1;i=a}return!0}function be(e){var t=e.substring(0,3);return"gl_"===t||"spv"===t}function ye(e,t,i){if(!i&&be(e))return!0;if(t){if(e.length<3)return!1;if("_m"===e.substring(0,2))return!1;for(var r=2;r<e.length&&fe(e[r]);)r++;return r===e.length}if(e.length<2)return!1;if("_"!==e.charAt(0)||!fe(e.charAt(1)))return!1;for(r=2;r<e.length&&fe(e[r]);)r++;return r===e.length||r<e.length&&"_"===e[r]}function ve(e){var t=e.substring(0,e.indexOf("("));if(0===t.length)return t;fe(t.charAt(0))&&(t="_"+t.substring(1));for(var i=0;i<t.length;++i){var r=t.charAt(i);me(r)||"_"===r||(t=pe(t,i,"_"))}return de.sanitize_underscores(t)}var Se,Ie=function(){function e(){this.op=0,this.count=0,this.offset=0,this.length=0}return e.prototype.is_embedded=function(){return 0===this.offset},e}(),xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ops=[],t}return a(t,e),t}(Ie),Oe=function(){function e(e,t){this.first=e,this.second=t}return e.prototype.equals=function(e){return this.first===e.first&&this.second===e.second},e.prototype.clone=function(){var t=new e;return h(this,t),t},e}();!function(e){e[e.ExecutionModelVertex=0]="ExecutionModelVertex",e[e.ExecutionModelTessellationControl=1]="ExecutionModelTessellationControl",e[e.ExecutionModelTessellationEvaluation=2]="ExecutionModelTessellationEvaluation",e[e.ExecutionModelGeometry=3]="ExecutionModelGeometry",e[e.ExecutionModelFragment=4]="ExecutionModelFragment",e[e.ExecutionModelGLCompute=5]="ExecutionModelGLCompute",e[e.ExecutionModelKernel=6]="ExecutionModelKernel",e[e.ExecutionModelTaskNV=5267]="ExecutionModelTaskNV",e[e.ExecutionModelMeshNV=5268]="ExecutionModelMeshNV",e[e.ExecutionModelRayGenerationKHR=5313]="ExecutionModelRayGenerationKHR",e[e.ExecutionModelRayGenerationNV=5313]="ExecutionModelRayGenerationNV",e[e.ExecutionModelIntersectionKHR=5314]="ExecutionModelIntersectionKHR",e[e.ExecutionModelIntersectionNV=5314]="ExecutionModelIntersectionNV",e[e.ExecutionModelAnyHitKHR=5315]="ExecutionModelAnyHitKHR",e[e.ExecutionModelAnyHitNV=5315]="ExecutionModelAnyHitNV",e[e.ExecutionModelClosestHitKHR=5316]="ExecutionModelClosestHitKHR",e[e.ExecutionModelClosestHitNV=5316]="ExecutionModelClosestHitNV",e[e.ExecutionModelMissKHR=5317]="ExecutionModelMissKHR",e[e.ExecutionModelMissNV=5317]="ExecutionModelMissNV",e[e.ExecutionModelCallableKHR=5318]="ExecutionModelCallableKHR",e[e.ExecutionModelCallableNV=5318]="ExecutionModelCallableNV",e[e.ExecutionModelMax=2147483647]="ExecutionModelMax"}(Se||(Se={}));var ke,Le,Ee,Ce,we,Te,De=function(){function e(){this.x=0,this.y=0,this.z=0,this.id_x=0,this.id_y=0,this.id_z=0,this.constant=0}return e.prototype.clone=function(){return d(e,this)},e}(),Re=function e(t,i,r){this.self=0,this.interface_variables=[],this.flags=new y,this.workgroup_size=new De,this.invocations=0,this.output_vertices=0,this.model=Se.ExecutionModelMax,this.geometry_passthrough=!1,t instanceof e?h(t,this):(this.self=t,this.name=r,this.orig_name=r,this.model=i)},Me=119734787;!function(e){e[e.SourceLanguageUnknown=0]="SourceLanguageUnknown",e[e.SourceLanguageESSL=1]="SourceLanguageESSL",e[e.SourceLanguageGLSL=2]="SourceLanguageGLSL",e[e.SourceLanguageOpenCL_C=3]="SourceLanguageOpenCL_C",e[e.SourceLanguageOpenCL_CPP=4]="SourceLanguageOpenCL_CPP",e[e.SourceLanguageHLSL=5]="SourceLanguageHLSL",e[e.SourceLanguageMax=2147483647]="SourceLanguageMax"}(ke||(ke={})),function(e){e[e.CapabilityMatrix=0]="CapabilityMatrix",e[e.CapabilityShader=1]="CapabilityShader",e[e.CapabilityGeometry=2]="CapabilityGeometry",e[e.CapabilityTessellation=3]="CapabilityTessellation",e[e.CapabilityAddresses=4]="CapabilityAddresses",e[e.CapabilityLinkage=5]="CapabilityLinkage",e[e.CapabilityKernel=6]="CapabilityKernel",e[e.CapabilityVector16=7]="CapabilityVector16",e[e.CapabilityFloat16Buffer=8]="CapabilityFloat16Buffer",e[e.CapabilityFloat16=9]="CapabilityFloat16",e[e.CapabilityFloat64=10]="CapabilityFloat64",e[e.CapabilityInt64=11]="CapabilityInt64",e[e.CapabilityInt64Atomics=12]="CapabilityInt64Atomics",e[e.CapabilityImageBasic=13]="CapabilityImageBasic",e[e.CapabilityImageReadWrite=14]="CapabilityImageReadWrite",e[e.CapabilityImageMipmap=15]="CapabilityImageMipmap",e[e.CapabilityPipes=17]="CapabilityPipes",e[e.CapabilityGroups=18]="CapabilityGroups",e[e.CapabilityDeviceEnqueue=19]="CapabilityDeviceEnqueue",e[e.CapabilityLiteralSampler=20]="CapabilityLiteralSampler",e[e.CapabilityAtomicStorage=21]="CapabilityAtomicStorage",e[e.CapabilityInt16=22]="CapabilityInt16",e[e.CapabilityTessellationPointSize=23]="CapabilityTessellationPointSize",e[e.CapabilityGeometryPointSize=24]="CapabilityGeometryPointSize",e[e.CapabilityImageGatherExtended=25]="CapabilityImageGatherExtended",e[e.CapabilityStorageImageMultisample=27]="CapabilityStorageImageMultisample",e[e.CapabilityUniformBufferArrayDynamicIndexing=28]="CapabilityUniformBufferArrayDynamicIndexing",e[e.CapabilitySampledImageArrayDynamicIndexing=29]="CapabilitySampledImageArrayDynamicIndexing",e[e.CapabilityStorageBufferArrayDynamicIndexing=30]="CapabilityStorageBufferArrayDynamicIndexing",e[e.CapabilityStorageImageArrayDynamicIndexing=31]="CapabilityStorageImageArrayDynamicIndexing",e[e.CapabilityClipDistance=32]="CapabilityClipDistance",e[e.CapabilityCullDistance=33]="CapabilityCullDistance",e[e.CapabilityImageCubeArray=34]="CapabilityImageCubeArray",e[e.CapabilitySampleRateShading=35]="CapabilitySampleRateShading",e[e.CapabilityImageRect=36]="CapabilityImageRect",e[e.CapabilitySampledRect=37]="CapabilitySampledRect",e[e.CapabilityGenericPointer=38]="CapabilityGenericPointer",e[e.CapabilityInt8=39]="CapabilityInt8",e[e.CapabilityInputAttachment=40]="CapabilityInputAttachment",e[e.CapabilitySparseResidency=41]="CapabilitySparseResidency",e[e.CapabilityMinLod=42]="CapabilityMinLod",e[e.CapabilitySampled1D=43]="CapabilitySampled1D",e[e.CapabilityImage1D=44]="CapabilityImage1D",e[e.CapabilitySampledCubeArray=45]="CapabilitySampledCubeArray",e[e.CapabilitySampledBuffer=46]="CapabilitySampledBuffer",e[e.CapabilityImageBuffer=47]="CapabilityImageBuffer",e[e.CapabilityImageMSArray=48]="CapabilityImageMSArray",e[e.CapabilityStorageImageExtendedFormats=49]="CapabilityStorageImageExtendedFormats",e[e.CapabilityImageQuery=50]="CapabilityImageQuery",e[e.CapabilityDerivativeControl=51]="CapabilityDerivativeControl",e[e.CapabilityInterpolationFunction=52]="CapabilityInterpolationFunction",e[e.CapabilityTransformFeedback=53]="CapabilityTransformFeedback",e[e.CapabilityGeometryStreams=54]="CapabilityGeometryStreams",e[e.CapabilityStorageImageReadWithoutFormat=55]="CapabilityStorageImageReadWithoutFormat",e[e.CapabilityStorageImageWriteWithoutFormat=56]="CapabilityStorageImageWriteWithoutFormat",e[e.CapabilityMultiViewport=57]="CapabilityMultiViewport",e[e.CapabilitySubgroupDispatch=58]="CapabilitySubgroupDispatch",e[e.CapabilityNamedBarrier=59]="CapabilityNamedBarrier",e[e.CapabilityPipeStorage=60]="CapabilityPipeStorage",e[e.CapabilityGroupNonUniform=61]="CapabilityGroupNonUniform",e[e.CapabilityGroupNonUniformVote=62]="CapabilityGroupNonUniformVote",e[e.CapabilityGroupNonUniformArithmetic=63]="CapabilityGroupNonUniformArithmetic",e[e.CapabilityGroupNonUniformBallot=64]="CapabilityGroupNonUniformBallot",e[e.CapabilityGroupNonUniformShuffle=65]="CapabilityGroupNonUniformShuffle",e[e.CapabilityGroupNonUniformShuffleRelative=66]="CapabilityGroupNonUniformShuffleRelative",e[e.CapabilityGroupNonUniformClustered=67]="CapabilityGroupNonUniformClustered",e[e.CapabilityGroupNonUniformQuad=68]="CapabilityGroupNonUniformQuad",e[e.CapabilityShaderLayer=69]="CapabilityShaderLayer",e[e.CapabilityShaderViewportIndex=70]="CapabilityShaderViewportIndex",e[e.CapabilityFragmentShadingRateKHR=4422]="CapabilityFragmentShadingRateKHR",e[e.CapabilitySubgroupBallotKHR=4423]="CapabilitySubgroupBallotKHR",e[e.CapabilityDrawParameters=4427]="CapabilityDrawParameters",e[e.CapabilitySubgroupVoteKHR=4431]="CapabilitySubgroupVoteKHR",e[e.CapabilityStorageBuffer16BitAccess=4433]="CapabilityStorageBuffer16BitAccess",e[e.CapabilityStorageUniformBufferBlock16=4433]="CapabilityStorageUniformBufferBlock16",e[e.CapabilityStorageUniform16=4434]="CapabilityStorageUniform16",e[e.CapabilityUniformAndStorageBuffer16BitAccess=4434]="CapabilityUniformAndStorageBuffer16BitAccess",e[e.CapabilityStoragePushConstant16=4435]="CapabilityStoragePushConstant16",e[e.CapabilityStorageInputOutput16=4436]="CapabilityStorageInputOutput16",e[e.CapabilityDeviceGroup=4437]="CapabilityDeviceGroup",e[e.CapabilityMultiView=4439]="CapabilityMultiView",e[e.CapabilityVariablePointersStorageBuffer=4441]="CapabilityVariablePointersStorageBuffer",e[e.CapabilityVariablePointers=4442]="CapabilityVariablePointers",e[e.CapabilityAtomicStorageOps=4445]="CapabilityAtomicStorageOps",e[e.CapabilitySampleMaskPostDepthCoverage=4447]="CapabilitySampleMaskPostDepthCoverage",e[e.CapabilityStorageBuffer8BitAccess=4448]="CapabilityStorageBuffer8BitAccess",e[e.CapabilityUniformAndStorageBuffer8BitAccess=4449]="CapabilityUniformAndStorageBuffer8BitAccess",e[e.CapabilityStoragePushConstant8=4450]="CapabilityStoragePushConstant8",e[e.CapabilityDenormPreserve=4464]="CapabilityDenormPreserve",e[e.CapabilityDenormFlushToZero=4465]="CapabilityDenormFlushToZero",e[e.CapabilitySignedZeroInfNanPreserve=4466]="CapabilitySignedZeroInfNanPreserve",e[e.CapabilityRoundingModeRTE=4467]="CapabilityRoundingModeRTE",e[e.CapabilityRoundingModeRTZ=4468]="CapabilityRoundingModeRTZ",e[e.CapabilityRayQueryProvisionalKHR=4471]="CapabilityRayQueryProvisionalKHR",e[e.CapabilityRayQueryKHR=4472]="CapabilityRayQueryKHR",e[e.CapabilityRayTraversalPrimitiveCullingKHR=4478]="CapabilityRayTraversalPrimitiveCullingKHR",e[e.CapabilityRayTracingKHR=4479]="CapabilityRayTracingKHR",e[e.CapabilityFloat16ImageAMD=5008]="CapabilityFloat16ImageAMD",e[e.CapabilityImageGatherBiasLodAMD=5009]="CapabilityImageGatherBiasLodAMD",e[e.CapabilityFragmentMaskAMD=5010]="CapabilityFragmentMaskAMD",e[e.CapabilityStencilExportEXT=5013]="CapabilityStencilExportEXT",e[e.CapabilityImageReadWriteLodAMD=5015]="CapabilityImageReadWriteLodAMD",e[e.CapabilityInt64ImageEXT=5016]="CapabilityInt64ImageEXT",e[e.CapabilityShaderClockKHR=5055]="CapabilityShaderClockKHR",e[e.CapabilitySampleMaskOverrideCoverageNV=5249]="CapabilitySampleMaskOverrideCoverageNV",e[e.CapabilityGeometryShaderPassthroughNV=5251]="CapabilityGeometryShaderPassthroughNV",e[e.CapabilityShaderViewportIndexLayerEXT=5254]="CapabilityShaderViewportIndexLayerEXT",e[e.CapabilityShaderViewportIndexLayerNV=5254]="CapabilityShaderViewportIndexLayerNV",e[e.CapabilityShaderViewportMaskNV=5255]="CapabilityShaderViewportMaskNV",e[e.CapabilityShaderStereoViewNV=5259]="CapabilityShaderStereoViewNV",e[e.CapabilityPerViewAttributesNV=5260]="CapabilityPerViewAttributesNV",e[e.CapabilityFragmentFullyCoveredEXT=5265]="CapabilityFragmentFullyCoveredEXT",e[e.CapabilityMeshShadingNV=5266]="CapabilityMeshShadingNV",e[e.CapabilityImageFootprintNV=5282]="CapabilityImageFootprintNV",e[e.CapabilityFragmentBarycentricNV=5284]="CapabilityFragmentBarycentricNV",e[e.CapabilityComputeDerivativeGroupQuadsNV=5288]="CapabilityComputeDerivativeGroupQuadsNV",e[e.CapabilityFragmentDensityEXT=5291]="CapabilityFragmentDensityEXT",e[e.CapabilityShadingRateNV=5291]="CapabilityShadingRateNV",e[e.CapabilityGroupNonUniformPartitionedNV=5297]="CapabilityGroupNonUniformPartitionedNV",e[e.CapabilityShaderNonUniform=5301]="CapabilityShaderNonUniform",e[e.CapabilityShaderNonUniformEXT=5301]="CapabilityShaderNonUniformEXT",e[e.CapabilityRuntimeDescriptorArray=5302]="CapabilityRuntimeDescriptorArray",e[e.CapabilityRuntimeDescriptorArrayEXT=5302]="CapabilityRuntimeDescriptorArrayEXT",e[e.CapabilityInputAttachmentArrayDynamicIndexing=5303]="CapabilityInputAttachmentArrayDynamicIndexing",e[e.CapabilityInputAttachmentArrayDynamicIndexingEXT=5303]="CapabilityInputAttachmentArrayDynamicIndexingEXT",e[e.CapabilityUniformTexelBufferArrayDynamicIndexing=5304]="CapabilityUniformTexelBufferArrayDynamicIndexing",e[e.CapabilityUniformTexelBufferArrayDynamicIndexingEXT=5304]="CapabilityUniformTexelBufferArrayDynamicIndexingEXT",e[e.CapabilityStorageTexelBufferArrayDynamicIndexing=5305]="CapabilityStorageTexelBufferArrayDynamicIndexing",e[e.CapabilityStorageTexelBufferArrayDynamicIndexingEXT=5305]="CapabilityStorageTexelBufferArrayDynamicIndexingEXT",e[e.CapabilityUniformBufferArrayNonUniformIndexing=5306]="CapabilityUniformBufferArrayNonUniformIndexing",e[e.CapabilityUniformBufferArrayNonUniformIndexingEXT=5306]="CapabilityUniformBufferArrayNonUniformIndexingEXT",e[e.CapabilitySampledImageArrayNonUniformIndexing=5307]="CapabilitySampledImageArrayNonUniformIndexing",e[e.CapabilitySampledImageArrayNonUniformIndexingEXT=5307]="CapabilitySampledImageArrayNonUniformIndexingEXT",e[e.CapabilityStorageBufferArrayNonUniformIndexing=5308]="CapabilityStorageBufferArrayNonUniformIndexing",e[e.CapabilityStorageBufferArrayNonUniformIndexingEXT=5308]="CapabilityStorageBufferArrayNonUniformIndexingEXT",e[e.CapabilityStorageImageArrayNonUniformIndexing=5309]="CapabilityStorageImageArrayNonUniformIndexing",e[e.CapabilityStorageImageArrayNonUniformIndexingEXT=5309]="CapabilityStorageImageArrayNonUniformIndexingEXT",e[e.CapabilityInputAttachmentArrayNonUniformIndexing=5310]="CapabilityInputAttachmentArrayNonUniformIndexing",e[e.CapabilityInputAttachmentArrayNonUniformIndexingEXT=5310]="CapabilityInputAttachmentArrayNonUniformIndexingEXT",e[e.CapabilityUniformTexelBufferArrayNonUniformIndexing=5311]="CapabilityUniformTexelBufferArrayNonUniformIndexing",e[e.CapabilityUniformTexelBufferArrayNonUniformIndexingEXT=5311]="CapabilityUniformTexelBufferArrayNonUniformIndexingEXT",e[e.CapabilityStorageTexelBufferArrayNonUniformIndexing=5312]="CapabilityStorageTexelBufferArrayNonUniformIndexing",e[e.CapabilityStorageTexelBufferArrayNonUniformIndexingEXT=5312]="CapabilityStorageTexelBufferArrayNonUniformIndexingEXT",e[e.CapabilityRayTracingNV=5340]="CapabilityRayTracingNV",e[e.CapabilityVulkanMemoryModel=5345]="CapabilityVulkanMemoryModel",e[e.CapabilityVulkanMemoryModelKHR=5345]="CapabilityVulkanMemoryModelKHR",e[e.CapabilityVulkanMemoryModelDeviceScope=5346]="CapabilityVulkanMemoryModelDeviceScope",e[e.CapabilityVulkanMemoryModelDeviceScopeKHR=5346]="CapabilityVulkanMemoryModelDeviceScopeKHR",e[e.CapabilityPhysicalStorageBufferAddresses=5347]="CapabilityPhysicalStorageBufferAddresses",e[e.CapabilityPhysicalStorageBufferAddressesEXT=5347]="CapabilityPhysicalStorageBufferAddressesEXT",e[e.CapabilityComputeDerivativeGroupLinearNV=5350]="CapabilityComputeDerivativeGroupLinearNV",e[e.CapabilityRayTracingProvisionalKHR=5353]="CapabilityRayTracingProvisionalKHR",e[e.CapabilityCooperativeMatrixNV=5357]="CapabilityCooperativeMatrixNV",e[e.CapabilityFragmentShaderSampleInterlockEXT=5363]="CapabilityFragmentShaderSampleInterlockEXT",e[e.CapabilityFragmentShaderShadingRateInterlockEXT=5372]="CapabilityFragmentShaderShadingRateInterlockEXT",e[e.CapabilityShaderSMBuiltinsNV=5373]="CapabilityShaderSMBuiltinsNV",e[e.CapabilityFragmentShaderPixelInterlockEXT=5378]="CapabilityFragmentShaderPixelInterlockEXT",e[e.CapabilityDemoteToHelperInvocationEXT=5379]="CapabilityDemoteToHelperInvocationEXT",e[e.CapabilitySubgroupShuffleINTEL=5568]="CapabilitySubgroupShuffleINTEL",e[e.CapabilitySubgroupBufferBlockIOINTEL=5569]="CapabilitySubgroupBufferBlockIOINTEL",e[e.CapabilitySubgroupImageBlockIOINTEL=5570]="CapabilitySubgroupImageBlockIOINTEL",e[e.CapabilitySubgroupImageMediaBlockIOINTEL=5579]="CapabilitySubgroupImageMediaBlockIOINTEL",e[e.CapabilityIntegerFunctions2INTEL=5584]="CapabilityIntegerFunctions2INTEL",e[e.CapabilityFunctionPointersINTEL=5603]="CapabilityFunctionPointersINTEL",e[e.CapabilityIndirectReferencesINTEL=5604]="CapabilityIndirectReferencesINTEL",e[e.CapabilitySubgroupAvcMotionEstimationINTEL=5696]="CapabilitySubgroupAvcMotionEstimationINTEL",e[e.CapabilitySubgroupAvcMotionEstimationIntraINTEL=5697]="CapabilitySubgroupAvcMotionEstimationIntraINTEL",e[e.CapabilitySubgroupAvcMotionEstimationChromaINTEL=5698]="CapabilitySubgroupAvcMotionEstimationChromaINTEL",e[e.CapabilityFPGAMemoryAttributesINTEL=5824]="CapabilityFPGAMemoryAttributesINTEL",e[e.CapabilityUnstructuredLoopControlsINTEL=5886]="CapabilityUnstructuredLoopControlsINTEL",e[e.CapabilityFPGALoopControlsINTEL=5888]="CapabilityFPGALoopControlsINTEL",e[e.CapabilityKernelAttributesINTEL=5892]="CapabilityKernelAttributesINTEL",e[e.CapabilityFPGAKernelAttributesINTEL=5897]="CapabilityFPGAKernelAttributesINTEL",e[e.CapabilityBlockingPipesINTEL=5945]="CapabilityBlockingPipesINTEL",e[e.CapabilityFPGARegINTEL=5948]="CapabilityFPGARegINTEL",e[e.CapabilityAtomicFloat32AddEXT=6033]="CapabilityAtomicFloat32AddEXT",e[e.CapabilityAtomicFloat64AddEXT=6034]="CapabilityAtomicFloat64AddEXT",e[e.CapabilityMax=2147483647]="CapabilityMax"}(Le||(Le={})),function(e){e[e.ExecutionModeInvocations=0]="ExecutionModeInvocations",e[e.ExecutionModeSpacingEqual=1]="ExecutionModeSpacingEqual",e[e.ExecutionModeSpacingFractionalEven=2]="ExecutionModeSpacingFractionalEven",e[e.ExecutionModeSpacingFractionalOdd=3]="ExecutionModeSpacingFractionalOdd",e[e.ExecutionModeVertexOrderCw=4]="ExecutionModeVertexOrderCw",e[e.ExecutionModeVertexOrderCcw=5]="ExecutionModeVertexOrderCcw",e[e.ExecutionModePixelCenterInteger=6]="ExecutionModePixelCenterInteger",e[e.ExecutionModeOriginUpperLeft=7]="ExecutionModeOriginUpperLeft",e[e.ExecutionModeOriginLowerLeft=8]="ExecutionModeOriginLowerLeft",e[e.ExecutionModeEarlyFragmentTests=9]="ExecutionModeEarlyFragmentTests",e[e.ExecutionModePointMode=10]="ExecutionModePointMode",e[e.ExecutionModeXfb=11]="ExecutionModeXfb",e[e.ExecutionModeDepthReplacing=12]="ExecutionModeDepthReplacing",e[e.ExecutionModeDepthGreater=14]="ExecutionModeDepthGreater",e[e.ExecutionModeDepthLess=15]="ExecutionModeDepthLess",e[e.ExecutionModeDepthUnchanged=16]="ExecutionModeDepthUnchanged",e[e.ExecutionModeLocalSize=17]="ExecutionModeLocalSize",e[e.ExecutionModeLocalSizeHint=18]="ExecutionModeLocalSizeHint",e[e.ExecutionModeInputPoints=19]="ExecutionModeInputPoints",e[e.ExecutionModeInputLines=20]="ExecutionModeInputLines",e[e.ExecutionModeInputLinesAdjacency=21]="ExecutionModeInputLinesAdjacency",e[e.ExecutionModeTriangles=22]="ExecutionModeTriangles",e[e.ExecutionModeInputTrianglesAdjacency=23]="ExecutionModeInputTrianglesAdjacency",e[e.ExecutionModeQuads=24]="ExecutionModeQuads",e[e.ExecutionModeIsolines=25]="ExecutionModeIsolines",e[e.ExecutionModeOutputVertices=26]="ExecutionModeOutputVertices",e[e.ExecutionModeOutputPoints=27]="ExecutionModeOutputPoints",e[e.ExecutionModeOutputLineStrip=28]="ExecutionModeOutputLineStrip",e[e.ExecutionModeOutputTriangleStrip=29]="ExecutionModeOutputTriangleStrip",e[e.ExecutionModeVecTypeHint=30]="ExecutionModeVecTypeHint",e[e.ExecutionModeContractionOff=31]="ExecutionModeContractionOff",e[e.ExecutionModeInitializer=33]="ExecutionModeInitializer",e[e.ExecutionModeFinalizer=34]="ExecutionModeFinalizer",e[e.ExecutionModeSubgroupSize=35]="ExecutionModeSubgroupSize",e[e.ExecutionModeSubgroupsPerWorkgroup=36]="ExecutionModeSubgroupsPerWorkgroup",e[e.ExecutionModeSubgroupsPerWorkgroupId=37]="ExecutionModeSubgroupsPerWorkgroupId",e[e.ExecutionModeLocalSizeId=38]="ExecutionModeLocalSizeId",e[e.ExecutionModeLocalSizeHintId=39]="ExecutionModeLocalSizeHintId",e[e.ExecutionModePostDepthCoverage=4446]="ExecutionModePostDepthCoverage",e[e.ExecutionModeDenormPreserve=4459]="ExecutionModeDenormPreserve",e[e.ExecutionModeDenormFlushToZero=4460]="ExecutionModeDenormFlushToZero",e[e.ExecutionModeSignedZeroInfNanPreserve=4461]="ExecutionModeSignedZeroInfNanPreserve",e[e.ExecutionModeRoundingModeRTE=4462]="ExecutionModeRoundingModeRTE",e[e.ExecutionModeRoundingModeRTZ=4463]="ExecutionModeRoundingModeRTZ",e[e.ExecutionModeStencilRefReplacingEXT=5027]="ExecutionModeStencilRefReplacingEXT",e[e.ExecutionModeOutputLinesNV=5269]="ExecutionModeOutputLinesNV",e[e.ExecutionModeOutputPrimitivesNV=5270]="ExecutionModeOutputPrimitivesNV",e[e.ExecutionModeDerivativeGroupQuadsNV=5289]="ExecutionModeDerivativeGroupQuadsNV",e[e.ExecutionModeDerivativeGroupLinearNV=5290]="ExecutionModeDerivativeGroupLinearNV",e[e.ExecutionModeOutputTrianglesNV=5298]="ExecutionModeOutputTrianglesNV",e[e.ExecutionModePixelInterlockOrderedEXT=5366]="ExecutionModePixelInterlockOrderedEXT",e[e.ExecutionModePixelInterlockUnorderedEXT=5367]="ExecutionModePixelInterlockUnorderedEXT",e[e.ExecutionModeSampleInterlockOrderedEXT=5368]="ExecutionModeSampleInterlockOrderedEXT",e[e.ExecutionModeSampleInterlockUnorderedEXT=5369]="ExecutionModeSampleInterlockUnorderedEXT",e[e.ExecutionModeShadingRateInterlockOrderedEXT=5370]="ExecutionModeShadingRateInterlockOrderedEXT",e[e.ExecutionModeShadingRateInterlockUnorderedEXT=5371]="ExecutionModeShadingRateInterlockUnorderedEXT",e[e.ExecutionModeMaxWorkgroupSizeINTEL=5893]="ExecutionModeMaxWorkgroupSizeINTEL",e[e.ExecutionModeMaxWorkDimINTEL=5894]="ExecutionModeMaxWorkDimINTEL",e[e.ExecutionModeNoGlobalOffsetINTEL=5895]="ExecutionModeNoGlobalOffsetINTEL",e[e.ExecutionModeNumSIMDWorkitemsINTEL=5896]="ExecutionModeNumSIMDWorkitemsINTEL",e[e.ExecutionModeMax=2147483647]="ExecutionModeMax"}(Ee||(Ee={})),function(e){e[e.AccessQualifierReadOnly=0]="AccessQualifierReadOnly",e[e.AccessQualifierWriteOnly=1]="AccessQualifierWriteOnly",e[e.AccessQualifierReadWrite=2]="AccessQualifierReadWrite",e[e.AccessQualifierMax=2147483647]="AccessQualifierMax"}(Ce||(Ce={})),function(e){e[e.SelectionControlMaskNone=0]="SelectionControlMaskNone",e[e.SelectionControlFlattenMask=1]="SelectionControlFlattenMask",e[e.SelectionControlDontFlattenMask=2]="SelectionControlDontFlattenMask"}(we||(we={})),function(e){e[e.LoopControlMaskNone=0]="LoopControlMaskNone",e[e.LoopControlUnrollMask=1]="LoopControlUnrollMask",e[e.LoopControlDontUnrollMask=2]="LoopControlDontUnrollMask",e[e.LoopControlDependencyInfiniteMask=4]="LoopControlDependencyInfiniteMask",e[e.LoopControlDependencyLengthMask=8]="LoopControlDependencyLengthMask",e[e.LoopControlMinIterationsMask=16]="LoopControlMinIterationsMask",e[e.LoopControlMaxIterationsMask=32]="LoopControlMaxIterationsMask",e[e.LoopControlIterationMultipleMask=64]="LoopControlIterationMultipleMask",e[e.LoopControlPeelCountMask=128]="LoopControlPeelCountMask",e[e.LoopControlPartialCountMask=256]="LoopControlPartialCountMask",e[e.LoopControlInitiationIntervalINTELMask=65536]="LoopControlInitiationIntervalINTELMask",e[e.LoopControlMaxConcurrencyINTELMask=131072]="LoopControlMaxConcurrencyINTELMask",e[e.LoopControlDependencyArrayINTELMask=262144]="LoopControlDependencyArrayINTELMask",e[e.LoopControlPipelineEnableINTELMask=524288]="LoopControlPipelineEnableINTELMask",e[e.LoopControlLoopCoalesceINTELMask=1048576]="LoopControlLoopCoalesceINTELMask",e[e.LoopControlMaxInterleavingINTELMask=2097152]="LoopControlMaxInterleavingINTELMask",e[e.LoopControlSpeculatedIterationsINTELMask=4194304]="LoopControlSpeculatedIterationsINTELMask"}(Te||(Te={}));var Be=function(){function e(e){this.ir=new de,this.global_struct_cache=[],this.forward_pointer_fixups=[],this.ir.spirv=e}return e.prototype.get_parsed_ir=function(){return this.ir},e.prototype.parse=function(){var e=this,t=this.ir.spirv,i=t.length;if(i<5)throw new Error("SPIRV file too small.");var r=t;if(r[0]===Ae(Me)&&function(e,t,i,r){void 0===i&&(i=0),void 0===r&&(r=e.length);for(var a=i;a<r;++a)e[a]=t[a]}(r,(function(e){return Ae(e)})),r[0]!==Me||!function(e){switch(e){case 99:case 65536:case 65792:case 66048:case 66304:case 66560:case 66816:return!0;default:return!1}}(r[1]))throw new Error("Invalid SPIRV format.");var a=r[3];if(a>4194303)throw new Error("ID bound exceeds limit of 0x3fffff.");this.ir.set_id_bounds(a);for(var o=5,s=[];o<i;){var n=new Ie;if(n.op=65535&t[o],n.count=t[o]>>16&65535,0===n.count)throw new Error("SPIR-V instructions cannot consume 0 words. Invalid SPIR-V file.");if(n.offset=o+1,n.length=n.count-1,(o+=n.count)>t.length)throw new Error("SPIR-V instruction goes out of bounds.");s.push(n)}if(s.forEach((function(t){return e.parseInstruction(t)})),this.forward_pointer_fixups.forEach((function(t){var i=e.get(w,t.first),r=e.get(w,t.second);i.member_types=r.member_types,i.basetype=r.basetype,i.self=r.self})),this.forward_pointer_fixups=[],this.current_function)throw new Error("Function was not terminated.");if(this.current_block)throw new Error("Block was not terminated.");if(0===this.ir.default_entry_point)throw new Error("There is no entry point in the SPIR-V module.")},e.prototype.parseInstruction=function(e){var t=this.stream(e),i=e.op,r=this.ir,a=e.length;switch(i){case ie.OpSourceContinued:case ie.OpSourceExtension:case ie.OpNop:case ie.OpModuleProcessed:break;case ie.OpString:this.set(_e,t[0],Ne(r.spirv,e.offset+1));break;case ie.OpMemoryModel:r.addressing_model=t[0],r.memory_model=t[1];break;case ie.OpSource:switch(t[0]){case ke.SourceLanguageESSL:r.source.es=!0,r.source.version=t[1],r.source.known=!0,r.source.hlsl=!1;break;case ke.SourceLanguageGLSL:r.source.es=!1,r.source.version=t[1],r.source.known=!0,r.source.hlsl=!1;break;case ke.SourceLanguageHLSL:r.source.es=!1,r.source.version=450,r.source.known=!0,r.source.hlsl=!0;break;default:r.source.known=!1}break;case ie.OpUndef:var o=t[0],n=t[1];this.set(ce,n,o),this.current_block&&this.current_block.ops.push(e);break;case ie.OpCapability:if(t[0]===Le.CapabilityKernel)throw new Error("Kernel capability not supported.");r.declared_capabilities.push(t[0]);break;case ie.OpExtension:var c=Ne(r.spirv,e.offset);r.declared_extensions.push(c);break;case ie.OpExtInstImport:n=t[0];"GLSL.std.450"===(c=Ne(r.spirv,e.offset+1))?this.set(ae,n,Q.GLSL):"DebugInfo"===c?this.set(ae,n,Q.SPV_debug_info):"SPV_AMD_shader_ballot"===c?this.set(ae,n,Q.SPV_AMD_shader_ballot):"SPV_AMD_shader_explicit_vertex_parameter"===c?this.set(ae,n,Q.SPV_AMD_shader_explicit_vertex_parameter):"SPV_AMD_shader_trinary_minmax"===c?this.set(ae,n,Q.SPV_AMD_shader_trinary_minmax):"SPV_AMD_gcn_shader"===c?this.set(ae,n,Q.SPV_AMD_gcn_shader):this.set(ae,n,Q.Unsupported);break;case ie.OpExtInst:this.current_block&&this.current_block.ops.push(e);break;case ie.OpEntryPoint:var _=new Re(t[1],t[0],Ne(r.spirv,e.offset+2));r.entry_points[t[1]]=_;for(var p=(_.name.length+1+3>>2)+2;p<e.length;p++)_.interface_variables.push(t[p]);r.set_name(t[1],_.name),r.default_entry_point||(r.default_entry_point=t[1]);break;case ie.OpExecutionMode:var l=r.entry_points[t[0]],u=t[1];switch(l.flags.set(u),u){case Ee.ExecutionModeInvocations:l.invocations=t[2];break;case Ee.ExecutionModeLocalSize:l.workgroup_size.x=t[2],l.workgroup_size.y=t[3],l.workgroup_size.z=t[4];break;case Ee.ExecutionModeOutputVertices:l.output_vertices=t[2]}break;case ie.OpName:n=t[0];r.set_name(n,Ne(r.spirv,e.offset+1));break;case ie.OpMemberName:n=t[0];var d=t[1];r.set_member_name(n,d,Ne(r.spirv,e.offset+2));break;case ie.OpDecorationGroup:break;case ie.OpGroupDecorate:var f=t[0],m=r.get_meta(f).decoration.decoration_flags,g=function(e){var i=t[e];m.for_each_bit((function(e){var t=e;Pe(t)?r.set_decoration_string(i,t,r.get_decoration_string(f,t)):(r.get_meta(i).decoration_word_offset[t]=r.get_meta(f).decoration_word_offset[t],r.set_decoration(i,t,r.get_decoration(f,t)))}))};for(p=1;p<a;p++)g(p);break;case ie.OpGroupMemberDecorate:var b=t[0],y=(m=r.get_meta(b).decoration.decoration_flags,function(e){var i=t[e],a=t[e+1];m.for_each_bit((function(e){var t=e;Pe(t)?r.set_member_decoration_string(i,a,t,r.get_decoration_string(b,t)):r.set_member_decoration(i,a,t,r.get_decoration(b,t))}))});for(p=1;p+1<a;p+=2)y(p);break;case ie.OpDecorate:case ie.OpDecorateId:n=t[0];var S=t[1];a>=3?(r.get_meta(n).decoration_word_offset[S]=e.offset+2,r.set_decoration(n,S,t[2])):r.set_decoration(n,S);break;case ie.OpDecorateStringGOOGLE:n=t[0],S=t[1];r.set_decoration_string(n,S,Ne(r.spirv,e.offset+2));break;case ie.OpMemberDecorate:n=t[0],d=t[1],S=t[2];a>=4?r.set_member_decoration(n,d,S,t[3]):r.set_member_decoration(n,d,S);break;case ie.OpMemberDecorateStringGOOGLE:n=t[0],d=t[1],S=t[2];r.set_member_decoration_string(n,d,S,Ne(r.spirv,e.offset+3));break;case ie.OpTypeVoid:n=t[0];(x=this.set(w,n)).basetype=L.Void;break;case ie.OpTypeBool:n=t[0];(x=this.set(w,n)).basetype=L.Boolean,x.width=1;break;case ie.OpTypeFloat:n=t[0];var I=t[1],x=this.set(w,n);if(64===I)x.basetype=L.Double;else if(32===I)x.basetype=L.Float;else{if(16!==I)throw new Error("Unrecognized bit-width of floating point type.");x.basetype=L.Half}x.width=I;break;case ie.OpTypeInt:n=t[0],I=t[1];var O=0!==t[2];(x=this.set(w,n)).basetype=O?function(e){switch(e){case 8:return L.SByte;case 16:return L.Short;case 32:return L.Int;case 64:return L.Int64;default:throw new Error("Invalid bit width.")}}(I):function(e){switch(e){case 8:return L.UByte;case 16:return L.UShort;case 32:return L.UInt;case 64:return L.UInt64;default:throw new Error("Invalid bit width.")}}(I),x.width=I;break;case ie.OpTypeVector:n=t[0];var k=t[2],C=this.get(w,t[1]),T=this.set(w,n);h(C,T),T.vecsize=k,T.self=n,T.parent_type=t[1];break;case ie.OpTypeMatrix:n=t[0];var D=t[2],A=(C=this.get(w,t[1]),this.set(w,n));h(C,A),A.columns=D,A.self=n,A.parent_type=t[1];break;case ie.OpTypeArray:n=t[0];var N=this.set(w,n),P=t[1];h(C=this.get(w,P),N),N.parent_type=P;var G=t[2];r.mark_used_as_array_length(G);var F=(le=this.maybe_get(U,G))&&!le.specialization;C.forward_pointer&&this.forward_pointer_fixups.push(new Oe(n,P)),N.array_size_literal.push(F),N.array.push(F?le.scalar():G);break;case ie.OpTypeRuntimeArray:n=t[0],C=this.get(w,t[1]),N=this.set(w,n);C.forward_pointer&&this.forward_pointer_fixups.push(new Oe(n,t[1])),h(C,N),N.array.push(0),N.array_size_literal.push(!0),N.parent_type=t[1];break;case ie.OpTypeImage:n=t[0];(x=this.set(w,n)).basetype=L.Image,x.image.type=t[1],x.image.dim=t[2],x.image.depth=1===t[3],x.image.arrayed=0!==t[4],x.image.ms=0!==t[5],x.image.sampled=t[6],x.image.format=t[7],x.image.access=a>=9?t[8]:Ce.AccessQualifierMax;break;case ie.OpTypeSampledImage:n=t[0];var z=t[1];x=this.set(w,n);h(this.get(w,z),x),x.basetype=L.SampledImage,x.self=n;break;case ie.OpTypeSampler:n=t[0];(x=this.set(w,n)).basetype=L.Sampler;break;case ie.OpTypePointer:n=t[0],C=this.maybe_get(w,t[2]);var H=this.set(w,n);C&&h(C,H),H.pointer=!0,H.pointer_depth++,H.storage=t[1],H.storage===v.StorageClassAtomicCounter&&(H.basetype=L.AtomicCounter),C&&C.forward_pointer&&this.forward_pointer_fixups.push(new Oe(n,t[2])),H.parent_type=t[2];break;case ie.OpTypeForwardPointer:n=t[0];(H=this.set(w,n)).pointer=!0,H.pointer_depth++,H.storage=t[1],H.forward_pointer=!0,H.storage===v.StorageClassAtomicCounter&&(H.basetype=L.AtomicCounter);break;case ie.OpTypeStruct:n=t[0];(x=this.set(w,n)).basetype=L.Struct;for(p=1;p<a;p++)x.member_types.push(t[p]);if(0===r.get_name(x.self).length){for(var q=0,K=this.global_struct_cache;q<K.length;q++){var X=K[q];if(r.get_name(x.self)===r.get_name(X)&&this.types_are_logically_equivalent(x,this.get(w,X))){x.type_alias=X;break}}0===x.type_alias&&this.global_struct_cache.push(n)}break;case ie.OpTypeFunction:n=t[0];var $=t[1],ee=this.set(W,n,$);for(p=2;p<a;p++)ee.parameter_types.push(t[p]);break;case ie.OpTypeAccelerationStructureKHR:n=t[0];(x=this.set(w,n)).basetype=L.AccelerationStructure;break;case ie.OpTypeRayQueryKHR:n=t[0];(x=this.set(w,n)).basetype=L.RayQuery;break;case ie.OpVariable:x=t[0],n=t[1];var te=t[2],oe=4===a?t[3]:0;if(te===v.StorageClassFunction){if(!this.current_function)throw new Error("No function currently in scope");this.current_function.add_local_variable(n)}this.set(E,n,x,te,oe);break;case ie.OpPhi:if(!this.current_function)throw new Error("No function currently in scope");if(!this.current_block)throw new Error("No block currently in scope");o=t[0],n=t[1];this.set(E,n,o,v.StorageClassFunction).phi_variable=!0,this.current_function.add_local_variable(n);for(p=2;p+2<=a;p+=2)this.current_block.phi_variables.push(new Y(t[p],t[p+1],n));break;case ie.OpSpecConstant:case ie.OpConstant:n=t[1];(x=this.get(w,t[0])).width>32?this.set(U,n,t[0],bigintFrom(t[3],t[2]),i===ie.OpSpecConstant):this.set(U,n,t[0],t[2],i===ie.OpSpecConstant);break;case ie.OpSpecConstantFalse:case ie.OpConstantFalse:this.set(U,t[1],t[0],0,i===ie.OpSpecConstantFalse);break;case ie.OpSpecConstantTrue:case ie.OpConstantTrue:this.set(U,t[1],t[0],1,i===ie.OpSpecConstantTrue);break;case ie.OpConstantNull:r.make_constant_null(t[1],t[0],!0);break;case ie.OpSpecConstantComposite:case ie.OpConstantComposite:n=t[1],x=t[0];var se=this.get(w,x);if(se.basetype===L.Struct||0!==se.array.length){var ne=t.slice(2);this.set(U,n,x,ne,a-2,i===ie.OpSpecConstantComposite)}else{if((ne=a-2)>4)throw new Error("OpConstantComposite only supports 1, 2, 3 and 4 elements.");var pe=s(4,(function(){return new U})),le=new Array(4);for(p=0;p<ne;p++){var ue=this.maybe_get(V,t[2+p]),he=this.maybe_get(ce,t[2+p]);if(ue){if(i===ie.OpConstantComposite)throw new Error("Specialization constant operation used in OpConstantComposite.");pe[p].make_null(this.get(w,ue.basetype)),pe[p].self=ue.self,pe[p].constant_type=ue.basetype,pe[p].specialization=!0,le[p]=pe[p]}else he?(pe[p].make_null(this.get(w,he.basetype)),pe[p].constant_type=he.basetype,le[p]=pe[p]):le[p]=this.get(U,t[2+p])}this.set(U,n,x,le,ne,i===ie.OpSpecConstantComposite)}break;case ie.OpFunction:var de=t[0];n=t[1],x=t[3];if(this.current_function)throw new Error("Must end a function before starting a new one!");this.current_function=this.set(j,n,de,x);break;case ie.OpFunctionParameter:x=t[0],n=t[1];if(!this.current_function)throw new Error("Must be in a function!");this.current_function.add_parameter(x,n),this.set(E,n,x,v.StorageClassFunction);break;case ie.OpFunctionEnd:if(this.current_block)throw new Error("Cannot end a function before ending the current block.\nLikely cause: If this SPIR-V was created from glslang HLSL, make sure the entry point is valid.");this.current_function=null;break;case ie.OpLabel:if(!this.current_function)throw new Error("Blocks cannot exist outside functions!");n=t[0];if(this.current_function.blocks.push(n),this.current_function.entry_block||(this.current_function.entry_block=n),this.current_block)throw new Error("Cannot start a block before ending the current block.");this.current_block=this.set(J,n);break;case ie.OpBranch:if(!this.current_block)throw new Error("Trying to end a non-existing block.");var fe=t[0];(ye=this.current_block).terminator=R.Direct,ye.next_block=fe,this.current_block=null;break;case ie.OpBranchConditional:if(!this.current_block)throw new Error("Trying to end a non-existing block.");if((ye=this.current_block).condition=t[0],ye.true_block=t[1],ye.false_block=t[2],ye.terminator=R.Select,ye.true_block===ye.false_block)if(ye.true_block!==ye.next_block&&ye.merge===M.MergeSelection){var me=r.increase_bound_by(2);(x=new w).basetype=L.Int,x.width=32,this.set(w,me,x);le=this.set(U,me+1,me);ye.condition=le.self,ye.default_block=ye.true_block,ye.terminator=R.MultiSelect,r.block_meta[ye.next_block]=r.block_meta[ye.next_block]||0,r.block_meta[ye.next_block]&=~re.BLOCK_META_SELECTION_MERGE_BIT,r.block_meta[ye.next_block]|=re.BLOCK_META_MULTISELECT_MERGE_BIT}else r.block_meta[ye.next_block]=r.block_meta[ye.next_block]||0,r.block_meta[ye.next_block]&=~re.BLOCK_META_SELECTION_MERGE_BIT,ye.next_block=ye.true_block,ye.condition=0,ye.true_block=0,ye.false_block=0,ye.merge_block=0,ye.merge=M.MergeNone,ye.terminator=R.Direct;this.current_block=null;break;case ie.OpSwitch:if(!(ye=this.current_block))throw new Error("Trying to end a non-existing block.");ye.terminator=R.MultiSelect,ye.condition=t[0],ye.default_block=t[1];var ge=a-2;if(ge%2==0)for(p=2;p+2<=a;p+=2)ye.cases_32bit.push(new Z(BigInt(t[p]),t[p+1]));if(ge%3==0)for(p=2;p+3<=a;p+=3)ye.cases_64bit.push(new Z(bigintFrom(t[p+1],t[p]),t[p+2]));r.block_meta[ye.next_block]=r.block_meta[ye.next_block]||0,r.block_meta[ye.next_block]|=re.BLOCK_META_MULTISELECT_MERGE_BIT,this.current_block=null;break;case ie.OpKill:if(!this.current_block)throw new Error("Trying to end a non-existing block.");this.current_block.terminator=R.Kill,this.current_block=null;break;case ie.OpTerminateRayKHR:if(!this.current_block)throw new Error("Trying to end a non-existing block.");this.current_block.terminator=R.TerminateRay,this.current_block=null;break;case ie.OpIgnoreIntersectionKHR:if(!this.current_block)throw new Error("Trying to end a non-existing block.");this.current_block.terminator=R.IgnoreIntersection,this.current_block=null;break;case ie.OpReturn:if(!this.current_block)throw new Error("Trying to end a non-existing block.");this.current_block.terminator=R.Return,this.current_block=null;break;case ie.OpReturnValue:if(!(ye=this.current_block))throw new Error("Trying to end a non-existing block.");ye.terminator=R.Return,ye.return_value=t[0],this.current_block=null;break;case ie.OpUnreachable:if(!this.current_block)throw new Error("Trying to end a non-existing block.");this.current_block.terminator=R.Unreachable,this.current_block=null;break;case ie.OpSelectionMerge:if(!(ye=this.current_block))throw new Error("Trying to modify a non-existing block.");ye.next_block=t[0],ye.merge=M.MergeSelection,r.block_meta[ye.next_block]=r.block_meta[ye.next_block]||0,r.block_meta[ye.next_block]|=re.BLOCK_META_SELECTION_MERGE_BIT,a>=2&&(t[1]&we.SelectionControlFlattenMask?ye.hint=B.HintFlatten:t[1]&we.SelectionControlDontFlattenMask&&(ye.hint=B.HintDontFlatten));break;case ie.OpLoopMerge:if(!(ye=this.current_block))throw new Error("Trying to modify a non-existing block.");ye.merge_block=t[0],ye.continue_block=t[1],ye.merge=M.MergeLoop,r.block_meta[ye.self]=r.block_meta[ye.self]||0,r.block_meta[ye.self]|=re.BLOCK_META_LOOP_HEADER_BIT,r.block_meta[ye.merge_block]=r.block_meta[ye.merge_block]||0,r.block_meta[ye.merge_block]|=re.BLOCK_META_LOOP_MERGE_BIT,r.continue_block_to_loop_header[ye.continue_block]=ye.self,ye.continue_block!==ye.self&&(r.block_meta[ye.continue_block]=r.block_meta[ye.continue_block]||0,r.block_meta[ye.continue_block]|=re.BLOCK_META_CONTINUE_BIT),a>=3&&(t[2]&Te.LoopControlUnrollMask?ye.hint=B.HintUnroll:t[2]&Te.LoopControlDontUnrollMask&&(ye.hint=B.HintDontUnroll));break;case ie.OpSpecConstantOp:if(a<3)throw new Error("OpSpecConstantOp not enough arguments.");o=t[0],n=t[1];var be=t[2];this.set(V,n,o,be,t.slice(3));break;case ie.OpLine:var ye;(ye=this.current_block)&&ye.ops.push(e);var ve=this.current_function;ve&&0===ve.entry_line.file_id&&(ve.entry_line.file_id=t[0],ve.entry_line.line_literal=t[1]);break;case ie.OpNoLine:this.current_block&&this.current_block.ops.push(e);break;default:if(a>=2)(x=this.maybe_get(w,t[0]))&&(r.load_type_width[t[1]]=x.width);if(!this.current_block)throw new Error("Currently no block to insert opcode.");this.current_block.ops.push(e)}},e.prototype.stream=function(e){if(0===e.length)return null;if(e.offset+e.length>this.ir.spirv.length)throw new Error("Compiler::stream() out of range.");return this.ir.spirv.slice(e.offset,e.offset+e.length)},e.prototype.set=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];this.ir.add_typed_id(e.type,t);var a=l.apply(void 0,o([e,this.ir.ids[t]],i,!1));return a.self=t,a},e.prototype.get=function(e,t){return p(e,this.ir.ids[t])},e.prototype.maybe_get=function(e,t){return this.ir.ids[t].get_type()===e.type?this.get(e,t):null},e.prototype.types_are_logically_equivalent=function(e,t){if(e.basetype!==t.basetype)return!1;if(e.width!==t.width)return!1;if(e.vecsize!==t.vecsize)return!1;if(e.columns!==t.columns)return!1;if(!n(e.array,t.array))return!1;if((e.basetype===L.Image||e.basetype===L.SampledImage)&&!e.image.equals(t.image))return!1;if(!n(e.member_types,t.member_types))return!1;for(var i=e.member_types.length,r=0;r<i;r++)if(!this.types_are_logically_equivalent(this.get(w,e.member_types[r]),this.get(w,t.member_types[r])))return!1;return!0},e}();function Ae(e){return e>>24&255|e>>8&65280|e<<8&16711680|e<<24&4278190080}function Ne(e,t){for(var i="",r=t;r<e.length;r++)for(var a=e[r],o=0;o<4;o++,a>>=8){var s=255&a;if(0===s)return i;i+=String.fromCharCode(s)}throw new Error("String was not terminated before EOF")}function Pe(e){return e===te.DecorationHlslSemanticGOOGLE}var Ge,Fe=function(e,t){this.name=e,this.execution_model=t},ze=function(){function e(){}return e.prototype.handle_terminator=function(e){return!0},e.prototype.follow_function_call=function(e){return!0},e.prototype.set_current_block=function(e){},e.prototype.rearm_current_block=function(e){},e.prototype.begin_function_scope=function(e,t){return!0},e.prototype.end_function_scope=function(e,t){return!0},e}();!function(e){e[e.Dim1D=0]="Dim1D",e[e.Dim2D=1]="Dim2D",e[e.Dim3D=2]="Dim3D",e[e.DimCube=3]="DimCube",e[e.DimRect=4]="DimRect",e[e.DimBuffer=5]="DimBuffer",e[e.DimSubpassData=6]="DimSubpassData",e[e.DimMax=2147483647]="DimMax"}(Ge||(Ge={}));var Ue,Ve,He=function(e){function t(t){var i=e.call(this)||this;return i.need_dummy_sampler=!1,i.compiler=t,i}return a(t,e),t.prototype.handle=function(e,t,i){if(this.need_dummy_sampler)return!1;var r=this.compiler;switch(e){case ie.OpLoad:if(i<3)return!1;var a=t[0];if(!((c=r.get(w,a)).basetype===L.Image&&1===c.image.sampled&&c.image.dim!==Ge.DimBuffer))return!0;var o=t[1],s=t[2];r.set(oe,o,"",a,!0),r.register_read(o,s,!0);break;case ie.OpImageFetch:case ie.OpImageQuerySizeLod:case ie.OpImageQuerySize:case ie.OpImageQueryLevels:case ie.OpImageQuerySamples:var n=r.maybe_get_backing_variable(t[2]);if(n)(c=r.get(w,n.basetype)).basetype===L.Image&&1===c.image.sampled&&c.image.dim!==Ge.DimBuffer&&(this.need_dummy_sampler=!0);break;case ie.OpInBoundsAccessChain:case ie.OpAccessChain:case ie.OpPtrAccessChain:if(i<3)return!1;var c;a=t[0];if(!((c=r.get(w,a)).basetype===L.Image&&1===c.image.sampled&&c.image.dim!==Ge.DimBuffer))return!0;o=t[1],s=t[2];r.set(oe,o,"",a,!0),r.register_read(o,s,!0),r.ir.ids[o].set_allow_type_rewrite()}return!0},t}(ze);!function(e){e[e.GLSLstd450Bad=0]="GLSLstd450Bad",e[e.GLSLstd450Round=1]="GLSLstd450Round",e[e.GLSLstd450RoundEven=2]="GLSLstd450RoundEven",e[e.GLSLstd450Trunc=3]="GLSLstd450Trunc",e[e.GLSLstd450FAbs=4]="GLSLstd450FAbs",e[e.GLSLstd450SAbs=5]="GLSLstd450SAbs",e[e.GLSLstd450FSign=6]="GLSLstd450FSign",e[e.GLSLstd450SSign=7]="GLSLstd450SSign",e[e.GLSLstd450Floor=8]="GLSLstd450Floor",e[e.GLSLstd450Ceil=9]="GLSLstd450Ceil",e[e.GLSLstd450Fract=10]="GLSLstd450Fract",e[e.GLSLstd450Radians=11]="GLSLstd450Radians",e[e.GLSLstd450Degrees=12]="GLSLstd450Degrees",e[e.GLSLstd450Sin=13]="GLSLstd450Sin",e[e.GLSLstd450Cos=14]="GLSLstd450Cos",e[e.GLSLstd450Tan=15]="GLSLstd450Tan",e[e.GLSLstd450Asin=16]="GLSLstd450Asin",e[e.GLSLstd450Acos=17]="GLSLstd450Acos",e[e.GLSLstd450Atan=18]="GLSLstd450Atan",e[e.GLSLstd450Sinh=19]="GLSLstd450Sinh",e[e.GLSLstd450Cosh=20]="GLSLstd450Cosh",e[e.GLSLstd450Tanh=21]="GLSLstd450Tanh",e[e.GLSLstd450Asinh=22]="GLSLstd450Asinh",e[e.GLSLstd450Acosh=23]="GLSLstd450Acosh",e[e.GLSLstd450Atanh=24]="GLSLstd450Atanh",e[e.GLSLstd450Atan2=25]="GLSLstd450Atan2",e[e.GLSLstd450Pow=26]="GLSLstd450Pow",e[e.GLSLstd450Exp=27]="GLSLstd450Exp",e[e.GLSLstd450Log=28]="GLSLstd450Log",e[e.GLSLstd450Exp2=29]="GLSLstd450Exp2",e[e.GLSLstd450Log2=30]="GLSLstd450Log2",e[e.GLSLstd450Sqrt=31]="GLSLstd450Sqrt",e[e.GLSLstd450InverseSqrt=32]="GLSLstd450InverseSqrt",e[e.GLSLstd450Determinant=33]="GLSLstd450Determinant",e[e.GLSLstd450MatrixInverse=34]="GLSLstd450MatrixInverse",e[e.GLSLstd450Modf=35]="GLSLstd450Modf",e[e.GLSLstd450ModfStruct=36]="GLSLstd450ModfStruct",e[e.GLSLstd450FMin=37]="GLSLstd450FMin",e[e.GLSLstd450UMin=38]="GLSLstd450UMin",e[e.GLSLstd450SMin=39]="GLSLstd450SMin",e[e.GLSLstd450FMax=40]="GLSLstd450FMax",e[e.GLSLstd450UMax=41]="GLSLstd450UMax",e[e.GLSLstd450SMax=42]="GLSLstd450SMax",e[e.GLSLstd450FClamp=43]="GLSLstd450FClamp",e[e.GLSLstd450UClamp=44]="GLSLstd450UClamp",e[e.GLSLstd450SClamp=45]="GLSLstd450SClamp",e[e.GLSLstd450FMix=46]="GLSLstd450FMix",e[e.GLSLstd450IMix=47]="GLSLstd450IMix",e[e.GLSLstd450Step=48]="GLSLstd450Step",e[e.GLSLstd450SmoothStep=49]="GLSLstd450SmoothStep",e[e.GLSLstd450Fma=50]="GLSLstd450Fma",e[e.GLSLstd450Frexp=51]="GLSLstd450Frexp",e[e.GLSLstd450FrexpStruct=52]="GLSLstd450FrexpStruct",e[e.GLSLstd450Ldexp=53]="GLSLstd450Ldexp",e[e.GLSLstd450PackSnorm4x8=54]="GLSLstd450PackSnorm4x8",e[e.GLSLstd450PackUnorm4x8=55]="GLSLstd450PackUnorm4x8",e[e.GLSLstd450PackSnorm2x16=56]="GLSLstd450PackSnorm2x16",e[e.GLSLstd450PackUnorm2x16=57]="GLSLstd450PackUnorm2x16",e[e.GLSLstd450PackHalf2x16=58]="GLSLstd450PackHalf2x16",e[e.GLSLstd450PackDouble2x32=59]="GLSLstd450PackDouble2x32",e[e.GLSLstd450UnpackSnorm2x16=60]="GLSLstd450UnpackSnorm2x16",e[e.GLSLstd450UnpackUnorm2x16=61]="GLSLstd450UnpackUnorm2x16",e[e.GLSLstd450UnpackHalf2x16=62]="GLSLstd450UnpackHalf2x16",e[e.GLSLstd450UnpackSnorm4x8=63]="GLSLstd450UnpackSnorm4x8",e[e.GLSLstd450UnpackUnorm4x8=64]="GLSLstd450UnpackUnorm4x8",e[e.GLSLstd450UnpackDouble2x32=65]="GLSLstd450UnpackDouble2x32",e[e.GLSLstd450Length=66]="GLSLstd450Length",e[e.GLSLstd450Distance=67]="GLSLstd450Distance",e[e.GLSLstd450Cross=68]="GLSLstd450Cross",e[e.GLSLstd450Normalize=69]="GLSLstd450Normalize",e[e.GLSLstd450FaceForward=70]="GLSLstd450FaceForward",e[e.GLSLstd450Reflect=71]="GLSLstd450Reflect",e[e.GLSLstd450Refract=72]="GLSLstd450Refract",e[e.GLSLstd450FindILsb=73]="GLSLstd450FindILsb",e[e.GLSLstd450FindSMsb=74]="GLSLstd450FindSMsb",e[e.GLSLstd450FindUMsb=75]="GLSLstd450FindUMsb",e[e.GLSLstd450InterpolateAtCentroid=76]="GLSLstd450InterpolateAtCentroid",e[e.GLSLstd450InterpolateAtSample=77]="GLSLstd450InterpolateAtSample",e[e.GLSLstd450InterpolateAtOffset=78]="GLSLstd450InterpolateAtOffset",e[e.GLSLstd450NMin=79]="GLSLstd450NMin",e[e.GLSLstd450NMax=80]="GLSLstd450NMax",e[e.GLSLstd450NClamp=81]="GLSLstd450NClamp",e[e.GLSLstd450Count=82]="GLSLstd450Count"}(Ue||(Ue={})),function(e){e[e.PlsNone=0]="PlsNone",e[e.PlsR11FG11FB10F=1]="PlsR11FG11FB10F",e[e.PlsR32F=2]="PlsR32F",e[e.PlsRG16F=3]="PlsRG16F",e[e.PlsRGB10A2=4]="PlsRGB10A2",e[e.PlsRGBA8=5]="PlsRGBA8",e[e.PlsRG16=6]="PlsRG16",e[e.PlsRGBA8I=7]="PlsRGBA8I",e[e.PlsRG16I=8]="PlsRG16I",e[e.PlsRGB10A2UI=9]="PlsRGB10A2UI",e[e.PlsRGBA8UI=10]="PlsRGBA8UI",e[e.PlsRG16UI=11]="PlsRG16UI",e[e.PlsR32UI=12]="PlsR32UI"}(Ve||(Ve={}));var qe=function(){this.discard_literal="discard",this.demote_literal="demote",this.null_pointer_literal="",this.float_literal_suffix=!1,this.double_literal_suffix=!0,this.uint32_t_literal_suffix=!0,this.long_long_literal_suffix=!1,this.basic_int_type="int",this.basic_uint_type="uint",this.basic_int8_type="int8_t",this.basic_uint8_type="uint8_t",this.basic_int16_type="int16_t",this.basic_uint16_type="uint16_t",this.int16_t_literal_suffix="s",this.uint16_t_literal_suffix="us",this.nonuniform_qualifier="nonuniformEXT",this.boolean_mix_function="mix",this.swizzle_is_function=!1,this.shared_is_implied=!1,this.unsized_array_supported=!0,this.explicit_struct_type=!1,this.use_initializer_list=!1,this.use_typed_initializer_list=!1,this.can_declare_struct_inline=!0,this.can_declare_arrays_inline=!0,this.native_row_major_matrix=!0,this.use_constructor_splatting=!0,this.allow_precision_qualifiers=!1,this.can_swizzle_scalar=!1,this.force_gl_in_out_block=!1,this.can_return_array=!0,this.allow_truncated_access_chain=!1,this.supports_extensions=!1,this.supports_empty_struct=!1,this.array_is_value_type=!0,this.buffer_offset_array_is_value_type=!0,this.comparison_image_samples_scalar=!1,this.native_pointers=!1,this.support_small_type_sampling_result=!1,this.support_case_fallthrough=!0,this.use_array_constructor=!1,this.needs_row_major_load_workaround=!1,this.support_pointer_to_pointer=!1,this.support_precise_qualifier=!1,this.support_64bit_switch=!1,this.workgroup_size_is_hidden=!1},Ke=function(e){function t(t,i){var r=e.call(this)||this;return r.compiler=t,r.variables=i,r}return a(t,e),t.prototype.handle=function(e,t,i){var r=this.compiler,a=this.variables,o=0,s=0;switch(e){default:break;case ie.OpFunctionCall:if(i<3)return!1;var n=i-3;s+=3;for(var c=0;c<n;c++){(_=r.maybe_get(E,t[s+c]))&&Xe(_.storage)&&a.add(t[s+c])}break;case ie.OpSelect:if(i<5)return!1;n=i-3;s+=3;for(c=0;c<n;c++){(_=r.maybe_get(E,t[s+c]))&&Xe(_.storage)&&a.add(t[s+c])}break;case ie.OpPhi:if(i<2)return!1;n=i-2;s+=2;for(c=0;c<n;c+=2){(_=r.maybe_get(E,t[s+c]))&&Xe(_.storage)&&a.add(t[s+c])}break;case ie.OpAtomicStore:case ie.OpStore:if(i<1)return!1;o=t[s];break;case ie.OpCopyMemory:if(i<2)return!1;(_=r.maybe_get(E,t[s]))&&Xe(_.storage)&&a.add(t[s]),(_=r.maybe_get(E,t[s+1]))&&Xe(_.storage)&&a.add(t[s+1]);break;case ie.OpExtInst:if(i<5)return!1;switch(r.get(ae,t[s+2]).ext){case Q.GLSL:switch(t[s+3]){case Ue.GLSLstd450InterpolateAtCentroid:case Ue.GLSLstd450InterpolateAtSample:case Ue.GLSLstd450InterpolateAtOffset:(_=r.maybe_get(E,t[s+4]))&&Xe(_.storage)&&a.add(t[s+4]);break;case Ue.GLSLstd450Modf:case Ue.GLSLstd450Fract:(_=r.maybe_get(E,t[s+5]))&&Xe(_.storage)&&a.add(t[s+5])}break;case Q.SPV_AMD_shader_explicit_vertex_parameter:var _;if(1===t[s+3])(_=r.maybe_get(E,t[s+4]))&&Xe(_.storage)&&a.add(t[s+4])}break;case ie.OpAccessChain:case ie.OpInBoundsAccessChain:case ie.OpPtrAccessChain:case ie.OpLoad:case ie.OpCopyObject:case ie.OpImageTexelPointer:case ie.OpAtomicLoad:case ie.OpAtomicExchange:case ie.OpAtomicCompareExchange:case ie.OpAtomicCompareExchangeWeak:case ie.OpAtomicIIncrement:case ie.OpAtomicIDecrement:case ie.OpAtomicIAdd:case ie.OpAtomicISub:case ie.OpAtomicSMin:case ie.OpAtomicUMin:case ie.OpAtomicSMax:case ie.OpAtomicUMax:case ie.OpAtomicAnd:case ie.OpAtomicOr:case ie.OpAtomicXor:case ie.OpArrayLength:if(i<3)return!1;o=t[s+2]}o&&((_=r.maybe_get(E,o))&&Xe(_.storage)&&a.add(o));return!0},t}(ze);function Xe(e){switch(e){case v.StorageClassInput:case v.StorageClassOutput:case v.StorageClassUniform:case v.StorageClassUniformConstant:case v.StorageClassAtomicCounter:case v.StorageClassPushConstant:case v.StorageClassStorageBuffer:return!0;default:return!1}}var je=function(e,t,i,r){this.name="",this.id=e,this.type_id=t,this.base_type_id=i,this.name=r},We=function(){},Qe=function(){this.uniform_buffers=[],this.storage_buffers=[],this.stage_inputs=[],this.stage_outputs=[],this.subpass_inputs=[],this.storage_images=[],this.sampled_images=[],this.atomic_counters=[],this.acceleration_structures=[],this.push_constant_buffers=[],this.separate_images=[],this.separate_samplers=[],this.builtin_inputs=[],this.builtin_outputs=[]},Ye=function(e,t,i){this.combined_id=e,this.image_id=t,this.sampler_id=i},Ze=function(e){function t(t){var i=e.call(this)||this;return i.parameter_remapping=[],i.functions=[],i.compiler=t,i}return a(t,e),t.prototype.handle=function(e,t,i){var r=this.compiler,a=!1;switch(e){case ie.OpLoad:if(i<3)return!1;var o=t[0],s=(C=r.get(w,o)).basetype===L.Image&&1===C.image.sampled,n=C.basetype===L.Sampler;if(!s&&!n)return!0;var c=t[1],_=t[2];return r.set(oe,c,"",o,!0),r.register_read(c,_,!0),!0;case ie.OpInBoundsAccessChain:case ie.OpAccessChain:case ie.OpPtrAccessChain:if(i<3)return!1;o=t[0],s=(C=r.get(w,o)).basetype===L.Image&&1===C.image.sampled;if(n=C.basetype===L.Sampler)throw new Error("Attempting to use arrays or structs of separate samplers. This is not possible to statically remap to plain GLSL.");if(s){c=t[1],_=t[2];r.set(oe,c,"",o,!0),r.register_read(c,_,!0)}return!0;case ie.OpImageFetch:case ie.OpImageQuerySizeLod:case ie.OpImageQuerySize:case ie.OpImageQueryLevels:case ie.OpImageQuerySamples:if(!(O=r.maybe_get_backing_variable(t[2])))return!0;if((C=r.get(w,O.basetype)).basetype===L.Image&&1===C.image.sampled&&C.image.dim!==Ge.DimBuffer){if(0===r.dummy_sampler_id)throw new Error("texelFetch without sampler was found, but no dummy sampler has been created with build_dummy_sampler_for_combined_images().");a=!0;break}return!0;case ie.OpSampledImage:break;default:return!0}if(0!==this.functions.length){var p=this.functions[this.functions.length-1];if(p.do_combined_parameters){var l=t[2],u=r.maybe_get_backing_variable(l);u&&(l=u.self);var d=a?r.dummy_sampler_id:t[3],f=r.maybe_get_backing_variable(d);f&&(d=f.self);var m=t[1],g=r.get(w,t[0]);this.register_combined_image_sampler(p,m,l,d,g.image.depth)}}var b=this.remap_parameter(t[2]),y=a?r.dummy_sampler_id:this.remap_parameter(t[3]);if(!r.combined_image_samplers.find((function(e){return e.image_id===b&&e.sampler_id===y}))){var S=void 0,I=void 0;if(a){S=r.ir.increase_bound_by(1);var x=r.set(w,S);h(r.expression_type(t[2]),x),x.self=S,x.basetype=L.SampledImage,x.image.depth=!1,I=0}else S=t[0],I=t[1];var O,k=(c=r.ir.increase_bound_by(2))+0,C=(m=c+1,r.set(w,k));if(h(r.get(w,S),C),C.pointer=!0,C.storage=v.StorageClassUniformConstant,C.parent_type=k,r.set(E,m,k,v.StorageClassUniformConstant,0),(y&&r.has_decoration(y,te.DecorationRelaxedPrecision)||b&&r.has_decoration(b,te.DecorationRelaxedPrecision)||I&&r.has_decoration(I,te.DecorationRelaxedPrecision))&&r.set_decoration(m,te.DecorationRelaxedPrecision),O=r.maybe_get_backing_variable(b)){var T=r.get(w,O.basetype);C.array=T.array,C.array_size_literal=T.array_size_literal}r.combined_image_samplers.push(new Ye(m,b,y))}return!0},t.prototype.begin_function_scope=function(e,t){if(t<3)return!1;var i=this.compiler.get(j,e[2]);return e=e.slice(3),t-=3,this.push_remap_parameters(i,e,t),this.functions.push(i),!0},t.prototype.end_function_scope=function(e,t){if(t<3)return!1;var i=this.functions,r=this.compiler,a=r.get(j,e[2]);e=e.slice(3),this.pop_remap_parameters(),a.do_combined_parameters=!1;var o=i.pop().combined_parameters;if(0===i.length)return!0;var s=i[i.length-1];if(s.do_combined_parameters)for(var n=0,c=o;n<c.length;n++){var _=c[n],p=_.global_image?_.image_id:e[_.image_id],l=_.global_sampler?_.sampler_id:e[_.sampler_id],u=r.maybe_get_backing_variable(p),h=r.maybe_get_backing_variable(l);u&&(p=u.self),h&&(l=h.self),this.register_combined_image_sampler(s,0,p,l,_.depth)}return!0},t.prototype.remap_parameter=function(e){var t=this.compiler.maybe_get_backing_variable(e);t&&(e=t.self);var i=this.parameter_remapping;if(0===i.length)return e;var r=i[i.length-1][e];return void 0!==r?r:e},t.prototype.push_remap_parameters=function(e,t,i){for(var r=[],a=0;a<i;a++)r[e.arguments[a].id]=this.remap_parameter(t[a]);this.parameter_remapping.push(r)},t.prototype.pop_remap_parameters=function(){this.parameter_remapping.pop()},t.prototype.register_combined_image_sampler=function(e,t,i,r,a){var o=new K(0,i,r,!0,!0,a),s=e.arguments.find((function(e){return e.id===i})),n=e.arguments.find((function(e){return e.id===r}));if(s&&(o.global_image=!1,o.image_id=e.arguments.indexOf(s)),n&&(o.global_sampler=!1,o.sampler_id=e.arguments.indexOf(n)),!o.global_image||!o.global_sampler){var c=e.combined_parameters.find((function(e){return o.image_id===e.image_id&&o.sampler_id===e.sampler_id&&o.global_image===e.global_image&&o.global_sampler===e.global_sampler})),_=this.compiler;if(!c){var p=_.ir.increase_bound_by(3),l=p,u=p+1,d=p+2,f=_.expression_type(i),m=_.set(w,l),g=_.set(w,u);h(f,m),m.self=l,m.basetype=L.SampledImage,m.pointer=!1,m.storage=v.StorageClassGeneric,m.image.depth=a,h(m,g),g.pointer=!0,g.storage=v.StorageClassUniformConstant,g.parent_type=l,_.set(E,d,u,v.StorageClassFunction,0),(_.has_decoration(r,te.DecorationRelaxedPrecision)||_.has_decoration(i,te.DecorationRelaxedPrecision)||t&&_.has_decoration(t,te.DecorationRelaxedPrecision))&&_.set_decoration(d,te.DecorationRelaxedPrecision),o.id=d,_.set_name(d,"SPIRV_Cross_Combined"+_.to_name(i)+_.to_name(r)),e.combined_parameters.push(o),e.shadow_arguments.push(new q(u,d,0,0,!0))}}},t}(ze),Je=function(){function e(){this.v=-1}return e.prototype.get=function(){return this.v},e.prototype.set=function(e){this.v=e},e}(),$e=function(){function e(e){this.dominator=0,this.cfg=e}return e.prototype.add_block=function(e){this.cfg.get_immediate_dominator(e)&&(this.dominator?e!==this.dominator&&(this.dominator=this.cfg.find_common_dominator(e,this.dominator)):this.dominator=e)},e.prototype.get_dominator=function(){return this.dominator},e.prototype.lift_continue_block_dominator=function(){if(this.dominator){var e=this.cfg,t=e.get_compiler().get(J,this.dominator),i=e.get_visit_order(this.dominator),r=!1;switch(t.terminator){case R.Direct:e.get_visit_order(t.next_block)>i&&(r=!0);break;case R.Select:e.get_visit_order(t.true_block)>i&&(r=!0),e.get_visit_order(t.false_block)>i&&(r=!0);break;case R.MultiSelect:for(var a=0,o=e.get_compiler().get_case_list(t);a<o.length;a++){var s=o[a];e.get_visit_order(s.block)>i&&(r=!0)}t.default_block&&e.get_visit_order(t.default_block)>i&&(r=!0)}r&&(this.dominator=e.get_function().entry_block)}},e}();function et(e,t,i){return t[i]||(t[i]="number"==typeof e||"string"==typeof e?e:new e),t[i]}var tt,it=function(){function e(e,t){this.preceding_edges=[],this.succeeding_edges=[],this.immediate_dominators=[],this.visit_order=[],this.post_order=[],this.empty_vector=[],this.visit_count=0,this.compiler=e,this.func=t,this.build_post_order_visit_order(),this.build_immediate_dominators()}return e.prototype.get_compiler=function(){return this.compiler},e.prototype.get_function=function(){return this.func},e.prototype.get_immediate_dominator=function(e){var t=this.immediate_dominators[e];return t||0},e.prototype.get_visit_order=function(e){var t=this.visit_order[e];console.assert(t);var i=t.get();return console.assert(i>0),i},e.prototype.find_common_dominator=function(e,t){for(;e!==t;)this.get_visit_order(e)<this.get_visit_order(t)?e=this.get_immediate_dominator(e):t=this.get_immediate_dominator(t);return e},e.prototype.get_preceding_edges=function(e){return this.preceding_edges[e]||this.empty_vector},e.prototype.get_succeeding_edges=function(e){return this.succeeding_edges[e]||this.empty_vector},e.prototype.walk_from=function(e,t,i){if(!e.has(t)&&(e.add(t),i(t)))for(var r=0,a=this.get_succeeding_edges(t);r<a.length;r++){var o=a[r];this.walk_from(e,o,i)}},e.prototype.find_loop_dominator=function(e){for(;e!==J.NoDominator;){var t=this.preceding_edges[e];if(!t)return J.NoDominator;if(0===t.length)return J.NoDominator;for(var i=J.NoDominator,r=!1,a=0,o=t;a<o.length;a++){var s=o[a],n=this.compiler.get(J,s);if(n.merge===M.MergeLoop&&n.merge_block===e){i=s,r=!0;break}if(n.merge===M.MergeSelection&&n.next_block===e){i=s;break}}if(i===J.NoDominator&&(i=t[0]),e=i,!r&&e)if(this.compiler.get(J,e).merge===M.MergeLoop)return e}return e},e.prototype.node_terminates_control_flow_in_sub_graph=function(e,t){var i=this.compiler,r=i.get(J,e),a=0;for(r.merge===M.MergeLoop&&(a=r.merge_block);t!==e;){var o=this.preceding_edges[t];if(!o)return!1;for(var s=new $e(this),n=0,c=o;n<c.length;n++){var _=c[n];s.add_block(_)}var p=s.get_dominator();if(0===p)return!1;var l=i.get(J,p),u=!1,h=!1;if(a&&l.terminator===R.Select){var d=i.get(J,l.true_block),f=i.get(J,l.false_block),m=i.get(J,a);u=i.execution_is_branchless(d,m),h=i.execution_is_branchless(f,m)}if(!(l.merge===M.MergeSelection&&l.next_block===t||l.merge===M.MergeLoop&&l.merge_block===t||l.terminator===R.Direct&&l.next_block===t||l.terminator===R.Select&&l.true_block===t&&h||l.terminator===R.Select&&l.false_block===t&&u))return!1;t=p}return!0},e.prototype.add_branch=function(e,t){var i=function(e,t){e.indexOf(t)<0&&e.push(t)};i(et(Array,this.preceding_edges,t),e),i(et(Array,this.succeeding_edges,e),t)},e.prototype.build_post_order_visit_order=function(){var e=this.func.entry_block;this.visit_count=0,this.visit_order=[],this.post_order=[],this.post_order_visit(e)},e.prototype.build_immediate_dominators=function(){this.immediate_dominators=[],this.immediate_dominators[this.func.entry_block]=this.func.entry_block;for(var e=this.post_order.length;e;e--){var t=this.post_order[e-1],i=et(Array,this.preceding_edges,t);if(0!==i.length)for(var r=0,a=i;r<a.length;r++){var o=a[r];et(0,this.immediate_dominators,t)?(console.assert(et(0,this.immediate_dominators,o)),this.immediate_dominators[t]=this.find_common_dominator(this.immediate_dominators[t],o)):this.immediate_dominators[t]=o}}},e.prototype.post_order_visit=function(e){if(this.has_visited_forward_edge(e))return!0;if(this.is_back_edge(e))return!1;et(Je,this.visit_order,e).set(0);var t=this.compiler.get(J,e);switch(t.merge===M.MergeLoop&&this.post_order_visit(t.merge_block)&&this.add_branch(e,t.merge_block),t.terminator){case R.Direct:this.post_order_visit(t.next_block)&&this.add_branch(e,t.next_block);break;case R.Select:this.post_order_visit(t.true_block)&&this.add_branch(e,t.true_block),this.post_order_visit(t.false_block)&&this.add_branch(e,t.false_block);break;case R.MultiSelect:for(var i=0,r=this.compiler.get_case_list(t);i<r.length;i++){var a=r[i];this.post_order_visit(a.block)&&this.add_branch(e,a.block)}t.default_block&&this.post_order_visit(t.default_block)&&this.add_branch(e,t.default_block)}if(t.merge===M.MergeSelection&&this.post_order_visit(t.next_block))if(this.preceding_edges.hasOwnProperty(t.next_block)){var o=this.preceding_edges[t.next_block],s=0;this.succeeding_edges.hasOwnProperty(e)&&(s=this.succeeding_edges[e].length),t.terminator===R.MultiSelect&&1===s?0===o.length&&this.add_branch(e,t.next_block):1===o.length&&o[0]!==e&&this.add_branch(e,t.next_block)}else this.add_branch(e,t.next_block);return et(Je,this.visit_order,e).set(++this.visit_count),this.post_order.push(e),!0},e.prototype.is_back_edge=function(e){return this.visit_order.hasOwnProperty(e)&&0===this.visit_order[e].get()},e.prototype.has_visited_forward_edge=function(e){return this.visit_order.hasOwnProperty(e)&&this.visit_order[e].get()>0},e}(),rt=function(e){function t(t){var i=e.call(this)||this;return i.function_cfgs=[],i.compiler=t,i}return a(t,e),t.prototype.handle=function(e,t,i){return!0},t.prototype.follow_function_call=function(e){return!this.function_cfgs.hasOwnProperty(e.self)&&(this.function_cfgs[e.self]=new it(this.compiler,e),!0)},t}(ze),at=function(e){function i(t,i){var r=e.call(this)||this;return r.accessed_variables_to_block=[],r.accessed_temporaries_to_block=[],r.result_id_to_type=[],r.complete_write_variables_to_block=[],r.partial_write_variables_to_block=[],r.access_chain_expressions=new Set,r.access_chain_children=[],r.current_block=null,r.compiler=t,r.entry=i,r}return a(i,e),i.prototype.follow_function_call=function(e){return!1},i.prototype.set_current_block=function(e){var t=this,i=this.compiler;this.current_block=e;var r=function(r){for(var a=i.get(J,r),o=0,s=a.phi_variables;o<s.length;o++){var n=s[o];n.parent===e.self&&(et(Set,t.accessed_variables_to_block,n.function_variable).add(e.self),et(Set,t.accessed_variables_to_block,n.function_variable).add(a.self),t.notify_variable_access(n.local_variable,e.self))}};switch(e.terminator){case R.Direct:this.notify_variable_access(e.condition,e.self),r(e.next_block);break;case R.Select:this.notify_variable_access(e.condition,e.self),r(e.true_block),r(e.false_block);break;case R.MultiSelect:this.notify_variable_access(e.condition,e.self);for(var a=0,o=i.get_case_list(e);a<o.length;a++){r(o[a].block)}e.default_block&&r(e.default_block)}},i.prototype.notify_variable_access=function(e,t){var i=this;if(0!==e){if(this.access_chain_children.hasOwnProperty(e))this.access_chain_children[e].forEach((function(e){return i.notify_variable_access(e,t)}));this.id_is_phi_variable(e)?et(Set,this.accessed_variables_to_block,e).add(t):this.id_is_potential_temporary(e)&&et(Set,this.accessed_temporaries_to_block,e).add(t)}},i.prototype.id_is_phi_variable=function(e){if(e>=this.compiler.get_current_id_bound())return!1;var t=this.compiler.maybe_get(E,e);return!!t&&t.phi_variable},i.prototype.id_is_potential_temporary=function(e){return!(e>=this.compiler.get_current_id_bound())&&(this.compiler.ir.ids[e].empty()||this.compiler.ir.ids[e].get_type()===t.TypeExpression)},i.prototype.handle=function(e,t,i){var r=this.compiler,a=r.instruction_to_result_type(e,t,i);switch(a&&(this.result_id_to_type[a.result_id]=a.result_type),e){case ie.OpStore:if(i<2)return!1;var o=t[0];(u=r.maybe_get_backing_variable(o))&&(et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self),u.self===o?et(Set,this.complete_write_variables_to_block,u.self).add(this.current_block.self):et(Set,this.partial_write_variables_to_block,u.self).add(this.current_block.self)),this.notify_variable_access(t[0],this.current_block.self),this.notify_variable_access(t[1],this.current_block.self);break;case ie.OpAccessChain:case ie.OpInBoundsAccessChain:case ie.OpPtrAccessChain:if(i<3)return!1;o=t[2];(u=this.compiler.maybe_get(E,o))&&(et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self),et(Set,this.access_chain_children,t[1]).add(u.self));for(var s=2;s<i;s++)this.notify_variable_access(t[s],this.current_block.self),et(Set,this.access_chain_children,t[1]).add(t[s]);this.notify_variable_access(t[1],this.current_block.self);var n=r.set(oe,t[1],"",t[0],!0),c=r.maybe_get_backing_variable(o);n.loaded_from=c?c.self:0,r.ir.ids[t[1]].set_allow_type_rewrite(),this.access_chain_expressions.add(t[1]);break;case ie.OpCopyMemory:if(i<2)return!1;var _=t[0],p=t[1];(u=r.maybe_get_backing_variable(_))&&(et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self),u.self===_?et(Set,this.complete_write_variables_to_block,u.self).add(this.current_block.self):et(Set,this.partial_write_variables_to_block,u.self).add(this.current_block.self));for(s=0;s<2;s++)this.notify_variable_access(t[s],this.current_block.self);(u=r.maybe_get_backing_variable(p))&&et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self);break;case ie.OpCopyObject:if(i<3)return!1;(u=r.maybe_get_backing_variable(t[2]))&&et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self),this.notify_variable_access(t[1],this.current_block.self),this.access_chain_expressions.has(t[2])&&this.access_chain_expressions.add(t[1]),this.notify_variable_access(t[2],this.current_block.self);break;case ie.OpLoad:if(i<3)return!1;o=t[2];(u=r.maybe_get_backing_variable(o))&&et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self),this.notify_variable_access(t[1],this.current_block.self),this.notify_variable_access(t[2],this.current_block.self);break;case ie.OpFunctionCall:if(i<3)return!1;r.get_type(t[0]).basetype!==L.Void&&this.notify_variable_access(t[1],this.current_block.self),i-=3,t=t.slice(3);for(s=0;s<i;s++){(u=r.maybe_get_backing_variable(t[s]))&&(et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self),et(Set,this.partial_write_variables_to_block,u.self).add(this.current_block.self)),this.notify_variable_access(t[s],this.current_block.self)}break;case ie.OpSelect:for(s=1;s<i;s++){if(s>=3)(u=r.maybe_get_backing_variable(t[s]))&&(et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self),et(Set,this.partial_write_variables_to_block,u.self).add(this.current_block.self));this.notify_variable_access(t[s],this.current_block.self)}break;case ie.OpExtInst:for(s=4;s<i;s++)this.notify_variable_access(t[s],this.current_block.self);this.notify_variable_access(t[1],this.current_block.self);var l=t[2];if(r.get(ae,l).ext===Q.GLSL)switch(t[3]){case Ue.GLSLstd450Modf:case Ue.GLSLstd450Frexp:var u;o=t[5];(u=r.maybe_get_backing_variable(o))&&(et(Set,this.accessed_variables_to_block,u.self).add(this.current_block.self),u.self===o?et(Set,this.complete_write_variables_to_block,u.self).add(this.current_block.self):et(Set,this.partial_write_variables_to_block,u.self).add(this.current_block.self))}break;case ie.OpArrayLength:this.notify_variable_access(t[1],this.current_block.self);break;case ie.OpLine:case ie.OpNoLine:break;case ie.OpCompositeInsert:case ie.OpVectorShuffle:for(s=1;s<4;s++)this.notify_variable_access(t[s],this.current_block.self);break;case ie.OpCompositeExtract:for(s=1;s<3;s++)this.notify_variable_access(t[s],this.current_block.self);break;case ie.OpImageWrite:for(s=0;s<i;s++)3!==s&&this.notify_variable_access(t[s],this.current_block.self);break;case ie.OpImageSampleImplicitLod:case ie.OpImageSampleExplicitLod:case ie.OpImageSparseSampleImplicitLod:case ie.OpImageSparseSampleExplicitLod:case ie.OpImageSampleProjImplicitLod:case ie.OpImageSampleProjExplicitLod:case ie.OpImageSparseSampleProjImplicitLod:case ie.OpImageSparseSampleProjExplicitLod:case ie.OpImageFetch:case ie.OpImageSparseFetch:case ie.OpImageRead:case ie.OpImageSparseRead:for(s=1;s<i;s++)4!==s&&this.notify_variable_access(t[s],this.current_block.self);break;case ie.OpImageSampleDrefImplicitLod:case ie.OpImageSampleDrefExplicitLod:case ie.OpImageSparseSampleDrefImplicitLod:case ie.OpImageSparseSampleDrefExplicitLod:case ie.OpImageSampleProjDrefImplicitLod:case ie.OpImageSampleProjDrefExplicitLod:case ie.OpImageSparseSampleProjDrefImplicitLod:case ie.OpImageSparseSampleProjDrefExplicitLod:case ie.OpImageGather:case ie.OpImageSparseGather:case ie.OpImageDrefGather:case ie.OpImageSparseDrefGather:for(s=1;s<i;s++)5!==s&&this.notify_variable_access(t[s],this.current_block.self);break;default:for(s=0;s<i;s++)this.notify_variable_access(t[s],this.current_block.self)}return!0},i.prototype.handle_terminator=function(e){switch(e.terminator){case R.Return:e.return_value&&this.notify_variable_access(e.return_value,e.self);break;case R.Select:case R.MultiSelect:this.notify_variable_access(e.condition,e.self)}return!0},i}(ze),ot=function(e){function t(t,i){var r=e.call(this)||this;return r.static_expression=0,r.write_count=0,r.variable_id=i,r}return a(t,e),t.prototype.follow_function_call=function(e){return!1},t.prototype.handle=function(e,t,i){switch(e){case ie.OpStore:if(i<2)return!1;t[0]===this.variable_id&&(this.static_expression=t[1],this.write_count++);break;case ie.OpLoad:if(i<3)return!1;if(t[2]===this.variable_id&&0===this.static_expression)return!1;break;case ie.OpAccessChain:case ie.OpInBoundsAccessChain:case ie.OpPtrAccessChain:if(i<3)return!1;if(t[2]===this.variable_id)return!1}return!0},t}(ze),st=function(e){function t(t){var i=e.call(this)||this;return i.compiler=t,i}return a(t,e),t.prototype.handle=function(e,t,i){return!1},t.prototype.handle_builtin=function(e,t,i){if(t===m.BuiltInClipDistance){if(!e.array_size_literal[0])throw new Error("Array size for ClipDistance must be a literal.");if(0===(r=e.array[0]))throw new Error("Array size for ClipDistance must not be unsized.");this.compiler.clip_distance_count=r}else if(t===m.BuiltInCullDistance){if(!e.array_size_literal[0])throw new Error("Array size for CullDistance must be a literal.");var r;if(0===(r=e.array[0]))throw new Error("Array size for CullDistance must not be unsized.");this.compiler.cull_distance_count=r}else t===m.BuiltInPosition&&i.get(te.DecorationInvariant)&&(this.compiler.position_invariant=!0)},t.prototype.add_if_builtin_or_block=function(e){this.add_if_builtin(e,!0)},t.prototype.add_if_builtin=function(e,t){void 0===t&&(t=!1);var i=this.compiler,r=i.maybe_get(E,e),a=i.ir.find_meta(e);if(r&&a){var o=i.get(w,r.basetype),s=a.decoration,n=o.storage===v.StorageClassInput?i.active_input_builtins:i.active_output_builtins;if(s.builtin)n.set(s.builtin_type),this.handle_builtin(o,s.builtin_type,s.decoration_flags);else if(t&&i.has_decoration(o.self,te.DecorationBlock))for(var c=o.member_types.length,_=0;_<c;_++)if(i.has_member_decoration(o.self,_,te.DecorationBuiltIn)){var p=i.get(w,o.member_types[_]),l=i.get_member_decoration(o.self,_,te.DecorationBuiltIn);n.set(l),this.handle_builtin(p,l,i.get_member_decoration_bitset(o.self,_))}}},t}(ze),nt=function(e){function t(t){var i=e.call(this)||this;return i.dref_combined_samplers=new Set,i.compiler=t,i}return a(t,e),t.prototype.handle=function(e,t,i){switch(e){case ie.OpImageSampleDrefExplicitLod:case ie.OpImageSampleDrefImplicitLod:case ie.OpImageSampleProjDrefExplicitLod:case ie.OpImageSampleProjDrefImplicitLod:case ie.OpImageSparseSampleProjDrefImplicitLod:case ie.OpImageSparseSampleDrefImplicitLod:case ie.OpImageSparseSampleProjDrefExplicitLod:case ie.OpImageSparseSampleDrefExplicitLod:case ie.OpImageDrefGather:case ie.OpImageSparseDrefGather:return this.dref_combined_samplers.add(t[2]),!0}return!0},t}(ze),ct=function(e){function t(t,i){var r=e.call(this)||this;return r.dref_combined_samplers=new Set,r.dependency_hierarchy=[],r.comparison_ids=new Set,r.need_subpass_input=!1,r.compiler=t,r.dref_combined_samplers=i,r}return a(t,e),t.prototype.begin_function_scope=function(e,t){if(t<3)return!1;var i=this.compiler.get(j,e[2]);t-=3;for(var r=0;r<t;r++){var a=i.arguments[r];this.add_dependency(a.id,e[3+r])}return!0},t.prototype.handle=function(e,t,i){switch(e){case ie.OpImageSampleDrefExplicitLod:case ie.OpImageSampleDrefImplicitLod:case ie.OpImageSampleProjDrefExplicitLod:case ie.OpImageSampleProjDrefImplicitLod:case ie.OpImageSparseSampleProjDrefImplicitLod:case ie.OpImageSparseSampleDrefImplicitLod:case ie.OpImageSparseSampleProjDrefExplicitLod:case ie.OpImageSparseSampleDrefExplicitLod:case ie.OpImageDrefGather:case ie.OpImageSparseDrefGather:return this.dref_combined_samplers.add(t[2]),!0}return!0},t.prototype.add_hierarchy_to_comparison_ids=function(e){var t=this;this.comparison_ids.add(e),et(Set,this.dependency_hierarchy,e).forEach((function(e){return t.add_hierarchy_to_comparison_ids(e)}))},t.prototype.add_dependency=function(e,t){et(Set,this.dependency_hierarchy,e).add(t),this.comparison_ids.has(t)&&this.comparison_ids.add(e)},t}(ze),_t=function(e){function t(t,i){var r=e.call(this)||this;return r.interlock_function_id=0,r.current_block_id=0,r.split_function_case=!1,r.control_flow_interlock=!1,r.call_stack=[],r.compiler=t,r.call_stack.push(i),r}return a(t,e),t.prototype.rearm_current_block=function(e){this.current_block_id=e.self},t.prototype.begin_function_scope=function(e,t){return!(t<3)&&(this.call_stack.push(e[2]),!0)},t.prototype.end_function_scope=function(e,t){return this.call_stack.pop(),!0},t.prototype.handle=function(e,t,i){if(e===ie.OpBeginInvocationInterlockEXT||e===ie.OpEndInvocationInterlockEXT){if(0!==this.interlock_function_id&&this.interlock_function_id!==this.call_stack[this.call_stack.length-1])return this.split_function_case=!0,!1;var r=this.compiler;this.interlock_function_id=this.call_stack[this.call_stack.length-1];var a=r.get_cfg_for_function(this.interlock_function_id),o=r.get(j,this.interlock_function_id).entry_block;a.node_terminates_control_flow_in_sub_graph(o,this.current_block_id)||(this.control_flow_interlock=!0)}return!0},t}(ze),pt=function(e){function t(t,i){var r=e.call(this)||this;return r.in_crit_sec=!1,r.interlock_function_id=0,r.split_function_case=!1,r.control_flow_interlock=!1,r.use_critical_section=!1,r.call_stack_is_interlocked=!1,r.call_stack=[],r.compiler=t,r.call_stack.push(i),r}return a(t,e),t.prototype.handle=function(e,t,i){if(this.use_critical_section){if(e===ie.OpBeginInvocationInterlockEXT)return this.in_crit_sec=!0,!0;if(e===ie.OpEndInvocationInterlockEXT)return!1}var r=this.compiler;switch(e){case ie.OpLoad:if(i<3)return!1;var a=t[2];if(!(h=this.compiler.maybe_get_backing_variable(a)))break;switch(h.storage){default:break;case v.StorageClassUniformConstant:var o=t[0],s=t[1];r.set(oe,s,"",o,!0),r.register_read(s,a,!0);break;case v.StorageClassUniform:if(!r.has_decoration(r.get(w,h.basetype).self,te.DecorationBufferBlock))break;case v.StorageClassStorageBuffer:this.access_potential_resource(h.self)}break;case ie.OpInBoundsAccessChain:case ie.OpAccessChain:case ie.OpPtrAccessChain:if(i<3)return!1;o=t[0];var n=r.get(w,o);if(n.storage===v.StorageClassUniform||n.storage===v.StorageClassUniformConstant||n.storage===v.StorageClassStorageBuffer){s=t[1],a=t[2];r.set(oe,s,"",o,!0),r.register_read(s,a,!0),r.ir.ids[s].set_allow_type_rewrite()}break;case ie.OpImageTexelPointer:if(i<3)return!1;o=t[0],s=t[1],a=t[2];var c=r.set(oe,s,"",o,!0);(h=r.maybe_get_backing_variable(a))&&(c.loaded_from=h.self);break;case ie.OpStore:case ie.OpImageWrite:case ie.OpAtomicStore:if(i<1)return!1;a=t[0];!(h=r.maybe_get_backing_variable(a))||h.storage!==v.StorageClassUniform&&h.storage!==v.StorageClassUniformConstant&&h.storage!==v.StorageClassStorageBuffer||this.access_potential_resource(h.self);break;case ie.OpCopyMemory:if(i<2)return!1;var _=t[0],p=t[1],l=r.maybe_get_backing_variable(_),u=r.maybe_get_backing_variable(p);if(!l||l.storage!==v.StorageClassUniform&&l.storage!==v.StorageClassStorageBuffer||this.access_potential_resource(l.self),u){if(u.storage!==v.StorageClassUniform&&u.storage!==v.StorageClassStorageBuffer)break;if(u.storage===v.StorageClassUniform&&!r.has_decoration(r.get(w,u.basetype).self,te.DecorationBufferBlock))break;this.access_potential_resource(u.self)}break;case ie.OpImageRead:case ie.OpAtomicLoad:if(i<3)return!1;a=t[2];if(!(h=r.maybe_get_backing_variable(a)))break;switch(h.storage){default:break;case v.StorageClassUniform:if(!r.has_decoration(r.get(w,h.basetype).self,te.DecorationBufferBlock))break;case v.StorageClassUniformConstant:case v.StorageClassStorageBuffer:this.access_potential_resource(h.self)}break;case ie.OpAtomicExchange:case ie.OpAtomicCompareExchange:case ie.OpAtomicIIncrement:case ie.OpAtomicIDecrement:case ie.OpAtomicIAdd:case ie.OpAtomicISub:case ie.OpAtomicSMin:case ie.OpAtomicUMin:case ie.OpAtomicSMax:case ie.OpAtomicUMax:case ie.OpAtomicAnd:case ie.OpAtomicOr:case ie.OpAtomicXor:if(i<3)return!1;var h;a=t[2];!(h=r.maybe_get_backing_variable(a))||h.storage!==v.StorageClassUniform&&h.storage!==v.StorageClassUniformConstant&&h.storage!==v.StorageClassStorageBuffer||this.access_potential_resource(h.self)}return!0},t.prototype.begin_function_scope=function(e,t){return!(t<3)&&(e[2]===this.interlock_function_id&&(this.call_stack_is_interlocked=!0),this.call_stack.push(e[2]),!0)},t.prototype.end_function_scope=function(e,t){return this.call_stack[this.call_stack.length-1]===this.interlock_function_id&&(this.call_stack_is_interlocked=!1),this.call_stack.pop(),!0},t.prototype.access_potential_resource=function(e){(this.use_critical_section&&this.in_crit_sec||this.control_flow_interlock&&this.call_stack_is_interlocked||this.split_function_case)&&this.compiler.interlocked_resources.add(e)},t}(ze),lt=function(){this.alignment=0};!function(e){e[e.MemoryAccessMaskNone=0]="MemoryAccessMaskNone",e[e.MemoryAccessVolatileMask=1]="MemoryAccessVolatileMask",e[e.MemoryAccessAlignedMask=2]="MemoryAccessAlignedMask",e[e.MemoryAccessNontemporalMask=4]="MemoryAccessNontemporalMask",e[e.MemoryAccessMakePointerAvailableMask=8]="MemoryAccessMakePointerAvailableMask",e[e.MemoryAccessMakePointerAvailableKHRMask=8]="MemoryAccessMakePointerAvailableKHRMask",e[e.MemoryAccessMakePointerVisibleMask=16]="MemoryAccessMakePointerVisibleMask",e[e.MemoryAccessMakePointerVisibleKHRMask=16]="MemoryAccessMakePointerVisibleKHRMask",e[e.MemoryAccessNonPrivatePointerMask=32]="MemoryAccessNonPrivatePointerMask",e[e.MemoryAccessNonPrivatePointerKHRMask=32]="MemoryAccessNonPrivatePointerKHRMask"}(tt||(tt={}));var ut,ht=function(e){function t(t){var i=e.call(this)||this;return i.non_block_types=new Set,i.physical_block_type_meta=[],i.access_chain_to_physical_block=[],i.compiler=t,i}return a(t,e),t.prototype.handle=function(e,t,i){switch(e){case ie.OpConvertUToPtr:case ie.OpBitcast:case ie.OpCompositeExtract:this.setup_meta_chain(t[0],t[1]);break;case ie.OpAccessChain:case ie.OpInBoundsAccessChain:case ie.OpPtrAccessChain:case ie.OpCopyObject:var r=this.access_chain_to_physical_block[t[2]];r&&(this.access_chain_to_physical_block[t[1]]=r);break;case ie.OpLoad:this.setup_meta_chain(t[0],t[1]),i>=4&&this.mark_aligned_access(t[2],t.slice(3),i-3);break;case ie.OpStore:i>=3&&this.mark_aligned_access(t[0],t.slice(3),i-2)}return!0},t.prototype.mark_aligned_access=function(e,t,i){var r=t[0],a=0;if(--i&&0!=(r&tt.MemoryAccessVolatileMask)&&(a++,i--),i&&0!=(r&tt.MemoryAccessAlignedMask)){var o=t[a],s=this.find_block_meta(e);s&&o>s.alignment&&(s.alignment=o)}},t.prototype.find_block_meta=function(e){return this.access_chain_to_physical_block[e]||null},t.prototype.type_is_bda_block_entry=function(e){var t=this.compiler.get(w,e);return t.storage===v.StorageClassPhysicalStorageBufferEXT&&t.pointer&&1===t.pointer_depth&&!this.compiler.type_is_array_of_pointers(t)},t.prototype.setup_meta_chain=function(e,t){if(this.type_is_bda_block_entry(e)){var i=et(lt,this.physical_block_type_meta,e);this.access_chain_to_physical_block[t]=i;var r=this.compiler.get(w,e);r.basetype!==L.Struct&&this.non_block_types.add(e),0===i.alignment&&(i.alignment=this.get_minimum_scalar_alignment(this.compiler.get_pointee_type(r)))}},t.prototype.get_minimum_scalar_alignment=function(e){if(e.storage===v.StorageClassPhysicalStorageBufferEXT)return 8;if(e.basetype===L.Struct){for(var t=0,i=0,r=e.member_types;i<r.length;i++){var a=r[i],o=this.get_minimum_scalar_alignment(this.compiler.get(w,a));o>t&&(t=o)}return t}return e.width/8},t.prototype.analyze_non_block_types_from_block=function(e){for(var t=0,i=e.member_types;t<i.length;t++){var r=i[t],a=this.compiler.get(w,r);a.basetype!==L.Struct&&a.pointer&&a.storage===v.StorageClassPhysicalStorageBufferEXT?this.non_block_types.add(this.get_base_non_block_type_id(r)):a.basetype!==L.Struct||a.pointer||this.analyze_non_block_types_from_block(a)}},t.prototype.get_base_non_block_type_id=function(e){for(var t=this.compiler.get(w,e);t.pointer&&t.storage===v.StorageClassPhysicalStorageBufferEXT&&!this.type_is_bda_block_entry(e);)e=t.parent_type,t=this.compiler.get(w,e);return console.assert(this.type_is_bda_block_entry(e)),e},t}(ze);!function(e){e[e.ImageFormatUnknown=0]="ImageFormatUnknown",e[e.ImageFormatRgba32f=1]="ImageFormatRgba32f",e[e.ImageFormatRgba16f=2]="ImageFormatRgba16f",e[e.ImageFormatR32f=3]="ImageFormatR32f",e[e.ImageFormatRgba8=4]="ImageFormatRgba8",e[e.ImageFormatRgba8Snorm=5]="ImageFormatRgba8Snorm",e[e.ImageFormatRg32f=6]="ImageFormatRg32f",e[e.ImageFormatRg16f=7]="ImageFormatRg16f",e[e.ImageFormatR11fG11fB10f=8]="ImageFormatR11fG11fB10f",e[e.ImageFormatR16f=9]="ImageFormatR16f",e[e.ImageFormatRgba16=10]="ImageFormatRgba16",e[e.ImageFormatRgb10A2=11]="ImageFormatRgb10A2",e[e.ImageFormatRg16=12]="ImageFormatRg16",e[e.ImageFormatRg8=13]="ImageFormatRg8",e[e.ImageFormatR16=14]="ImageFormatR16",e[e.ImageFormatR8=15]="ImageFormatR8",e[e.ImageFormatRgba16Snorm=16]="ImageFormatRgba16Snorm",e[e.ImageFormatRg16Snorm=17]="ImageFormatRg16Snorm",e[e.ImageFormatRg8Snorm=18]="ImageFormatRg8Snorm",e[e.ImageFormatR16Snorm=19]="ImageFormatR16Snorm",e[e.ImageFormatR8Snorm=20]="ImageFormatR8Snorm",e[e.ImageFormatRgba32i=21]="ImageFormatRgba32i",e[e.ImageFormatRgba16i=22]="ImageFormatRgba16i",e[e.ImageFormatRgba8i=23]="ImageFormatRgba8i",e[e.ImageFormatR32i=24]="ImageFormatR32i",e[e.ImageFormatRg32i=25]="ImageFormatRg32i",e[e.ImageFormatRg16i=26]="ImageFormatRg16i",e[e.ImageFormatRg8i=27]="ImageFormatRg8i",e[e.ImageFormatR16i=28]="ImageFormatR16i",e[e.ImageFormatR8i=29]="ImageFormatR8i",e[e.ImageFormatRgba32ui=30]="ImageFormatRgba32ui",e[e.ImageFormatRgba16ui=31]="ImageFormatRgba16ui",e[e.ImageFormatRgba8ui=32]="ImageFormatRgba8ui",e[e.ImageFormatR32ui=33]="ImageFormatR32ui",e[e.ImageFormatRgb10a2ui=34]="ImageFormatRgb10a2ui",e[e.ImageFormatRg32ui=35]="ImageFormatRg32ui",e[e.ImageFormatRg16ui=36]="ImageFormatRg16ui",e[e.ImageFormatRg8ui=37]="ImageFormatRg8ui",e[e.ImageFormatR16ui=38]="ImageFormatR16ui",e[e.ImageFormatR8ui=39]="ImageFormatR8ui",e[e.ImageFormatR64ui=40]="ImageFormatR64ui",e[e.ImageFormatR64i=41]="ImageFormatR64i",e[e.ImageFormatMax=2147483647]="ImageFormatMax"}(ut||(ut={}));var dt=function(){function e(e){this.global_variables=[],this.aliased_variables=[],this.current_loop_level=0,this.active_interface_variables=new Set,this.check_active_interface_variables=!1,this.invalid_expressions=new Set,this.is_force_recompile=!1,this.combined_image_samplers=[],this.forced_temporaries=new Set,this.forwarded_temporaries=new Set,this.suppressed_usage_tracking=new Set,this.hoisted_temporaries=new Set,this.forced_invariant_temporaries=new Set,this.active_input_builtins=new y,this.active_output_builtins=new y,this.clip_distance_count=0,this.cull_distance_count=0,this.position_invariant=!1,this.comparison_ids=new Set,this.need_subpass_input=!1,this.physical_storage_non_block_pointer_types=[],this.physical_storage_type_to_alignment=[],this.interlocked_resources=new Set,this.interlocked_is_complex=!1,this.declared_block_names=[],this.set_ir(e)}return e.prototype.get_name=function(e){return this.ir.get_name(e)},e.prototype.set_decoration=function(e,t,i){void 0===i&&(i=0),this.ir.set_decoration(e,t,i)},e.prototype.set_decoration_string=function(e,t,i){this.ir.set_decoration_string(e,t,i)},e.prototype.set_name=function(e,t){this.ir.set_name(e,t)},e.prototype.get_decoration_bitset=function(e){return this.ir.get_decoration_bitset(e)},e.prototype.get_declared_struct_member_size=function(e,t){if(0===e.member_types.length)throw new Error("Declared struct in block cannot be empty.");var i=this.get_member_decoration_bitset(e.self,t),r=this.get(w,e.member_types[t]);switch(r.basetype){case L.Unknown:case L.Void:case L.Boolean:case L.AtomicCounter:case L.Image:case L.SampledImage:case L.Sampler:throw new Error("Querying size for object with opaque size.")}if(r.pointer&&r.storage===v.StorageClassPhysicalStorageBuffer&&r.pointer_depth>this.get(w,r.parent_type).pointer_depth)return 8;if(r.array.length>0){var a=r.array_size_literal[r.array_size_literal.length-1]?r.array[r.array.length-1]:this.evaluate_constant_u32(r.array[r.array.length-1]);return this.type_struct_member_array_stride(e,t)*a}if(r.basetype===L.Struct)return this.get_declared_struct_size(r);var o=r.vecsize,s=r.columns;if(1===s)return o*(r.width/8);var n=this.type_struct_member_matrix_stride(e,t);if(i.get(te.DecorationRowMajor))return n*o;if(i.get(te.DecorationColMajor))return n*s;throw new Error("Either row-major or column-major must be declared for matrices.")},e.prototype.get_active_interface_variables=function(){var e=this,t=this.ir,i=new Set,r=new Ke(this,i);return this.traverse_all_reachable_opcodes(this.get(j,t.default_entry_point),r),t.for_each_typed_id(E,(function(t,r){r.storage===v.StorageClassOutput&&e.interface_variable_exists_in_entry_point(r.self)&&(0===r.initializer&&e.get_execution_model()===Se.ExecutionModelFragment||i.add(r.self))})),this.dummy_sampler_id&&i.add(this.dummy_sampler_id),i},e.prototype.set_enabled_interface_variables=function(e){this.active_interface_variables=e,this.check_active_interface_variables=!0},e.prototype.get_shader_resources=function(e){var t=this,i=new Qe,r=this.ir,a=this.reflection_ssbo_instance_name_is_significant();return r.for_each_typed_id(E,(function(o,s){var n=t.get(w,s.basetype);if(s.storage!==v.StorageClassFunction&&n.pointer&&(!e||e.has(s.self))){var c=!0;if(r.get_spirv_version()<66560&&s.storage!==v.StorageClassInput&&s.storage!==v.StorageClassOutput||(c=t.interface_variable_exists_in_entry_point(s.self)),c)if(t.is_builtin_variable(s)){if(s.storage!==v.StorageClassInput&&s.storage!==v.StorageClassOutput)return;var _=s.storage===v.StorageClassInput?i.builtin_inputs:i.builtin_outputs,p=new We;if(t.has_decoration(n.self,te.DecorationBlock)){p.resource=new je(s.self,s.basetype,n.self,t.get_remapped_declared_block_name(s.self,!1));for(var l=0;l<n.member_types.length;l++)p.value_type_id=n.member_types[l],p.builtin=t.get_member_decoration(n.self,l,te.DecorationBuiltIn),_.push(p)}else{var u=!t.has_decoration(s.self,te.DecorationPatch)&&(t.get_execution_model()===Se.ExecutionModelTessellationControl||t.get_execution_model()===Se.ExecutionModelTessellationEvaluation&&s.storage===v.StorageClassInput);p.resource=new je(s.self,s.basetype,n.self,t.get_name(s.self)),u&&n.array.length>0?p.value_type_id=t.get_variable_data_type(s).parent_type:p.value_type_id=t.get_variable_data_type_id(s),console.assert(p.value_type_id),p.builtin=t.get_decoration(s.self,te.DecorationBuiltIn),_.push(p)}}else s.storage===v.StorageClassInput?t.has_decoration(n.self,te.DecorationBlock)?i.stage_inputs.push(new je(s.self,s.basetype,n.self,t.get_remapped_declared_block_name(s.self,!1))):i.stage_inputs.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):s.storage===v.StorageClassUniformConstant&&n.image.dim===Ge.DimSubpassData?i.subpass_inputs.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):s.storage===v.StorageClassOutput?t.has_decoration(n.self,te.DecorationBlock)?i.stage_outputs.push(new je(s.self,s.basetype,n.self,t.get_remapped_declared_block_name(s.self,!1))):i.stage_outputs.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):n.storage===v.StorageClassUniform&&t.has_decoration(n.self,te.DecorationBlock)?i.uniform_buffers.push(new je(s.self,s.basetype,n.self,t.get_remapped_declared_block_name(s.self,!1))):n.storage===v.StorageClassUniform&&t.has_decoration(n.self,te.DecorationBufferBlock)||n.storage===v.StorageClassStorageBuffer?i.storage_buffers.push(new je(s.self,s.basetype,n.self,t.get_remapped_declared_block_name(s.self,a))):n.storage===v.StorageClassPushConstant?i.push_constant_buffers.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):n.storage===v.StorageClassUniformConstant&&n.basetype===L.Image&&2===n.image.sampled?i.storage_images.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):n.storage===v.StorageClassUniformConstant&&n.basetype===L.Image&&1===n.image.sampled?i.separate_images.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):n.storage===v.StorageClassUniformConstant&&n.basetype===L.Sampler?i.separate_samplers.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):n.storage===v.StorageClassUniformConstant&&n.basetype===L.SampledImage?i.sampled_images.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):n.storage===v.StorageClassAtomicCounter?i.atomic_counters.push(new je(s.self,s.basetype,n.self,t.get_name(s.self))):n.storage===v.StorageClassUniformConstant&&n.basetype===L.AccelerationStructure&&i.acceleration_structures.push(new je(s.self,s.basetype,n.self,t.get_name(s.self)))}})),i},e.prototype.get_common_basic_type=function(e){if(e.basetype===L.Struct){for(var t=L.Unknown,i=0,r=e.member_types;i<r.length;i++){var a=r[i],o=this.get_common_basic_type(this.get(w,a));if(void 0===o)return;if(t===L.Unknown)t=o;else if(t!==o)return}return t}return e.basetype},e.prototype.set_remapped_variable_state=function(e,t){this.get(E,e).remapped_variable=t},e.prototype.get_remapped_variable_state=function(e){return this.get(E,e).remapped_variable},e.prototype.set_subpass_input_remapped_components=function(e,t){this.get(E,e).remapped_components=t},e.prototype.get_subpass_input_remapped_components=function(e){return this.get(E,e).remapped_components},e.prototype.get_entry_points_and_stages=function(){var e=[];return this.ir.entry_points.forEach((function(t){return e.push(new Fe(t.orig_name,t.model))})),e},e.prototype.set_entry_point=function(e,t){var i=this.get_entry_point(e,t);this.ir.default_entry_point=i.self},e.prototype.rename_entry_point=function(e,t,i){var r=this.get_entry_point(e,i);r.orig_name=t,r.name=t},e.prototype.get_entry_point=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.ir;if(0===e.length)return i.entry_points[i.default_entry_point];var r=i.entry_points.find((function(t){return t.orig_name===e[0]&&t.model===e[1]}));if(!r)throw new Error("Entry point does not exist.");return r},e.prototype.update_active_builtins=function(){var e=this,t=this.ir;this.active_input_builtins.reset(),this.active_output_builtins.reset(),this.cull_distance_count=0,this.clip_distance_count=0;var i=new st(this);this.traverse_all_reachable_opcodes(this.get(j,t.default_entry_point),i),t.for_each_typed_id(E,(function(t,r){r.storage===v.StorageClassOutput&&e.interface_variable_exists_in_entry_point(r.self)&&0!==r.initializer&&i.add_if_builtin_or_block(r.self)}))},e.prototype.has_active_builtin=function(e,t){var i;switch(t){case v.StorageClassInput:i=this.active_input_builtins;break;case v.StorageClassOutput:i=this.active_output_builtins;break;default:return!1}return i.get(e)},e.prototype.get_execution_model=function(){return this.get_entry_point().model},e.prototype.get_work_group_size_specialization_constants=function(e,t,i){var r=this.get_entry_point();if(e.constant_id=t.constant_id=i.constant_id=0,e.id=t.id=i.id=0,0!==r.workgroup_size.constant){var a=this.get(U,r.workgroup_size.constant);0!==a.m.c[0].id[0]&&(e.id=a.m.c[0].id[0],e.constant_id=this.get_decoration(a.m.c[0].id[0],te.DecorationSpecId)),0!==a.m.c[0].id[1]&&(t.id=a.m.c[0].id[1],t.constant_id=this.get_decoration(a.m.c[0].id[1],te.DecorationSpecId)),0!==a.m.c[0].id[2]&&(i.id=a.m.c[0].id[2],i.constant_id=this.get_decoration(a.m.c[0].id[2],te.DecorationSpecId))}else if(r.flags.get(Ee.ExecutionModeLocalSizeId)){this.get(U,r.workgroup_size.id_x).specialization&&(e.id=r.workgroup_size.id_x,e.constant_id=this.get_decoration(r.workgroup_size.id_x,te.DecorationSpecId)),this.get(U,r.workgroup_size.id_y).specialization&&(t.id=r.workgroup_size.id_y,t.constant_id=this.get_decoration(r.workgroup_size.id_y,te.DecorationSpecId)),this.get(U,r.workgroup_size.id_z).specialization&&(i.id=r.workgroup_size.id_z,i.constant_id=this.get_decoration(r.workgroup_size.id_z,te.DecorationSpecId))}return r.workgroup_size.constant},e.prototype.build_dummy_sampler_for_combined_images=function(){var e=new He(this);this.traverse_all_reachable_opcodes(this.get(j,this.ir.default_entry_point),e);var t=this.ir;if(e.need_dummy_sampler){var i=t.increase_bound_by(3),r=i,a=i+1,o=i+2,s=this.set(w,r);s.basetype=L.Sampler;var n=this.set(w,a);return h(s,n),n.self=r,n.storage=v.StorageClassUniformConstant,n.pointer=!0,n.parent_type=r,this.set(E,o,a,v.StorageClassUniformConstant,0),this.set_name(o,"SPIRV_Cross_DummySampler"),this.dummy_sampler_id=o,o}return 0},e.prototype.build_combined_image_samplers=function(){this.ir.for_each_typed_id(j,(function(e,t){t.combined_parameters=[],t.shadow_arguments=[],t.do_combined_parameters=!0})),this.combined_image_samplers=[];var e=new Ze(this);this.traverse_all_reachable_opcodes(this.get(j,this.ir.default_entry_point),e)},e.prototype.get_combined_image_samplers=function(){return this.combined_image_samplers},e.prototype.set_variable_type_remap_callback=function(e){this.variable_remap_callback=e},e.prototype.get_current_id_bound=function(){return this.ir.ids.length},e.prototype.stream=function(e){if(!e.length)return null;if(e.is_embedded()){var t=e;return console.assert(t.ops.length===e.length),new Uint32Array(t.ops)}if(e.offset+e.length>this.ir.spirv.length)throw new Error("Compiler::stream() out of range.");return this.ir.spirv.slice(e.offset,e.offset+e.length)},e.prototype.execution_is_branchless=function(e,t){for(var i=e;;){if(i.self===t.self)return!0;if(i.terminator!==R.Direct||i.merge!==M.MergeNone)return!1;i=this.get(J,i.next_block)}},e.prototype.execution_is_direct_branch=function(e,t){return e.terminator===R.Direct&&e.merge===M.MergeNone&&e.next_block===t.self},e.prototype.is_break=function(e){return this.ir.block_meta[e]=this.ir.block_meta[e]||0,0!=(this.ir.block_meta[e]&(re.BLOCK_META_LOOP_MERGE_BIT|re.BLOCK_META_MULTISELECT_MERGE_BIT))},e.prototype.is_loop_break=function(e){return this.ir.block_meta[e]=this.ir.block_meta[e]||0,0!=(this.ir.block_meta[e]&re.BLOCK_META_LOOP_MERGE_BIT)},e.prototype.is_conditional=function(e){return this.ir.block_meta[e]=this.ir.block_meta[e]||0,0!=(this.ir.block_meta[e]&(re.BLOCK_META_SELECTION_MERGE_BIT|re.BLOCK_META_MULTISELECT_MERGE_BIT))},e.prototype.flush_dependees=function(e){for(var t=0,i=e.dependees;t<i.length;t++){var r=i[t];this.invalid_expressions.add(r)}e.dependees=[]},e.prototype.flush_all_active_variables=function(){for(var e=0,t=this.current_function.local_variables;e<t.length;e++){var i=t[e];this.flush_dependees(this.get(E,i))}for(var r=0,a=this.current_function.arguments;r<a.length;r++){var o=a[r];this.flush_dependees(this.get(E,o.id))}for(var s=0,n=this.global_variables;s<n.length;s++){var c=n[s];this.flush_dependees(this.get(E,c))}this.flush_all_aliased_variables()},e.prototype.flush_all_aliased_variables=function(){for(var e=0,t=this.aliased_variables;e<t.length;e++){var i=t[e];this.flush_dependees(this.get(E,i))}},e.prototype.flush_control_dependent_expressions=function(e){for(var t=this.get(J,e),i=0,r=t.invalidate_expressions;i<r.length;i++){var a=r[i];this.invalid_expressions.add(a)}t.invalidate_expressions=[]},e.prototype.register_global_read_dependencies=function(e,t){if(e instanceof j)for(var i=0,r=e.blocks;i<r.length;i++){var a=r[i];this.register_global_read_dependencies(this.get(J,a),t)}else for(var o=0,s=e.ops;o<s.length;o++){var n=s[o],c=this.stream(n);switch(n.op){case ie.OpFunctionCall:var _=c[2];this.register_global_read_dependencies(this.get(j,_),t);break;case ie.OpLoad:case ie.OpImageRead:var p=this.maybe_get_backing_variable(c[2]);if(p&&p.storage!==v.StorageClassFunction){var l=this.get(w,p.basetype);l.basetype!==L.Image&&l.image.dim!==Ge.DimSubpassData&&p.dependees.push(t)}}}},e.prototype.update_name_cache=function(e,t,i){if(!i)return i=t,t=e,this.update_name_cache(e,t,i);if(""===i)return i;var r=function(i){return!!e.has(i)||!(e===t||!t.has(i))},a=function(t){e.add(t)};if(!r(i))return a(i),i;var o=0,s=i,n=!0;"_"===s?s+="0":"_"===s.charAt(s.length-1)&&(n=!1);do{i=s+(n?"_":"")+le(++o)}while(r(i));return a(i),i},e.prototype.function_is_pure=function(e){for(var t=0,i=e.blocks;t<i.length;t++){var r=i[t];if(!this.block_is_pure(this.get(J,r)))return!1}return!0},e.prototype.block_is_pure=function(e){if(e.terminator===R.Kill||e.terminator===R.TerminateRay||e.terminator===R.IgnoreIntersection)return!1;for(var t=0,i=e.ops;t<i.length;t++){var r=i[t],a=this.stream(r);switch(r.op){case ie.OpFunctionCall:var o=a[2];if(!this.function_is_pure(this.get(j,o)))return!1;break;case ie.OpCopyMemory:case ie.OpStore:if(this.expression_type(a[0]).storage!==v.StorageClassFunction)return!1;break;case ie.OpImageWrite:case ie.OpControlBarrier:case ie.OpMemoryBarrier:case ie.OpDemoteToHelperInvocationEXT:return!1;case ie.OpExtInst:var s=a[2];if(this.get(ae,s).ext===Q.GLSL)switch(a[3]){case Ue.GLSLstd450Modf:case Ue.GLSLstd450Frexp:if(this.expression_type(a[5]).storage!==v.StorageClassFunction)return!1}}}return!0},e.prototype.execution_is_noop=function(e,t){if(!this.execution_is_branchless(e,t))return!1;for(var i=e;;){if(i.self===t.self)return!0;if(i.ops.length>0)return!1;for(var r=this.get(J,i.next_block),a=0,o=r.phi_variables;a<o.length;a++){if(o[a].parent===i.self)return!1}i=r}},e.prototype.continue_block_type=function(e){if(e.complex_continue)return N.ComplexLoop;if(e.merge===M.MergeLoop)return N.WhileLoop;if(e.loop_dominator===J.NoDominator)return N.ComplexLoop;var t=this.get(J,e.loop_dominator);if(this.execution_is_noop(e,t))return N.WhileLoop;if(this.execution_is_branchless(e,t))return N.ForLoop;var i=this.maybe_get(J,e.false_block),r=this.maybe_get(J,e.true_block),a=this.maybe_get(J,t.merge_block),o=i&&this.flush_phi_required(e.self,e.false_block),s=r&&this.flush_phi_required(e.self,e.true_block);if(o||s)return N.ComplexLoop;var n=e.true_block===t.self&&(e.false_block===t.merge_block||i&&a&&this.execution_is_noop(i,a)),c=e.false_block===t.self&&(e.true_block===t.merge_block||r&&a&&this.execution_is_noop(r,a));return e.merge===M.MergeNone&&e.terminator===R.Select&&(n||c)?N.DoWhileLoop:N.ComplexLoop},e.prototype.force_recompile=function(){this.is_force_recompile=!0},e.prototype.is_forcing_recompilation=function(){return this.is_force_recompile},e.prototype.block_is_loop_candidate=function(e,t){if(e.disable_block_optimization||e.complex_continue)return!1;if(t===A.MergeToSelectForLoop||t===A.MergeToSelectContinueForLoop){var i=this.maybe_get(J,e.false_block),r=this.maybe_get(J,e.true_block),a=this.maybe_get(J,e.merge_block),o=e.false_block===e.merge_block||i&&a&&this.execution_is_noop(i,a),s=e.true_block===e.merge_block||r&&a&&this.execution_is_noop(r,a),n=e.true_block!==e.merge_block&&e.true_block!==e.self&&o,c=e.false_block!==e.merge_block&&e.false_block!==e.self&&s;if((h=e.terminator===R.Select&&e.merge===M.MergeLoop&&(n||c))&&n&&t===A.MergeToSelectContinueForLoop?h=e.true_block===e.continue_block:h&&c&&t===A.MergeToSelectContinueForLoop&&(h=e.false_block===e.continue_block),h){for(var _=0,p=e.phi_variables;_<p.length;_++){if((I=p[_]).parent===e.self)return!1}if(y=this.maybe_get(J,e.merge_block))for(var l=0,u=y.phi_variables;l<u.length;l++){if((I=u[l]).parent===e.self)return!1}}return h}if(t===A.MergeToDirectForLoop){var h;if(!(h=e.terminator===R.Direct&&e.merge===M.MergeLoop&&0===e.ops.length))return!1;var d=this.get(J,e.next_block);i=this.maybe_get(J,d.false_block),r=this.maybe_get(J,d.true_block),a=this.maybe_get(J,e.merge_block),o=d.false_block===e.merge_block||i&&a&&this.execution_is_noop(i,a),s=d.true_block===e.merge_block||r&&a&&this.execution_is_noop(r,a),n=d.true_block!==e.merge_block&&d.true_block!==e.self&&o,c=d.false_block!==e.merge_block&&d.false_block!==e.self&&s;if(h=d.terminator===R.Select&&d.merge===M.MergeNone&&(n||c)){for(var f=0,m=e.phi_variables;f<m.length;f++){if((I=m[f]).parent===e.self||I.parent===d.self)return!1}for(var g=0,b=d.phi_variables;g<b.length;g++){if((I=b[g]).parent===e.self)return!1}var y;if(y=this.maybe_get(J,e.merge_block))for(var v=0,S=y.phi_variables;v<S.length;v++){var I;if((I=S[v]).parent===e.self||I.parent===d.false_block)return!1}}return h}return!1},e.prototype.inherit_expression_dependencies=function(e,t){if(this.forwarded_temporaries.has(e)&&!this.forced_temporaries.has(e)){var i=this.get(oe,e),r=this.maybe_get(E,t);(null==r?void 0:r.phi_variable)&&r.dependees.push(e);var a=this.maybe_get(oe,t);if(a){var o,s,n,c,_=i.expression_dependencies,p=a.expression_dependencies;_.push(t),_.push.apply(_,p),i.expression_dependencies=(o=_,void 0===s&&(s=!1),s&&(o=o.concat()),c=n?function(e,t){return!t||n(o[t],o[t-1])}:function(e,t){return!t||e!==o[t-1]},o.sort(n).filter(c))}}},e.prototype.add_implied_read_expression=function(e,t){e.implied_read_expressions.indexOf(t)<0&&e.implied_read_expressions.push(t)},e.prototype.clear_force_recompile=function(){this.is_force_recompile=!1},e.prototype.interface_variable_exists_in_entry_point=function(e){var t=this.get(E,e),i=this.ir;if(i.get_spirv_version()<66560){if(t.storage!==v.StorageClassInput&&t.storage!==v.StorageClassOutput&&t.storage!==v.StorageClassUniformConstant)throw new Error("Only Input, Output variables and Uniform constants are part of a shader linking interface.");if(c(i.entry_points)<=1)return!0}return this.get_entry_point().interface_variables.indexOf(e)>=0},e.prototype.remap_variable_type_name=function(e,t,i){return this.variable_remap_callback?this.variable_remap_callback(e,t,i):i},e.prototype.set_ir=function(e){this.ir=e,this.parse_fixup()},e.prototype.parse_fixup=function(){for(var e=this.ir,i=0,r=e.ids_for_constant_or_variable;i<r.length;i++){var a=r[i],o=e.ids[a];if(o.get_type()===t.TypeConstant){var s=o.get(U);if(e.get_meta(s.self).decoration.builtin&&e.get_meta(s.self).decoration.builtin_type===m.BuiltInWorkgroupSize)for(var n=0,c=e.entry_points;n<c.length;n++){var _=c[n];_.workgroup_size.constant=s.self,_.workgroup_size.x=s.scalar(0,0),_.workgroup_size.y=s.scalar(0,1),_.workgroup_size.z=s.scalar(0,2)}}else if(o.get_type()===t.TypeVariable){var p=o.get(E);p.storage!==v.StorageClassPrivate&&p.storage!==v.StorageClassWorkgroup&&p.storage!==v.StorageClassOutput||this.global_variables.push(p.self),this.variable_storage_is_aliased(p)&&this.aliased_variables.push(p.self)}}},e.prototype.variable_storage_is_aliased=function(e){var t=this.get(w,e.basetype),i=e.storage===v.StorageClassStorageBuffer||this.ir.get_meta(t.self).decoration.decoration_flags.get(te.DecorationBufferBlock),r=t.basetype===L.Image,a=t.basetype===L.AtomicCounter,o=t.storage===v.StorageClassPhysicalStorageBufferEXT;return!(i?this.ir.get_buffer_block_flags(e).get(te.DecorationRestrict):this.has_decoration(e.self,te.DecorationRestrict))&&(i||r||a||o)},e.prototype.add_loop_level=function(){this.current_loop_level++},e.prototype.set_initializers=function(e){e instanceof oe&&(e.emitted_loop_level=this.current_loop_level)},e.prototype.set=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];this.ir.add_typed_id(e.type,t);var a=l.apply(void 0,o([e,this.ir.ids[t]],i,!1));return a.self=t,this.set_initializers(a),a},e.prototype.get=function(e,t){return p(e,this.ir.ids[t])},e.prototype.has_decoration=function(e,t){return this.ir.has_decoration(e,t)},e.prototype.get_decoration=function(e,t){return this.ir.get_decoration(e,t)},e.prototype.get_decoration_string=function(e,t){return this.ir.get_decoration_string(e,t)},e.prototype.unset_decoration=function(e,t){this.ir.unset_decoration(e,t)},e.prototype.get_type=function(e){return this.get(w,e)},e.prototype.get_fallback_name=function(e){return"_"+e},e.prototype.get_block_fallback_name=function(e){var t=this.get(E,e);return""===this.get_name(e)?"_"+this.get(w,t.basetype).self+"_"+e:this.get_name(e)},e.prototype.get_member_name=function(e,t){return this.ir.get_member_name(e,t)},e.prototype.get_member_decoration=function(e,t,i){return this.ir.get_member_decoration(e,t,i)},e.prototype.get_member_decoration_string=function(e,t,i){return this.ir.get_member_decoration_string(e,t,i)},e.prototype.set_member_name=function(e,t,i){this.ir.set_member_name(e,t,i)},e.prototype.get_member_qualified_name=function(e,t){var i=this.ir.find_meta(e);return i&&t<i.members.length?i.members[t].qualified_alias:this.ir.get_empty_string()},e.prototype.get_member_decoration_bitset=function(e,t){return this.ir.get_member_decoration_bitset(e,t)},e.prototype.has_member_decoration=function(e,t,i){return this.ir.has_member_decoration(e,t,i)},e.prototype.set_member_decoration=function(e,t,i,r){void 0===r&&(r=0),this.ir.set_member_decoration(e,t,i,r)},e.prototype.set_member_decoration_string=function(e,t,i,r){this.ir.set_member_decoration_string(e,t,i,r)},e.prototype.unset_member_decoration=function(e,t,i){this.ir.unset_member_decoration(e,t,i)},e.prototype.get_fallback_member_name=function(e){return"_"+e},e.prototype.get_declared_struct_size=function(e){if(0===e.member_types.length)throw new Error("Declared struct in block cannot be empty.");for(var t=0,i=0,r=0;r<e.member_types.length;r++){var a=this.type_struct_member_offset(e,r);a>i&&(i=a,t=r)}return i+this.get_declared_struct_member_size(e,t)},e.prototype.maybe_get=function(e,t){var i=this.ir;return t>=i.ids.length?null:i.ids[t].get_type()===e.type?this.get(e,t):null},e.prototype.get_pointee_type_id=function(e){var t=this.get(w,e);return t.pointer&&(console.assert(t.parent_type),e=t.parent_type),e},e.prototype.get_pointee_type=function(e){if("number"==typeof e)return this.get_pointee_type(this.get(w,e));var t=e;return t.pointer&&(console.assert(t.parent_type),t=this.get(w,t.parent_type)),t},e.prototype.get_variable_data_type_id=function(e){return e.phi_variable?e.basetype:this.get_pointee_type_id(e.basetype)},e.prototype.get_variable_data_type=function(e){return this.get(w,this.get_variable_data_type_id(e))},e.prototype.is_immutable=function(e){var i=this.ir;if(i.ids[e].get_type()===t.TypeVariable){var r=this.get(E,e);return r.storage===v.StorageClassUniformConstant||r.phi_variable||!this.expression_is_lvalue(e)}return i.ids[e].get_type()===t.TypeAccessChain?this.get(ne,e).immutable:i.ids[e].get_type()===t.TypeExpression?this.get(oe,e).immutable:i.ids[e].get_type()===t.TypeConstant||i.ids[e].get_type()===t.TypeConstantOp||i.ids[e].get_type()===t.TypeUndef},e.prototype.maybe_get_backing_variable=function(e){var t=this.maybe_get(E,e);if(!t){var i=this.maybe_get(oe,e);i&&(t=this.maybe_get(E,i.loaded_from));var r=this.maybe_get(ne,e);r&&(t=this.maybe_get(E,r.loaded_from))}return t},e.prototype.to_name=function(e,i){void 0===i&&(i=!0);var r=this.ir;if(i&&r.ids[e].get_type()===t.TypeType){var a=this.get(w,e);if(a.type_alias&&!this.has_extended_decoration(a.type_alias,b.SPIRVCrossDecorationBufferBlockRepacked))return this.to_name(a.type_alias)}var o=r.get_name(e);return o&&""!==o?o:"_"+e},e.prototype.is_builtin_variable=function(e){var t=this.ir.find_meta(e.self);return!!(e.compat_builtin||t&&t.decoration.builtin)||this.is_builtin_type(this.get(w,e.basetype))},e.prototype.is_builtin_type=function(e){var t=this.ir.find_meta(e.self);if(t)for(var i=0,r=t.members;i<r.length;i++){if(r[i].builtin)return!0}return!1},e.prototype.is_hidden_variable=function(e,t){return void 0===t&&(t=!1),!!(this.is_builtin_variable(e)&&!t||e.remapped_variable)||!this.combined_image_samplers.find((function(t){return t.combined_id===e.self}))&&(this.ir.get_spirv_version()>=66560&&e.storage!==v.StorageClassGeneric&&e.storage!==v.StorageClassFunction&&!this.interface_variable_exists_in_entry_point(e.self)||this.check_active_interface_variables&&function(e){switch(e){case v.StorageClassInput:case v.StorageClassOutput:case v.StorageClassUniform:case v.StorageClassUniformConstant:case v.StorageClassAtomicCounter:case v.StorageClassPushConstant:case v.StorageClassStorageBuffer:return!0;default:return!1}}(e.storage)&&!this.active_interface_variables.has(e.self))},e.prototype.is_member_builtin=function(e,t){var i=this.ir.find_meta(e.self);if(i){var r=i.members;if(t<r.length&&r[t].builtin)return r[t].builtin_type}},e.prototype.is_scalar=function(e){return e.basetype!==L.Struct&&1===e.vecsize&&1===e.columns},e.prototype.is_vector=function(e){return e.vecsize>1&&1===e.columns},e.prototype.is_matrix=function(e){return e.vecsize>1&&e.columns>1},e.prototype.is_array=function(e){return e.array.length>0},e.prototype.expression_type_id=function(e){switch(this.ir.ids[e].get_type()){case t.TypeVariable:return this.get(E,e).basetype;case t.TypeExpression:return this.get(oe,e).expression_type;case t.TypeConstant:return this.get(U,e).constant_type;case t.TypeConstantOp:return this.get(V,e).basetype;case t.TypeUndef:return this.get(ce,e).basetype;case t.TypeCombinedImageSampler:return this.get(se,e).combined_type;case t.TypeAccessChain:return this.get(ne,e).basetype;default:throw new Error("Cannot resolve expression type.")}},e.prototype.expression_type=function(e){return this.get(w,this.expression_type_id(e))},e.prototype.expression_is_lvalue=function(e){switch(this.expression_type(e).basetype){case L.SampledImage:case L.Image:case L.Sampler:return!1;default:return!0}},e.prototype.register_read=function(e,t,i){var r=this.get(oe,e),a=this.maybe_get_backing_variable(t);a&&(r.loaded_from=a.self,i&&!this.is_immutable(a.self)&&a.dependees.push(r.self),a&&a.parameter&&a.parameter.read_count++)},e.prototype.register_write=function(e){var t=this.maybe_get(E,e);if(!t){var i=this.maybe_get(oe,e);i&&i.loaded_from&&(t=this.maybe_get(E,i.loaded_from));var r=this.maybe_get(ne,e);r&&r.loaded_from&&(t=this.maybe_get(E,r.loaded_from))}var a=this.expression_type(e);if(t){var o=!0,s=this.expression_type(e);this.get_variable_data_type(t).pointer&&(this.flush_all_active_variables(),1===s.pointer_depth&&(o=!1)),s.storage===v.StorageClassPhysicalStorageBufferEXT||this.variable_storage_is_aliased(t)?this.flush_all_aliased_variables():t&&this.flush_dependees(t),o&&t.parameter&&0===t.parameter.write_count&&(t.parameter.write_count++,this.force_recompile())}else a.pointer&&this.flush_all_active_variables()},e.prototype.is_continue=function(e){return this.ir.block_meta[e]=this.ir.block_meta[e]||0,0!=(this.ir.block_meta[e]&re.BLOCK_META_CONTINUE_BIT)},e.prototype.is_single_block_loop=function(e){var t=this.get(J,e);return t.merge===M.MergeLoop&&t.continue_block===e},e.prototype.traverse_all_reachable_opcodes=function(e,t){if(e instanceof j){for(var i=0,r=e.blocks;i<r.length;i++){var a=r[i];if(!this.traverse_all_reachable_opcodes(this.get(J,a),t))return!1}return!0}var o=e;t.set_current_block(o),t.rearm_current_block(o);for(var s=0,n=o.ops;s<n.length;s++){var c=n[s],_=this.stream(c),p=c.op;if(!t.handle(p,_,c.length))return!1;if(p===ie.OpFunctionCall){var l=this.get(j,_[2]);if(t.follow_function_call(l)){if(!t.begin_function_scope(_,c.length))return!1;if(!this.traverse_all_reachable_opcodes(this.get(j,_[2]),t))return!1;if(!t.end_function_scope(_,c.length))return!1;t.rearm_current_block(o)}}}return!!t.handle_terminator(o)},e.prototype.analyze_image_and_sampler_usage=function(){var e=this.ir,t=new nt(this);this.traverse_all_reachable_opcodes(this.get(j,e.default_entry_point),t);var i=new ct(this,t.dref_combined_samplers);this.traverse_all_reachable_opcodes(this.get(j,e.default_entry_point),i),i.dependency_hierarchy=[],this.traverse_all_reachable_opcodes(this.get(j,e.default_entry_point),i),this.comparison_ids=i.comparison_ids,this.need_subpass_input=i.need_subpass_input;for(var r=0,a=this.combined_image_samplers;r<a.length;r++){var o=a[r];this.comparison_ids.has(o.sampler_id)&&this.comparison_ids.add(o.combined_id)}},e.prototype.build_function_control_flow_graphs_and_analyze=function(){var e=this,t=this.ir,i=new rt(this);i.function_cfgs[t.default_entry_point]=new it(this,this.get(j,t.default_entry_point)),this.traverse_all_reachable_opcodes(this.get(j,t.default_entry_point),i),this.function_cfgs=i.function_cfgs;var r=c(this.function_cfgs)<=1;this.function_cfgs.forEach((function(t,i){var a=e.get(j,i),o=new at(e,a);e.analyze_variable_scope(a,o),e.find_function_local_luts(a,o,r);for(var s=0,n=a.blocks;s<n.length;s++){var c=n[s],_=e.get(J,c);if(!(_.loop_variables.length<2)){for(var p=e.get_decoration_bitset(_.loop_variables[0]),l=e.get(E,_.loop_variables[0]).basetype,u=!1,h=0,d=_.loop_variables;h<d.length;h++){var f=d[h];if(p!==e.get_decoration_bitset(f)||l!==e.get(E,_.loop_variables[0]).basetype){u=!0;break}}if(u){for(var m=0,g=_.loop_variables;m<g.length;m++){f=g[m];e.get(E,f).loop_variable=!1}_.loop_variables=[]}}}}))},e.prototype.get_cfg_for_current_function=function(){return console.assert(this.current_function),this.get_cfg_for_function(this.current_function.self)},e.prototype.get_cfg_for_function=function(e){var t=this.function_cfgs[e];return console.assert(t),t},e.prototype.analyze_parameter_preservation=function(e,t,i,r){for(var a=0,o=e.arguments;a<o.length;a++){var s=o[a],n=this.get(w,s.type);if(n.pointer){var c=void 0;switch(n.basetype){case L.Sampler:case L.Image:case L.SampledImage:case L.AtomicCounter:c=!1;break;default:c=!0}if(c&&i.hasOwnProperty(s.id))if(r.hasOwnProperty(s.id)){var _=r[s.id],p=new Set;ft(t,e.entry_block,_,p)&&s.read_count++}else s.read_count++}}},e.prototype.analyze_non_block_pointer_types=function(){var e=this,t=this.ir,i=new ht(this);this.traverse_all_reachable_opcodes(this.get(j,t.default_entry_point),i),t.for_each_typed_id(w,(function(t,r){(e.has_decoration(r.self,te.DecorationBlock)||e.has_decoration(r.self,te.DecorationBufferBlock))&&i.analyze_non_block_types_from_block(r)})),i.non_block_types.forEach((function(t){return e.physical_storage_non_block_pointer_types.push(t)})),this.physical_storage_non_block_pointer_types.sort(),this.physical_storage_type_to_alignment=i.physical_block_type_meta},e.prototype.analyze_variable_scope=function(e,t){var i=this;this.traverse_all_reachable_opcodes(e,t);var r=this.ir,a=et(it,this.function_cfgs,e.self);this.analyze_parameter_preservation(e,a,t.accessed_variables_to_block,t.complete_write_variables_to_block);for(var o=[],s=0,n=e.blocks;s<n.length;s++){var c=n[s],_=this.get(J,c),p=r.continue_block_to_loop_header[c];if(p&&p!==c)_.loop_dominator=p;else{var l=a.find_loop_dominator(c);_.loop_dominator=l!==c?l:J.NoDominator}}t.accessed_variables_to_block.forEach((function(t,s){if(!(e.local_variables.indexOf(s)<0)){var n=new $e(a),c=t,_=i.expression_type(s);c.forEach((function(e){if(i.is_continue(e)&&(n.add_block(et(0,r.continue_block_to_loop_header,e)),1===_.vecsize&&1===_.columns&&_.basetype!==L.Struct&&0===_.array.length)){var t=et(0,o,s);o[s]=0===t?e:4294967295}n.add_block(e)})),n.lift_continue_block_dominator();var p=n.get_dominator();if(p)if(!i.get(E,s).phi_variable){var l=i.get(J,p);if(i.may_read_undefined_variable_in_block(l,s)){for(;l.loop_dominator!==J.NoDominator;)l=i.get(J,l.loop_dominator);l.self!==p&&(n.add_block(l.self),p=n.get_dominator())}}if(p)(l=i.get(J,p)).dominated_variables.push(s),i.get(E,s).dominator=p}})),t.accessed_temporaries_to_block.forEach((function(e,o){if(t.result_id_to_type.hasOwnProperty(o)){var s=t.result_id_to_type[o],n=i.get(w,s);if(!i.type_is_opaque_value(n)){var c=new $e(a),_=!1,p=!1,l=e;l.forEach((function(e){if(c.add_block(e),1!==l.size&&i.is_continue(e)){var t=i.get(J,et(0,r.continue_block_to_loop_header,e));console.assert(t.merge===M.MergeLoop),c.add_block(t.self),p=!0}}));var u=c.get_dominator();if(1!==l.size&&i.is_single_block_loop(u)&&(_=!0),u)if(!l.has(u)||_)if(t.access_chain_expressions.has(o)){if(p){var h=i.get(J,u);console.assert(h.merge===M.MergeLoop),h.complex_continue=!0}}else i.hoisted_temporaries.add(o),i.forced_temporaries.add(o),i.get(J,u).declare_temporary.push(new Oe(et(0,t.result_id_to_type,o),o));else if(l.size>1){i.get(J,u).potential_declare_temporary.push(new Oe(et(0,t.result_id_to_type,o),o))}}}}));var u=new Set;o.forEach((function(e,o){var s=i.get(E,o).dominator,n=e;if(4294967295!==n&&0!==n&&0!==s){var c=0;r.continue_block_to_loop_header.hasOwnProperty(n)?c=r.continue_block_to_loop_header[n]:i.get(J,n).continue_block===n&&(c=n),console.assert(c);for(var _=i.get(J,c),p=et(Set,t.accessed_variables_to_block,o),l=p.has(c),h=!0;s!==c;){p.has(s)&&(l=!0);var d=a.get_succeeding_edges(s);if(1!==d.length){h=!1;break}var f=a.get_preceding_edges(d[0]);if(1!==f.length||f[0]!==s){h=!1;break}s=d[0]}h&&l&&(u.clear(),a.walk_from(u,_.merge_block,(function(e){return p.has(e)&&(h=!1),!0})),h&&(_.loop_variables.push(o),_.loop_variables.sort(),i.get(E,o).loop_variable=!0))}}))},e.prototype.find_function_local_luts=function(e,i,r){var a=this,o=et(it,this.function_cfgs,e.self),s=this.ir;i.accessed_variables_to_block.forEach((function(e,n){var c=e,_=a.get(E,n),p=a.expression_type(n);if((_.storage===v.StorageClassFunction||r&&_.storage===v.StorageClassPrivate)&&!_.phi_variable&&0!==p.array.length){var l=0;if(_.initializer){if(s.ids[_.initializer].get_type()!==t.TypeConstant)return;if(l=_.initializer,i.complete_write_variables_to_block.hasOwnProperty(_.self)||i.partial_write_variables_to_block.hasOwnProperty(_.self))return}else{if(i.partial_write_variables_to_block.hasOwnProperty(_.self))return;if(!i.complete_write_variables_to_block.hasOwnProperty(_.self))return;var u=i.complete_write_variables_to_block[_.self];if(1!==u.size)return;var h=new $e(o);c.forEach((function(e){return h.add_block(e)}));var d=h.get_dominator();if(u.has(d))return;var f=new ot(a,_.self);if(a.traverse_all_reachable_opcodes(a.get(J,d),f),1!==f.write_count||0===f.static_expression)return;if(s.ids[f.static_expression].get_type()!==t.TypeConstant)return;l=f.static_expression}a.get(U,l).is_used_as_lut=!0,_.static_expression=l,_.statically_assigned=!0,_.remapped_variable=!0}}))},e.prototype.may_read_undefined_variable_in_block=function(e,t){for(var i=0,r=e.ops;i<r.length;i++){var a=r[i],o=this.stream(a);switch(a.op){case ie.OpStore:case ie.OpCopyMemory:if(o[0]===t)return!1;break;case ie.OpAccessChain:case ie.OpInBoundsAccessChain:case ie.OpPtrAccessChain:if(o[2]===t)return!0;break;case ie.OpSelect:if(o[3]===t||o[4]===t)return!0;break;case ie.OpPhi:if(a.length<2)break;for(var s=a.length-2,n=0;n<s;n+=2)if(o[n+2]===t)return!0;break;case ie.OpCopyObject:case ie.OpLoad:if(o[2]===t)return!0;break;case ie.OpFunctionCall:if(a.length<3)break;var c=a.length-3;for(n=0;n<c;n++)if(o[n+3]===t)return!0}}return!0},e.prototype.analyze_interlocked_resource_usage=function(){if(this.get_execution_model()===Se.ExecutionModelFragment&&(this.get_entry_point().flags.get(Ee.ExecutionModePixelInterlockOrderedEXT)||this.get_entry_point().flags.get(Ee.ExecutionModePixelInterlockUnorderedEXT)||this.get_entry_point().flags.get(Ee.ExecutionModeSampleInterlockOrderedEXT)||this.get_entry_point().flags.get(Ee.ExecutionModeSampleInterlockUnorderedEXT))){var e=this.ir,t=new _t(this,e.default_entry_point);this.traverse_all_reachable_opcodes(this.get(j,e.default_entry_point),t);var i=new pt(this,e.default_entry_point);i.interlock_function_id=t.interlock_function_id,i.split_function_case=t.split_function_case,i.control_flow_interlock=t.control_flow_interlock,i.use_critical_section=!i.split_function_case&&!i.control_flow_interlock,this.traverse_all_reachable_opcodes(this.get(j,e.default_entry_point),i),this.interlocked_is_complex=!i.use_critical_section||i.interlock_function_id!==e.default_entry_point}},e.prototype.instruction_to_result_type=function(e,t,i){switch(e){case ie.OpStore:case ie.OpCopyMemory:case ie.OpCopyMemorySized:case ie.OpImageWrite:case ie.OpAtomicStore:case ie.OpAtomicFlagClear:case ie.OpEmitStreamVertex:case ie.OpEndStreamPrimitive:case ie.OpControlBarrier:case ie.OpMemoryBarrier:case ie.OpGroupWaitEvents:case ie.OpRetainEvent:case ie.OpReleaseEvent:case ie.OpSetUserEventStatus:case ie.OpCaptureEventProfilingInfo:case ie.OpCommitReadPipe:case ie.OpCommitWritePipe:case ie.OpGroupCommitReadPipe:case ie.OpGroupCommitWritePipe:case ie.OpLine:case ie.OpNoLine:return null;default:return i>1&&null!==this.maybe_get(w,t[0])?{result_type:t[0],result_id:t[1]}:null}},e.prototype.combined_decoration_for_member=function(e,t){var i=new y,r=this.ir.find_meta(e.self);if(r){var a=r.members;if(t>=a.length)return i;var o=a[t];i.merge_or(o.decoration_flags);for(var s=this.get(w,e.member_types[t]),n=s.member_types,c=0;c<n.length;c++){this.get(w,n[c]).pointer||i.merge_or(this.combined_decoration_for_member(s,c))}}return i},e.prototype.is_desktop_only_format=function(e){switch(e){case ut.ImageFormatR11fG11fB10f:case ut.ImageFormatR16f:case ut.ImageFormatRgb10A2:case ut.ImageFormatR8:case ut.ImageFormatRg8:case ut.ImageFormatR16:case ut.ImageFormatRg16:case ut.ImageFormatRgba16:case ut.ImageFormatR16Snorm:case ut.ImageFormatRg16Snorm:case ut.ImageFormatRgba16Snorm:case ut.ImageFormatR8Snorm:case ut.ImageFormatRg8Snorm:case ut.ImageFormatR8ui:case ut.ImageFormatRg8ui:case ut.ImageFormatR16ui:case ut.ImageFormatRgb10a2ui:case ut.ImageFormatR8i:case ut.ImageFormatRg8i:case ut.ImageFormatR16i:return!0}return!1},e.prototype.set_extended_decoration=function(e,t,i){void 0===i&&(i=0);var r=et(x,this.ir.meta,e).decoration;r.extended.flags.set(t),r.extended.values[t]=i},e.prototype.get_extended_decoration=function(e,t){var i=this.ir.find_meta(e);if(!i)return 0;var r=i.decoration;return r.extended.flags.get(t)?r.extended.values[t]:mt(t)},e.prototype.has_extended_decoration=function(e,t){var i=this.ir.find_meta(e);return!!i&&i.decoration.extended.flags.get(t)},e.prototype.unset_extended_decoration=function(e,t){var i=et(x,this.ir.meta,e).decoration;i.extended.flags.clear(t),i.extended.values[t]=0},e.prototype.set_extended_member_decoration=function(e,t,i,r){void 0===r&&(r=0);var a=et(x,this.ir.meta,e).members;t===a.length&&a.push(new I);var o=a[t];o.extended.flags.set(i),o.extended.values[i]=r},e.prototype.get_extended_member_decoration=function(e,t,i){var r=this.ir.find_meta(e);if(!r)return 0;if(t>=r.members.length)return 0;var a=r.members[t];return a.extended.flags.get(i)?a.extended.values[i]:mt(i)},e.prototype.has_extended_member_decoration=function(e,t,i){var r=this.ir.find_meta(e);return!!r&&(!(t>=r.members.length)&&r.members[t].extended.flags.get(i))},e.prototype.unset_extended_member_decoration=function(e,t,i){var r=et(x,this.ir.meta,e).members;t===r.length&&r.push(new I);var a=r[t];a.extended.flags.clear(i),a.extended.values[i]=0},e.prototype.type_is_array_of_pointers=function(e){return!!e.pointer&&e.pointer_depth===this.get(w,e.parent_type).pointer_depth},e.prototype.type_is_opaque_value=function(e){return!e.pointer&&(e.basetype===L.SampledImage||e.basetype===L.Image||e.basetype===L.Sampler)},e.prototype.is_depth_image=function(e,t){return e.image.depth&&e.image.format===ut.ImageFormatUnknown||this.comparison_ids.has(t)},e.prototype.reflection_ssbo_instance_name_is_significant=function(){var e=this,t=this.ir;if(t.source.known)return t.source.hlsl;var i=new Set,r=!1;return t.for_each_typed_id(E,(function(t,a){var o=e.get(w,a.basetype);o.pointer&&a.storage!==v.StorageClassFunction&&((a.storage===v.StorageClassStorageBuffer||a.storage===v.StorageClassUniform&&e.has_decoration(o.self,te.DecorationBufferBlock))&&(i.has(o.self)?r=!0:i.add(o.self)))})),r},e.prototype.type_struct_member_offset=function(e,t){var i=this.ir.find_meta(e.self);if(i){var r=i.members[t];if(r.decoration_flags.get(te.DecorationOffset))return r.offset;throw new Error("Struct member does not have Offset set.")}throw new Error("Struct member does not have Offset set.")},e.prototype.type_struct_member_array_stride=function(e,t){var i=this.ir.find_meta(e.member_types[t]);if(i){var r=i.decoration;if(r.decoration_flags.get(te.DecorationArrayStride))return r.array_stride;throw new Error("Struct member does not have ArrayStride set.")}throw new Error("Struct member does not have ArrayStride set.")},e.prototype.type_struct_member_matrix_stride=function(e,t){var i=this.ir.find_meta(e.self);if(i){var r=i.members[t];if(r.decoration_flags.get(te.DecorationMatrixStride))return r.matrix_stride;throw new Error("Struct member does not have MatrixStride set.")}throw new Error("Struct member does not have MatrixStride set.")},e.prototype.get_remapped_declared_block_name=function(e,t){var i=this.declared_block_names[e];if(i)return i;var r=this.get(E,e);if(t)return this.to_name(r.self);var a=this.get(w,r.basetype),o=this.ir.find_meta(a.self),s=o?o.decoration.alias:null;return s&&""!==s?s:this.get_block_fallback_name(e)},e.prototype.type_is_block_like=function(e){if(e.basetype!==L.Struct)return!1;if(this.has_decoration(e.self,te.DecorationBlock)||this.has_decoration(e.self,te.DecorationBufferBlock))return!0;for(var t=0;t<e.member_types.length;t++)if(this.has_member_decoration(e.self,t,te.DecorationOffset))return!0;return!1},e.prototype.flush_phi_required=function(e,t){for(var i=0,r=this.get(J,t).phi_variables;i<r.length;i++){if(r[i].parent===e)return!0}return!1},e.prototype.evaluate_spec_constant_u32=function(e){var t=this,i=this.get(w,e.basetype);if(i.basetype!==L.UInt&&i.basetype!==L.Int&&i.basetype!==L.Boolean)throw new Error("Only 32-bit integers and booleans are currently supported when evaluating specialization constants.");if(!this.is_scalar(i))throw new Error("Spec constant evaluation must be a scalar.\n");var r=0,a=function(e){var i=t.expression_type(e);if(i.basetype!==L.UInt&&i.basetype!==L.Int&&i.basetype!==L.Boolean)throw new Error("Only 32-bit integers and booleans are currently supported when evaluating specialization constants.");if(!t.is_scalar(i))throw new Error("Spec constant evaluation must be a scalar.");var r=t.maybe_get(U,e);return r?r.scalar():t.evaluate_spec_constant_u32(t.get(V,e))};switch(e.opcode){case ie.OpIAdd:r=a(e.arguments[0])+a(e.arguments[1]);break;case ie.OpISub:r=a(e.arguments[0])-a(e.arguments[1]);break;case ie.OpIMul:r=a(e.arguments[0])*a(e.arguments[1]);break;case ie.OpBitwiseAnd:r=a(e.arguments[0])&a(e.arguments[1]);break;case ie.OpBitwiseOr:r=a(e.arguments[0])|a(e.arguments[1]);break;case ie.OpBitwiseXor:r=a(e.arguments[0])^a(e.arguments[1]);break;case ie.OpLogicalAnd:r=a(e.arguments[0])&a(e.arguments[1]);break;case ie.OpLogicalOr:r=a(e.arguments[0])|a(e.arguments[1]);break;case ie.OpShiftLeftLogical:r=a(e.arguments[0])<<a(e.arguments[1]);break;case ie.OpShiftRightLogical:case ie.OpShiftRightArithmetic:r=a(e.arguments[0])>>a(e.arguments[1]);break;case ie.OpLogicalEqual:case ie.OpIEqual:r=a(e.arguments[0])===a(e.arguments[1])?1:0;break;case ie.OpLogicalNotEqual:case ie.OpINotEqual:r=a(e.arguments[0])!==a(e.arguments[1])?1:0;break;case ie.OpULessThan:case ie.OpSLessThan:r=a(e.arguments[0])<a(e.arguments[1])?1:0;break;case ie.OpULessThanEqual:case ie.OpSLessThanEqual:r=a(e.arguments[0])<=a(e.arguments[1])?1:0;break;case ie.OpUGreaterThan:case ie.OpSGreaterThan:r=a(e.arguments[0])>a(e.arguments[1])?1:0;break;case ie.OpUGreaterThanEqual:case ie.OpSGreaterThanEqual:r=a(e.arguments[0])>=a(e.arguments[1])?1:0;break;case ie.OpLogicalNot:r=a(e.arguments[0])?0:1;break;case ie.OpNot:r=~a(e.arguments[0]);break;case ie.OpSNegate:r=-a(e.arguments[0]);break;case ie.OpSelect:r=a(e.arguments[0])?a(e.arguments[1]):a(e.arguments[2]);break;case ie.OpUMod:case ie.OpSMod:case ie.OpSRem:var o=a(e.arguments[0]);if(0===(s=a(e.arguments[1])))throw new Error("Undefined behavior in Mod, b === 0.\n");r=o%s;break;case ie.OpUDiv:case ie.OpSDiv:var s;o=a(e.arguments[0]);if(0===(s=a(e.arguments[1])))throw new Error("Undefined behavior in Div, b === 0.\n");r=o/s;break;default:throw new Error("Unsupported spec constant opcode for evaluation.\n")}return r},e.prototype.evaluate_constant_u32=function(e){var t=this.maybe_get(U,e);return t?t.scalar():this.evaluate_spec_constant_u32(this.get(V,e))},e.prototype.is_vertex_like_shader=function(){var e=this.get_execution_model();return e===Se.ExecutionModelVertex||e===Se.ExecutionModelGeometry||e===Se.ExecutionModelTessellationControl||e===Se.ExecutionModelTessellationEvaluation},e.prototype.get_case_list=function(e){var t,i,r=this.ir,a=0;if(t=this.maybe_get(U,e.condition))a=this.get(w,t.constant_type).width;else if(i=this.maybe_get(E,e.condition)){a=this.get(w,i.basetype).width}else{var o=r.load_type_width[e.condition];if(o)throw new Error("Use of undeclared variable on a switch statement.");a=o}return a>32?e.cases_64bit:e.cases_32bit},e}();function ft(e,t,i,r){if(i.has(t))return!1;if(0===e.get_succeeding_edges(t).length)return!0;for(var a=0,o=e.get_succeeding_edges(t);a<o.length;a++){var s=o[a];if(!r.has(s)){if(ft(e,s,i,r))return!0;r.add(s)}}return!1}function mt(e){switch(e){case b.SPIRVCrossDecorationResourceIndexPrimary:case b.SPIRVCrossDecorationResourceIndexSecondary:case b.SPIRVCrossDecorationResourceIndexTertiary:case b.SPIRVCrossDecorationResourceIndexQuaternary:case b.SPIRVCrossDecorationInterfaceMemberIndex:return 4294967295;default:return 0}}function gt(e){return e.basetype===L.Half||e.basetype===L.Float||e.basetype===L.Double}function bt(e){return e.basetype===L.SByte||e.basetype===L.UByte||e.basetype===L.Short||e.basetype===L.UShort||e.basetype===L.Int||e.basetype===L.UInt||e.basetype===L.Int64||e.basetype===L.UInt64}function yt(e){switch(e){case ie.OpIEqual:case ie.OpINotEqual:case ie.OpISub:case ie.OpIAdd:case ie.OpIMul:case ie.OpShiftLeftLogical:case ie.OpBitwiseOr:case ie.OpBitwiseXor:case ie.OpBitwiseAnd:return!0;default:return!1}}function vt(e){switch(e){case 8:return L.SByte;case 16:return L.Short;case 32:return L.Int;case 64:return L.Int64;default:throw new Error("Invalid bit width.")}}function St(e){switch(e){case 8:return L.UByte;case 16:return L.UShort;case 32:return L.UInt;case 64:return L.UInt64;default:throw new Error("Invalid bit width.")}}var It,xt=function(e,t){this.location=e,this.component=t},Ot=function(){this.fixup_clipspace=!1,this.flip_vert_y=!1,this.support_nonzero_base_instance=!0};!function(e){e[e.DontCare=0]="DontCare",e[e.Lowp=1]="Lowp",e[e.Mediump=2]="Mediump",e[e.Highp=3]="Highp"}(It||(It={}));var kt,Lt,Et=function(){this.default_float_precision=It.Mediump,this.default_int_precision=It.Highp},Ct=function(){this.version=450,this.specConstPrefix="SPIRV_CROSS_CONSTANT_ID_",this.es=!1,this.force_temporary=!1,this.separate_shader_objects=!1,this.flatten_multidimensional_arrays=!1,this.enable_420pack_extension=!0,this.emit_push_constant_as_uniform_buffer=!1,this.emit_uniform_buffer_as_plain_uniforms=!1,this.emit_line_directives=!1,this.enable_storage_image_qualifier_deduction=!0,this.force_zero_initialized_variables=!1,this.force_flattened_io_blocks=!1,this.unnamed_ubo_to_global_uniforms=!1,this.ovr_multiview_view_count=0,this.vertex=new Ot,this.fragment=new Et},wt=function(){function e(){this._str=""}return e.prototype.str=function(){return this._str},e.prototype.append=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this._str=(e=this._str).concat.apply(e,t)},e.prototype.reset=function(){this._str=""},e}(),Tt=function(){this.storage_physical_type=0,this.need_transpose=!1,this.storage_is_packed=!1,this.storage_is_invariant=!1,this.flattened_struct=!1};!function(e){e[e.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT=1]="ACCESS_CHAIN_INDEX_IS_LITERAL_BIT",e[e.ACCESS_CHAIN_CHAIN_ONLY_BIT=2]="ACCESS_CHAIN_CHAIN_ONLY_BIT",e[e.ACCESS_CHAIN_PTR_CHAIN_BIT=4]="ACCESS_CHAIN_PTR_CHAIN_BIT",e[e.ACCESS_CHAIN_SKIP_REGISTER_EXPRESSION_READ_BIT=8]="ACCESS_CHAIN_SKIP_REGISTER_EXPRESSION_READ_BIT",e[e.ACCESS_CHAIN_LITERAL_MSB_FORCE_ID=16]="ACCESS_CHAIN_LITERAL_MSB_FORCE_ID",e[e.ACCESS_CHAIN_FLATTEN_ALL_MEMBERS_BIT=32]="ACCESS_CHAIN_FLATTEN_ALL_MEMBERS_BIT",e[e.ACCESS_CHAIN_FORCE_COMPOSITE_BIT=64]="ACCESS_CHAIN_FORCE_COMPOSITE_BIT"}(kt||(kt={})),function(e){e[e.BufferPackingStd140=0]="BufferPackingStd140",e[e.BufferPackingStd430=1]="BufferPackingStd430",e[e.BufferPackingStd140EnhancedLayout=2]="BufferPackingStd140EnhancedLayout",e[e.BufferPackingStd430EnhancedLayout=3]="BufferPackingStd430EnhancedLayout",e[e._BufferPackingHLSLCbuffer=4]="_BufferPackingHLSLCbuffer",e[e._BufferPackingHLSLCbufferPackOffset=5]="_BufferPackingHLSLCbufferPackOffset",e[e.BufferPackingScalar=6]="BufferPackingScalar",e[e.BufferPackingScalarEnhancedLayout=7]="BufferPackingScalarEnhancedLayout"}(Lt||(Lt={}));var Dt,Rt,Mt=function(){function e(){this.h=BigInt(0xcbf29ce484222000)}return e.prototype.u32=function(e){this.h=this.h*BigInt(1099511628211)^BigInt(e)},e.prototype.get=function(){return this.h},e}(),Bt=function(){function e(e,t){this.saved=e[t],this.targetObject=e,this.propName=t}return Object.defineProperty(e.prototype,"current",{get:function(){return this.targetObject[this.propName]},set:function(e){this.targetObject[this.propName]=e},enumerable:!1,configurable:!0}),e.prototype.release=function(){this.targetObject[this.propName]=this.saved},e}(),At=function(){this.img=0,this.is_fetch=!1,this.is_gather=!1,this.is_proj=!1},Nt=function(){this.base=new At,this.has_array_offsets=!1,this.has_offset=!1,this.has_grad=!1,this.has_dref=!1,this.is_sparse_feedback=!1,this.has_min_lod=!1,this.lod=0},Pt=function(){this.base=new At,this.coord=0,this.coord_components=0,this.dref=0,this.grad_x=0,this.grad_y=0,this.lod=0,this.coffset=0,this.offset=0,this.bias=0,this.component=0,this.sample=0,this.sparse_texel=0,this.min_lod=0,this.nonuniform_expression=!1};!function(e){e[e.ImageOperandsMaskNone=0]="ImageOperandsMaskNone",e[e.ImageOperandsBiasMask=1]="ImageOperandsBiasMask",e[e.ImageOperandsLodMask=2]="ImageOperandsLodMask",e[e.ImageOperandsGradMask=4]="ImageOperandsGradMask",e[e.ImageOperandsConstOffsetMask=8]="ImageOperandsConstOffsetMask",e[e.ImageOperandsOffsetMask=16]="ImageOperandsOffsetMask",e[e.ImageOperandsConstOffsetsMask=32]="ImageOperandsConstOffsetsMask",e[e.ImageOperandsSampleMask=64]="ImageOperandsSampleMask",e[e.ImageOperandsMinLodMask=128]="ImageOperandsMinLodMask",e[e.ImageOperandsMakeTexelAvailableMask=256]="ImageOperandsMakeTexelAvailableMask",e[e.ImageOperandsMakeTexelAvailableKHRMask=256]="ImageOperandsMakeTexelAvailableKHRMask",e[e.ImageOperandsMakeTexelVisibleMask=512]="ImageOperandsMakeTexelVisibleMask",e[e.ImageOperandsMakeTexelVisibleKHRMask=512]="ImageOperandsMakeTexelVisibleKHRMask",e[e.ImageOperandsNonPrivateTexelMask=1024]="ImageOperandsNonPrivateTexelMask",e[e.ImageOperandsNonPrivateTexelKHRMask=1024]="ImageOperandsNonPrivateTexelKHRMask",e[e.ImageOperandsVolatileTexelMask=2048]="ImageOperandsVolatileTexelMask",e[e.ImageOperandsVolatileTexelKHRMask=2048]="ImageOperandsVolatileTexelKHRMask",e[e.ImageOperandsSignExtendMask=4096]="ImageOperandsSignExtendMask",e[e.ImageOperandsZeroExtendMask=8192]="ImageOperandsZeroExtendMask"}(Dt||(Dt={})),function(e){e[e.EXTRA_SUB_EXPRESSION_TYPE_STREAM_OFFSET=268435456]="EXTRA_SUB_EXPRESSION_TYPE_STREAM_OFFSET",e[e.EXTRA_SUB_EXPRESSION_TYPE_AUX=536870912]="EXTRA_SUB_EXPRESSION_TYPE_AUX"}(Rt||(Rt={}));var Gt=function(){},Ft=[[".x",".y",".z",".w"],[".xy",".yz",".zw"],[".xyz",".yzw"],[""]],zt=[];zt[ie.OpSNegate]="-",zt[ie.OpNot]="~",zt[ie.OpIAdd]="+",zt[ie.OpISub]="-",zt[ie.OpIMul]="*",zt[ie.OpSDiv]="/",zt[ie.OpUDiv]="/",zt[ie.OpUMod]="%",zt[ie.OpSMod]="%",zt[ie.OpShiftRightLogical]=">>",zt[ie.OpShiftRightArithmetic]=">>",zt[ie.OpShiftLeftLogical]=">>",zt[ie.OpBitwiseOr]="|",zt[ie.OpBitwiseXor]="^",zt[ie.OpBitwiseAnd]="&",zt[ie.OpLogicalOr]="||",zt[ie.OpLogicalAnd]="&&",zt[ie.OpLogicalNot]="!",zt[ie.OpLogicalEqual]="==",zt[ie.OpLogicalNotEqual]="!=",zt[ie.OpIEqual]="==",zt[ie.OpINotEqual]="!=",zt[ie.OpULessThan]="<",zt[ie.OpSLessThan]="<",zt[ie.OpULessThanEqual]="<=",zt[ie.OpSLessThanEqual]="<=",zt[ie.OpUGreaterThan]=">",zt[ie.OpSGreaterThan]=">",zt[ie.OpSGreaterThanEqual]=">=",zt[ie.OpSGreaterThanEqual]=">=";var Ut=["x","y","z","w"],Vt=new Set(["abs","acos","acosh","all","any","asin","asinh","atan","atanh","atomicAdd","atomicCompSwap","atomicCounter","atomicCounterDecrement","atomicCounterIncrement","atomicExchange","atomicMax","atomicMin","atomicOr","atomicXor","bitCount","bitfieldExtract","bitfieldInsert","bitfieldReverse","ceil","cos","cosh","cross","degrees","dFdx","dFdxCoarse","dFdxFine","dFdy","dFdyCoarse","dFdyFine","distance","dot","EmitStreamVertex","EmitVertex","EndPrimitive","EndStreamPrimitive","equal","exp","exp2","faceforward","findLSB","findMSB","float16BitsToInt16","float16BitsToUint16","floatBitsToInt","floatBitsToUint","floor","fma","fract","frexp","fwidth","fwidthCoarse","fwidthFine","greaterThan","greaterThanEqual","groupMemoryBarrier","imageAtomicAdd","imageAtomicAnd","imageAtomicCompSwap","imageAtomicExchange","imageAtomicMax","imageAtomicMin","imageAtomicOr","imageAtomicXor","imageLoad","imageSamples","imageSize","imageStore","imulExtended","int16BitsToFloat16","intBitsToFloat","interpolateAtOffset","interpolateAtCentroid","interpolateAtSample","inverse","inversesqrt","isinf","isnan","ldexp","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","memoryBarrier","memoryBarrierAtomicCounter","memoryBarrierBuffer","memoryBarrierImage","memoryBarrierShared","min","mix","mod","modf","noise","noise1","noise2","noise3","noise4","normalize","not","notEqual","outerProduct","packDouble2x32","packHalf2x16","packInt2x16","packInt4x16","packSnorm2x16","packSnorm4x8","packUint2x16","packUint4x16","packUnorm2x16","packUnorm4x8","pow","radians","reflect","refract","round","roundEven","sign","sin","sinh","smoothstep","sqrt","step","tan","tanh","texelFetch","texelFetchOffset","texture","textureGather","textureGatherOffset","textureGatherOffsets","textureGrad","textureGradOffset","textureLod","textureLodOffset","textureOffset","textureProj","textureProjGrad","textureProjGradOffset","textureProjLod","textureProjLodOffset","textureProjOffset","textureQueryLevels","textureQueryLod","textureSamples","textureSize","transpose","trunc","uaddCarry","uint16BitsToFloat16","uintBitsToFloat","umulExtended","unpackDouble2x32","unpackHalf2x16","unpackInt2x16","unpackInt4x16","unpackSnorm2x16","unpackSnorm4x8","unpackUint2x16","unpackUint4x16","unpackUnorm2x16","unpackUnorm4x8","usubBorrow","active","asm","atomic_uint","attribute","bool","break","buffer","bvec2","bvec3","bvec4","case","cast","centroid","class","coherent","common","const","continue","default","discard","dmat2","dmat2x2","dmat2x3","dmat2x4","dmat3","dmat3x2","dmat3x3","dmat3x4","dmat4","dmat4x2","dmat4x3","dmat4x4","do","double","dvec2","dvec3","dvec4","else","enum","extern","external","false","filter","fixed","flat","float","for","fvec2","fvec3","fvec4","goto","half","highp","hvec2","hvec3","hvec4","if","iimage1D","iimage1DArray","iimage2D","iimage2DArray","iimage2DMS","iimage2DMSArray","iimage2DRect","iimage3D","iimageBuffer","iimageCube","iimageCubeArray","image1D","image1DArray","image2D","image2DArray","image2DMS","image2DMSArray","image2DRect","image3D","imageBuffer","imageCube","imageCubeArray","in","inline","inout","input","int","interface","invariant","isampler1D","isampler1DArray","isampler2D","isampler2DArray","isampler2DMS","isampler2DMSArray","isampler2DRect","isampler3D","isamplerBuffer","isamplerCube","isamplerCubeArray","ivec2","ivec3","ivec4","layout","long","lowp","mat2","mat2x2","mat2x3","mat2x4","mat3","mat3x2","mat3x3","mat3x4","mat4","mat4x2","mat4x3","mat4x4","mediump","namespace","noinline","noperspective","out","output","packed","partition","patch","precise","precision","public","readonly","resource","restrict","return","sample","sampler1D","sampler1DArray","sampler1DArrayShadow","sampler1DShadow","sampler2D","sampler2DArray","sampler2DArrayShadow","sampler2DMS","sampler2DMSArray","sampler2DRect","sampler2DRectShadow","sampler2DShadow","sampler3D","sampler3DRect","samplerBuffer","samplerCube","samplerCubeArray","samplerCubeArrayShadow","samplerCubeShadow","shared","short","sizeof","smooth","static","struct","subroutine","superp","switch","template","this","true","typedef","uimage1D","uimage1DArray","uimage2D","uimage2DArray","uimage2DMS","uimage2DMSArray","uimage2DRect","uimage3D","uimageBuffer","uimageCube","uimageCubeArray","uint","uniform","union","unsigned","usampler1D","usampler1DArray","usampler2D","usampler2DArray","usampler2DMS","usampler2DMSArray","usampler2DRect","usampler3D","usamplerBuffer","usamplerCube","usamplerCubeArray","using","uvec2","uvec3","uvec4","varying","vec2","vec3","vec4","void","volatile","while","writeonly"]);function Ht(e,t,i){var r=t[t];e[t]=e[i],e[i]=r}function qt(e){return e===m.BuiltInPosition||e===m.BuiltInPointSize||e===m.BuiltInClipDistance||e===m.BuiltInCullDistance}var Kt=function(e){function i(t){var i=e.call(this,t)||this;return i.current_emitting_block=null,i.current_emitting_switch=null,i.current_emitting_switch_fallthrough=!1,i.buffer=new wt,i.redirect_statement=null,i.current_continue_block=null,i.options=new Ct,i.local_variable_names=new Set,i.resource_names=new Set,i.block_input_names=new Set,i.block_output_names=new Set,i.block_ubo_names=new Set,i.block_ssbo_names=new Set,i.block_names=new Set,i.function_overloads={},i.preserved_aliases=[],i.processing_entry_point=!1,i.backend=new qe,i.indent=0,i.flushed_phi_variables=new Set,i.flattened_buffer_blocks=new Set,i.flattened_structs=[],i.expression_usage_counts=[],i.forced_extensions=[],i.header_lines=[],i.extra_sub_expressions=[],i.workaround_ubo_load_overload_types=[],i.statement_count=0,i.requires_transpose_2x2=!1,i.requires_transpose_3x3=!1,i.requires_transpose_4x4=!1,i.subpass_to_framebuffer_fetch_attachment=[],i.inout_color_attachments=[],i.masked_output_locations=new Set,i.masked_output_builtins=new Set,i.removed_structs=new Set,i.init(),i}return a(i,e),i.prototype.remap_pixel_local_storage=function(e,t){this.pls_inputs=e,this.pls_outputs=t,this.remap_pls_variables()},i.prototype.remap_ext_framebuffer_fetch=function(e,t,i){this.subpass_to_framebuffer_fetch_attachment.push(new Oe(e,t)),this.inout_color_attachments.push(new Oe(t,i))},i.prototype.get_common_options=function(){return this.options},i.prototype.require_extension=function(e){this.has_extension(e)||this.forced_extensions.push(e)},i.prototype.flatten_buffer_block=function(e){var t=this.get(E,e),i=this.get(w,t.basetype),r=this.to_name(i.self,!1),a=et(x,this.ir.meta,i.self).decoration.decoration_flags;if(i.array.length>0)throw new Error(r+" is an array of UBOs.");if(i.basetype!==L.Struct)throw new Error(r+" is not a struct.");if(!a.get(te.DecorationBlock))throw new Error(r+" is not a block.");if(0===i.member_types.length)throw new Error(r+" is an empty struct.");this.flattened_buffer_blocks.add(e)},i.prototype.mask_stage_output_by_location=function(e,t){for(var i=this.masked_output_locations,r=i.values(),a=null;a=r.next().value;)if(a.location===e&&a.component===t)return;i.add(new xt(e,t))},i.prototype.mask_stage_output_by_builtin=function(e){this.masked_output_builtins.add(e)},i.prototype.reset=function(){this.clear_force_recompile(),this.invalid_expressions.clear(),this.current_function=null,this.removed_structs.clear(),this.expression_usage_counts=[],this.forwarded_temporaries.clear(),this.suppressed_usage_tracking.clear(),this.flushed_phi_variables.clear(),this.reset_name_caches();var e=this.ir;e.for_each_typed_id(j,(function(e,t){t.active=!1,t.flush_undeclared=!0})),e.for_each_typed_id(E,(function(e,t){return t.dependees=[]})),e.reset_all_of_type(oe),e.reset_all_of_type(ne),this.statement_count=0,this.indent=0,this.current_loop_level=0},i.prototype.emit_function_prototype=function(e,t){var i=this.ir;e.self!==i.default_entry_point&&this.add_function_overload(e),this.local_variable_names=new Set(this.resource_names);var r="",a=this.get(w,e.return_type);r+=this.flags_to_qualifiers_glsl(a,t),r+=this.type_to_glsl(a),r+=this.type_to_array_glsl(a),r+=" ",e.self===i.default_entry_point?(this.interlocked_is_complex?r+="spvMainInterlockedBody":r+="main",this.processing_entry_point=!0):r+=this.to_name(e.self),r+="(";for(var o=[],s=0,n=e.arguments;s<n.length;s++){var c=n[s];if(!this.skip_argument(c.id))this.add_local_variable_name(c.id),o.push(this.argument_decl(c)),(l=this.maybe_get(E,c.id))&&(l.parameter=c)}for(var _=0,p=e.shadow_arguments;_<p.length;_++){var l;c=p[_];this.add_local_variable_name(c.id),o.push(this.argument_decl(c)),(l=this.maybe_get(E,c.id))&&(l.parameter=c)}r+=o.join(", "),r+=")",this.statement(r)},i.prototype.emit_function=function(e,t){if(!e.active){e.active=!0;for(var i=this.ir,r=0,a=e.blocks;r<a.length;r++)for(var o=a[r],s=0,n=this.get(J,o).ops;s<n.length;s++){var c=n[s],_=this.stream(c);if(c.op===ie.OpFunctionCall){var p=_[2];this.emit_function(this.get(j,p),et(x,i.meta,_[1]).decoration.decoration_flags)}}0!==e.entry_line.file_id&&this.emit_line_directive(e.entry_line.file_id,e.entry_line.line_literal),this.emit_function_prototype(e,t),this.begin_scope(),e.self===i.default_entry_point&&this.emit_entry_point_declarations(),this.current_function=e;var l=this.get(J,e.entry_block);e.constant_arrays_needed_on_stack.sort();for(var u=0,h=e.constant_arrays_needed_on_stack;u<h.length;u++){var d=h[u],f=this.get(U,d),m=this.get(w,f.constant_type);this.statement(this.variable_decl(m,"_".concat(d,"_array_copy"))," = ",this.constant_expression(f),";")}for(var g=0,b=e.local_variables;g<b.length;g++){var y=b[g];if((D=this.get(E,y)).deferred_declaration=!1,this.variable_decl_is_remapped_storage(D,v.StorageClassWorkgroup))this.add_local_variable_name(D.self),this.statement(this.variable_decl(D),";"),D.deferred_declaration=!1;else if(D.storage===v.StorageClassPrivate){if(this.add_local_variable_name(D.self),D.initializer)this.statement(this.variable_decl(D),";"),D.deferred_declaration=!1;else l.dominated_variables.indexOf(D.self)<0&&l.dominated_variables.push(D.self),D.deferred_declaration=!0}else D.storage===v.StorageClassFunction&&D.remapped_variable&&D.static_expression?D.deferred_declaration=!1:this.expression_is_lvalue(y)?(this.add_local_variable_name(D.self),D.initializer&&!D.loop_variable?this.statement(this.variable_decl_function_local(D),";"):D.deferred_declaration=!0):D.statically_assigned=!0;D.loop_variable_enable=!1,D.loop_variable&&(D.deferred_declaration=!1)}for(var S=0,I=e.blocks;S<I.length;S++){var O=I[S];(o=this.get(J,O)).dominated_variables.sort()}for(var k=0,L=this.current_function.fixup_hooks_in;k<L.length;k++){(0,L[k])()}this.emit_block_chain(l),this.end_scope(),this.processing_entry_point=!1,this.statement("");for(var C=0,T=e.local_variables;C<T.length;C++){var D;y=T[C];(D=this.get(E,y)).deferred_declaration=!1}}},i.prototype.has_extension=function(e){return this.forced_extensions.indexOf(e)>=0},i.prototype.require_extension_internal=function(e){this.backend.supports_extensions&&!this.has_extension(e)&&(this.forced_extensions.push(e),this.force_recompile())},i.prototype.emit_instruction=function(e){var i=this.stream(e),r=e.op,a=e.length,o=this.get_integer_width_for_instruction(e),s=vt(o),n=St(o),c=this,_=c.backend,p=c.options,l=c.ir;switch(r){case ie.OpLoad:var u=i[0],h=i[1],f=i[2];this.flush_variable_declaration(f);var m=this.should_forward(f)&&!this.forced_temporaries.has(h),g=!1,y=!1,S=this.maybe_get(oe,f);m&&(S&&S.need_transpose?(y=!0,S.need_transpose=!1,g=!0):this.is_non_native_row_major_matrix(f)&&(g=!0));var I=void 0,O=this.has_extended_decoration(f,b.SPIRVCrossDecorationPhysicalTypePacked),k=this.has_extended_decoration(f,b.SPIRVCrossDecorationPhysicalTypeID);I=m||!O&&!k?this.to_dereferenced_expression(f,!1):this.to_unpacked_expression(f);var C=this.get(w,u);this.expression_type(f).vecsize>C.vecsize&&(I=this.enclose_expression(I+this.vector_swizzle(C.vecsize,0))),I=this.cast_from_variable_load(f,I,C),I=this.unroll_array_from_complex_load(h,f,I),!this.type_is_opaque_value(C)&&this.has_decoration(f,te.DecorationNonUniform)&&(I=this.convert_non_uniform_expression(I,f)),m&&S&&(S.need_transpose=y);var T=S&&this.flattened_buffer_blocks.has(S.loaded_from);!_.needs_row_major_load_workaround||this.is_non_native_row_major_matrix(f)||T||(I=this.rewrite_load_for_wrapped_row_major(I,u,f));var D=T&&(C.basetype===L.Struct||C.columns>1),R=void 0;!m&&this.expression_is_non_value_type_array(f)?(R=this.emit_uninitialized_temporary_expression(u,h),this.emit_array_copy(this.to_expression(h),h,f,v.StorageClassFunction,this.get_expression_effective_storage_class(f))):R=this.emit_op(u,h,I,m,!D),R.need_transpose=g,this.register_read(h,f,m),m?(this.has_extended_decoration(f,b.SPIRVCrossDecorationPhysicalTypePacked)&&this.set_extended_decoration(h,b.SPIRVCrossDecorationPhysicalTypePacked),this.has_extended_decoration(f,b.SPIRVCrossDecorationPhysicalTypeID)&&this.set_extended_decoration(h,b.SPIRVCrossDecorationPhysicalTypeID,this.get_extended_decoration(f,b.SPIRVCrossDecorationPhysicalTypeID))):(this.unset_extended_decoration(h,b.SPIRVCrossDecorationPhysicalTypePacked),this.unset_extended_decoration(h,b.SPIRVCrossDecorationPhysicalTypeID)),this.inherit_expression_dependencies(h,f),m&&this.add_implied_read_expression(R,f);break;case ie.OpInBoundsAccessChain:case ie.OpAccessChain:case ie.OpPtrAccessChain:(we=this.maybe_get(E,i[2]))&&this.flush_variable_declaration(we.self);var M=new Tt,B=r===ie.OpPtrAccessChain,A=(R=this.access_chain(i[2],i,3,a-3,this.get(w,i[0]),M,B),I=this.set(oe,i[1],R,i[0],this.should_forward(i[2])),this.maybe_get_backing_variable(i[2]));I.loaded_from=A?A.self:i[2],I.need_transpose=M.need_transpose,I.access_chain=!0,M.storage_is_packed&&this.set_extended_decoration(i[1],b.SPIRVCrossDecorationPhysicalTypePacked),0!==M.storage_physical_type&&this.set_extended_decoration(i[1],b.SPIRVCrossDecorationPhysicalTypeID,M.storage_physical_type),M.storage_is_invariant&&this.set_decoration(i[1],te.DecorationInvariant),M.flattened_struct&&(this.flattened_structs[i[1]]=!0),this.forwarded_temporaries.add(i[1]),this.suppressed_usage_tracking.add(i[1]);for(var N=2;N<a;N++)this.inherit_expression_dependencies(i[1],i[N]),this.add_implied_read_expression(I,i[N]);0===I.expression_dependencies.length&&this.forwarded_temporaries.delete(i[1]);break;case ie.OpStore:(we=this.maybe_get(E,i[0]))&&we.statically_assigned||we&&we.loop_variable&&!we.loop_variable_enable?we.static_expression=i[1]:we&&we.remapped_variable&&we.static_expression||(this.flattened_structs.hasOwnProperty(i[0])?(this.store_flattened_struct(i[0],i[1]),this.register_write(i[0])):this.emit_store_statement(i[0],i[1])),this.expression_type(i[1]).pointer&&this.register_write(i[1]);break;case ie.OpArrayLength:u=i[0],h=i[1],R=this.access_chain_internal(i[2],i,3,a-3,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT,null);this.has_decoration(i[2],te.DecorationNonUniform)&&(R=this.convert_non_uniform_expression(R,i[2])),this.set(oe,h,this.type_to_glsl(this.get(w,u)),"("+R+".length())",u,!0);break;case ie.OpFunctionCall:u=i[0],h=i[1];var P=i[2];a-=3;var G=this.get(j,P),F=this.get(w,G.return_type),z=this.function_is_pure(G),V=!1,H=!1;for(N=0;N<a;N++)G.arguments[N].write_count&&(this.register_call_out_argument(i[N+3]),V=!0),this.flush_variable_declaration(i[N+3]);F.array.length>0&&!_.can_return_array&&(V=!0,H=!0),z||this.register_impure_function_call();var q="",K=[];q+=this.to_name(P)+"(",H&&(this.statement(this.type_to_glsl(F)," ",this.to_name(h),this.type_to_array_glsl(F),";"),K.push(this.to_name(h)));for(N=0;N<a;N++)this.skip_argument(i[N+3])||K.push(this.to_func_call_arg(G.arguments[N],i[N+3]));for(var X=0,W=G.combined_parameters;X<W.length;X++){var Y=W[X],Z=Y.global_image?Y.image_id:i[3+Y.image_id],J=Y.global_sampler?Y.sampler_id:i[3+Y.sampler_id];K.push(this.to_combined_image_sampler(Z,J))}if(this.append_global_func_args(G,a,K),q+=K.join(", "),q+=")",this.check_function_call_constraints(i,3,a),F.basetype!==L.Void){m=this.args_will_forward(h,i,3,a,z)&&!V&&z&&!this.forced_temporaries.has(h);H?(this.statement(q,";"),this.set(oe,h,this.to_name(h),u,!0)):this.emit_op(u,h,q,m);for(N=0;N<a;N++)this.register_read(h,i[N+3],m);m&&this.register_global_read_dependencies(G,h)}else this.statement(q,";");break;case ie.OpCompositeConstruct:u=i[0],h=i[1];a-=2;for(m=!0,N=0;N<a;N++)m=m&&this.should_forward(i[N+2]);var $=this.get(w,u),ee=a>0?this.expression_type(i[2]):null,re=$.array.length>0||$.basetype===L.Struct,ce=!1,_e=!1;if(ee&&(ce=1===ee.vecsize&&1===ee.columns&&!re&&_.use_constructor_splatting,_e=1===ee.vecsize&&1===ee.columns&&_.can_swizzle_scalar,l.ids[i[2]].get_type()!==t.TypeConstant||gt(ee)||(_e=!1)),ce||_e){var pe=i[2];for(N=0;N<a;N++)pe!==i[N+2]&&(ce=!1,_e=!1)}$.basetype!==L.Struct||_.can_declare_struct_inline||(m=!1),$.array.length>0&&!_.can_declare_arrays_inline&&(m=!1),this.type_is_empty($)&&!_.supports_empty_struct&&(m=!1);var le="";if(_.use_initializer_list&&re){var ue=!1;_.use_typed_initializer_list&&$.basetype===L.Struct&&0===$.array.length?le+=this.type_to_glsl_constructor(this.get(w,u)):_.use_typed_initializer_list&&_.array_is_value_type&&$.array.length>0&&(le+=this.type_to_glsl_constructor(this.get(w,u))+"(",ue=!0),le+="{ ",this.type_is_empty($)&&!_.supports_empty_struct?le+="0":le+=ce?this.to_unpacked_expression(i[2]):this.build_composite_combiner(u,i,2,a),le+=" }",ue&&(le+=")")}else _e&&!re?le=this.remap_swizzle(this.get(w,u),1,this.to_unpacked_expression(i[2])):(le=this.type_to_glsl_constructor(this.get(w,u))+"(",this.type_is_empty($)&&!_.supports_empty_struct?le+="0":le+=ce?this.to_unpacked_expression(i[2]):this.build_composite_combiner(u,i,2,a),le+=")");if(""!==le){this.emit_op(u,h,le,m);for(N=0;N<a;N++)this.inherit_expression_dependencies(h,i[N+2])}break;case ie.OpVectorInsertDynamic:u=i[0],h=i[1];var he=i[2],de=i[3];this.flush_variable_declaration(he),this.statement(this.declare_temporary(u,h),this.to_expression(he),";"),this.set(oe,h,this.to_name(h),u,!0);var fe=this.access_chain_internal(h,i,4,1,0,null);this.statement(fe," = ",this.to_unpacked_expression(de),";");break;case ie.OpVectorExtractDynamic:u=i[0],h=i[1],I=this.access_chain_internal(i[2],i,3,1,0,null);this.emit_op(u,h,I,this.should_forward(i[2])),this.inherit_expression_dependencies(h,i[2]),this.inherit_expression_dependencies(h,i[3]);break;case ie.OpCompositeExtract:u=i[0],h=i[1];a-=3;C=this.get(w,u);var me=!this.forced_temporaries.has(h),ge=this.expression_type(i[2]),be=ge.basetype===L.Struct||ge.array.length>0;be&&(me=!1),(this.has_extended_decoration(i[2],b.SPIRVCrossDecorationPhysicalTypePacked)||this.has_extended_decoration(i[2],b.SPIRVCrossDecorationPhysicalTypeID))&&(me=!1),this.is_non_native_row_major_matrix(i[2])&&(me=!1);M=new Tt,R=null;if(!(Fe=this.maybe_get(U,i[2]))||Fe.specialization||be)if(me&&this.should_forward(i[2])&&1===C.vecsize&&1===C.columns&&1===a){I=this.access_chain_internal(i[2],i,3,a,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT|kt.ACCESS_CHAIN_CHAIN_ONLY_BIT|kt.ACCESS_CHAIN_FORCE_COMPOSITE_BIT,M);R=this.emit_op(u,h,I,!0,this.should_suppress_usage_tracking(i[2])),this.inherit_expression_dependencies(h,i[2]),R.base_expression=i[2]}else{I=this.access_chain_internal(i[2],i,3,a,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT|kt.ACCESS_CHAIN_FORCE_COMPOSITE_BIT,M);R=this.emit_op(u,h,I,this.should_forward(i[2]),this.should_suppress_usage_tracking(i[2])),this.inherit_expression_dependencies(h,i[2])}else{var I=this.to_extract_constant_composite_expression(u,Fe,i,3,a);R=this.emit_op(u,h,I,!0,!0)}R.need_transpose=M.need_transpose,M.storage_is_packed&&this.set_extended_decoration(h,b.SPIRVCrossDecorationPhysicalTypePacked),0!==M.storage_physical_type&&this.set_extended_decoration(h,b.SPIRVCrossDecorationPhysicalTypeID,M.storage_physical_type),M.storage_is_invariant&&this.set_decoration(h,te.DecorationInvariant);break;case ie.OpCompositeInsert:u=i[0],h=i[1];var ye=i[2];re=i[3];a-=4,this.flush_variable_declaration(re),this.statement(this.declare_temporary(u,h),this.to_expression(re),";"),this.set(oe,h,this.to_name(h),u,!0);fe=this.access_chain_internal(h,i,4,a,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT,null);this.statement(fe," = ",this.to_unpacked_expression(ye),";");break;case ie.OpCopyMemory:var ve=i[0];if(ve!==(Le=i[1])){var Se=et(0,this.extra_sub_expressions,e.offset|Rt.EXTRA_SUB_EXPRESSION_TYPE_STREAM_OFFSET);Se||(Se=l.increase_bound_by(1));var Ie=this.expression_type(Le).parent_type,Oe=new xe,ke=new xe;Oe.op=ie.OpLoad,Oe.length=3,Oe.ops.push(Ie),Oe.ops.push(Se),Oe.ops.push(Le),ke.op=ie.OpStore,ke.length=2,ke.ops.push(ve),ke.ops.push(Se),this.emit_instruction(Oe),this.emit_instruction(ke)}break;case ie.OpCopyLogical:u=i[0],h=i[1];var Le=i[2];this.emit_uninitialized_temporary_expression(u,h),this.emit_copy_logical_type(h,u,Le,this.expression_type_id(Le),[]);break;case ie.OpCopyObject:u=i[0],h=i[1],Le=i[2];var Ee=this.get(w,u).pointer,Ce=(fe=this.maybe_get(ne,Le),this.maybe_get(se,Le));if(fe)(R=this.set(ne,h,fe)).self=h;else if(Ce){(R=this.set(se,h,Ce)).self=h}else if(this.expression_is_lvalue(Le)&&!Ee)this.statement(this.declare_temporary(u,h),this.to_unpacked_expression(Le),";"),this.set(oe,h,this.to_name(h),u,!0);else{R=this.set(oe,h,this.to_expression(Le),u,!0);if(Ee){var we=this.maybe_get_backing_variable(Le);R.loaded_from=we?we.self:0}var Te=this.maybe_get(oe,Le);Te&&(R.implied_read_expressions=Te.implied_read_expressions,R.expression_dependencies=Te.expression_dependencies)}break;case ie.OpVectorShuffle:u=i[0],h=i[1];var De=i[2],Re=i[3];a-=4;var Me=this.expression_type(De),Be=!1;for(N=0;N<a;N++)(i[N+4]>=Me.vecsize||4294967295===i[N+4])&&(Be=!0);!Be&&this.has_extended_decoration(De,b.SPIRVCrossDecorationPhysicalTypePacked)&&(Be=!0);I="";var Ae=!1,Ne=!1;if(Be){Ae=this.should_forward(De)&&this.should_forward(Re),Ne=this.should_suppress_usage_tracking(De)&&this.should_suppress_usage_tracking(Re);var Pe=[];for(N=0;N<a;N++){var Fe;if(4294967295===i[N+4])(Fe=new U).constant_type=Me.parent_type,console.assert(0!==Me.parent_type),Pe.push(this.constant_expression(Fe));else i[N+4]>=Me.vecsize?Pe.push(this.to_extract_component_expression(Re,i[N+4]-Me.vecsize)):Pe.push(this.to_extract_component_expression(De,i[N+4]))}I+=this.type_to_glsl_constructor(this.get(w,u))+"("+Pe.join(", ")+")"}else{Ae=this.should_forward(De),Ne=this.should_suppress_usage_tracking(De),I+=this.to_enclosed_unpacked_expression(De),I+=".";for(N=0;N<a;N++)console.assert(4294967295!==i[N+4]),I+=this.index_to_swizzle(i[N+4]);_.swizzle_is_function&&a>1&&(I+="()")}this.emit_op(u,h,I,Ae,Ne),this.inherit_expression_dependencies(h,De),De!==Re&&this.inherit_expression_dependencies(h,Re);break;case ie.OpIsNan:case ie.OpIsInf:this.emit_unary_func_op(i[0],i[1],i[2],"isnan");break;case ie.OpSNegate:case ie.OpFNegate:this.emit_unary_op(i[0],i[1],i[2],"-");break;case ie.OpIAdd:C=this.get(w,i[0]).basetype;this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"+",C,yt(r));break;case ie.OpFAdd:this.emit_binary_op(i[0],i[1],i[2],i[3],"+");break;case ie.OpISub:C=this.get(w,i[0]).basetype;this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"-",C,yt(r));break;case ie.OpFSub:this.emit_binary_op(i[0],i[1],i[2],i[3],"-");break;case ie.OpIMul:C=this.get(w,i[0]).basetype;this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"*",C,yt(r));break;case ie.OpVectorTimesMatrix:case ie.OpMatrixTimesVector:if((R=this.maybe_get(oe,i[r===ie.OpMatrixTimesVector?2:3]))&&R.need_transpose){R.need_transpose=!1;I="";I=r===ie.OpMatrixTimesVector?this.to_enclosed_unpacked_expression(i[3])+" * "+this.enclose_expression(this.to_unpacked_row_major_matrix_expression(i[2])):this.enclose_expression(this.to_unpacked_row_major_matrix_expression(i[3]))+" * "+this.to_enclosed_unpacked_expression(i[2]);m=this.should_forward(i[2])&&this.should_forward(i[3]);this.emit_op(i[0],i[1],I,m),R.need_transpose=!0,this.inherit_expression_dependencies(i[1],i[2]),this.inherit_expression_dependencies(i[1],i[3])}else this.emit_binary_op(i[0],i[1],i[2],i[3],"*");break;case ie.OpMatrixTimesMatrix:var ze=this.maybe_get(oe,i[2]),Ue=this.maybe_get(oe,i[3]);if(ze&&Ue&&ze.need_transpose&&Ue.need_transpose){ze.need_transpose=!1,Ue.need_transpose=!1;I=this.enclose_expression(this.to_unpacked_row_major_matrix_expression(i[3]))+" * "+this.enclose_expression(this.to_unpacked_row_major_matrix_expression(i[2])),m=this.should_forward(i[2])&&this.should_forward(i[3]);(R=this.emit_op(i[0],i[1],I,m)).need_transpose=!0,ze.need_transpose=!0,Ue.need_transpose=!0,this.inherit_expression_dependencies(i[1],i[2]),this.inherit_expression_dependencies(i[1],i[3])}else this.emit_binary_op(i[0],i[1],i[2],i[3],"*");break;case ie.OpFMul:case ie.OpMatrixTimesScalar:case ie.OpVectorTimesScalar:this.emit_binary_op(i[0],i[1],i[2],i[3],"*");break;case ie.OpOuterProduct:this.emit_binary_func_op(i[0],i[1],i[2],i[3],"outerProduct");break;case ie.OpDot:this.emit_binary_func_op(i[0],i[1],i[2],i[3],"dot");break;case ie.OpTranspose:if(p.version<120){u=i[0];var Ve=i[1],He=(pe=i[2],g=!1,this.maybe_get(oe,pe));if(He){var qe=g;g=He.need_transpose,He.need_transpose=qe}m=this.should_forward(pe);(R=this.emit_op(u,Ve,this.to_expression(pe),m)).need_transpose=!g,He&&(He.need_transpose=g)}else this.emit_unary_func_op(i[0],i[1],i[2],"transpose");break;case ie.OpSRem:u=i[0],Ve=i[1];var Ke=i[2],Xe=i[3];m=this.should_forward(Ke)&&this.should_forward(Xe),I=this.to_enclosed_expression(Ke)+" - "+this.to_enclosed_expression(Xe)+" * ("+this.to_enclosed_expression(Ke)+" / "+this.to_enclosed_expression(Xe)+")";this.emit_op(u,Ve,I,m),this.inherit_expression_dependencies(Ve,Ke),this.inherit_expression_dependencies(Ve,Xe);break;case ie.OpSDiv:this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"/",s,yt(r));break;case ie.OpUDiv:this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"/",n,yt(r));break;case ie.OpIAddCarry:case ie.OpISubBorrow:if(p.es&&p.version<310)throw new Error("Extended arithmetic is only available from ESSL 310.");if(!p.es&&p.version<400)throw new Error("Extended arithmetic is only available from GLSL 400.");u=i[0],Ve=i[1],Ke=i[2],Xe=i[3],C=this.get(w,u);this.emit_uninitialized_temporary_expression(u,Ve);var je=r===ie.OpIAddCarry?"uaddCarry":"usubBorrow";this.statement(this.to_expression(Ve),".",this.to_member_name(C,0)," = ",je,"(",this.to_expression(Ke),", ",this.to_expression(Xe),", ",this.to_expression(Ve),".",this.to_member_name(C,1),");");break;case ie.OpUMulExtended:case ie.OpSMulExtended:if(p.es&&p.version<310)throw new Error("Extended arithmetic is only available from ESSL 310.");if(!p.es&&p.version<400)throw new Error("Extended arithmetic is only available from GLSL 4000.");u=i[0],Ve=i[1],Ke=i[2],Xe=i[3],C=this.get(w,u);this.emit_uninitialized_temporary_expression(u,Ve);je=r===ie.OpUMulExtended?"umulExtended":"imulExtended";this.statement(je,"(",this.to_expression(Ke),", ",this.to_expression(Xe),", ",this.to_expression(Ve),".",this.to_member_name(C,1),", ",this.to_expression(Ve),".",this.to_member_name(C,0),");");break;case ie.OpFDiv:this.emit_binary_op(i[0],i[1],i[2],i[3],"/");break;case ie.OpShiftRightLogical:this.emit_binary_op_cast(i[0],i[1],i[2],i[3],">>",n,yt(r));break;case ie.OpShiftRightArithmetic:this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"+",s,yt(r));break;case ie.OpShiftLeftLogical:C=this.get(w,i[0]).basetype;this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"<<",C,yt(r));break;case ie.OpBitwiseOr:C=this.get(w,i[0]).basetype;this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"|",C,yt(r));break;case ie.OpBitwiseXor:C=this.get(w,i[0]).basetype;this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"^",C,yt(r));break;case ie.OpBitwiseAnd:C=this.get(w,i[0]).basetype;this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"&",C,yt(r));break;case ie.OpNot:this.emit_unary_op(i[0],i[1],i[2],"~");break;case ie.OpUMod:this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"%",n,yt(r));break;case ie.OpSMod:this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"%",s,yt(r));break;case ie.OpFMod:this.emit_binary_func_op(i[0],i[1],i[2],i[3],"mod");break;case ie.OpFRem:if(this.is_legacy())throw new Error("OpFRem requires trunc() and is only supported on non-legacy targets. A workaround is needed for legacy.");u=i[0],Ve=i[1],Ke=i[2],Xe=i[3],m=this.should_forward(Ke)&&this.should_forward(Xe),I=this.to_enclosed_expression(Ke)+" - "+this.to_enclosed_expression(Xe)+" * trunc("+this.to_enclosed_expression(Ke)+" / "+this.to_enclosed_expression(Xe)+")";this.emit_op(u,Ve,I,m),this.inherit_expression_dependencies(Ve,Ke),this.inherit_expression_dependencies(Ve,Xe);break;case ie.OpAny:this.emit_unary_func_op(i[0],i[1],i[2],"any");break;case ie.OpAll:this.emit_unary_func_op(i[0],i[1],i[2],"all");break;case ie.OpSelect:this.emit_mix_op(i[0],i[1],i[4],i[3],i[2]);break;case ie.OpLogicalOr:u=i[0],h=i[1];(C=this.get(w,u)).vecsize>1?this.emit_unrolled_binary_op(u,h,i[2],i[3],"||",!1,L.Unknown):this.emit_binary_op(i[0],i[1],i[2],i[3],"||");break;case ie.OpLogicalAnd:u=i[0],h=i[1];(C=this.get(w,u)).vecsize>1?this.emit_unrolled_binary_op(u,h,i[2],i[3],"&&",!1,L.Unknown):this.emit_binary_op(i[0],i[1],i[2],i[3],"&&");break;case ie.OpLogicalNot:(C=this.get(w,i[0])).vecsize>1?this.emit_unary_func_op(i[0],i[1],i[2],"not "):this.emit_unary_op(i[0],i[1],i[2],"!");break;case ie.OpIEqual:this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op_cast(i[0],i[1],i[2],i[3],"equal",s,yt(r)):this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"==",s,yt(r));break;case ie.OpLogicalEqual:case ie.OpFOrdEqual:this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op(i[0],i[1],i[2],i[3],"equal"):this.emit_binary_op(i[0],i[1],i[2],i[3],"==");break;case ie.OpINotEqual:this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op_cast(i[0],i[1],i[2],i[3],"notEqual",s,yt(r)):this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"!=",s,yt(r));break;case ie.OpLogicalNotEqual:case ie.OpFOrdNotEqual:this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op(i[0],i[1],i[2],i[3],"notEqual"):this.emit_binary_op(i[0],i[1],i[2],i[3],"!=");break;case ie.OpUGreaterThan:case ie.OpSGreaterThan:C=r===ie.OpUGreaterThan?n:s;this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op_cast(i[0],i[1],i[2],i[3],"greaterThan",C,yt(r)):this.emit_binary_op_cast(i[0],i[1],i[2],i[3],">",C,yt(r));break;case ie.OpFOrdGreaterThan:this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op(i[0],i[1],i[2],i[3],"greaterThan"):this.emit_binary_op(i[0],i[1],i[2],i[3],">");break;case ie.OpUGreaterThanEqual:case ie.OpSGreaterThanEqual:C=r===ie.OpUGreaterThanEqual?n:s;this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op_cast(i[0],i[1],i[2],i[3],"greaterThanEqual",C,yt(r)):this.emit_binary_op_cast(i[0],i[1],i[2],i[3],">=",C,yt(r));break;case ie.OpFOrdGreaterThanEqual:this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op(i[0],i[1],i[2],i[3],"greaterThanEqual"):this.emit_binary_op(i[0],i[1],i[2],i[3],">=");break;case ie.OpULessThan:case ie.OpSLessThan:C=r===ie.OpULessThan?n:s;this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op_cast(i[0],i[1],i[2],i[3],"lessThan",C,yt(r)):this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"<",C,yt(r));break;case ie.OpFOrdLessThan:this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op(i[0],i[1],i[2],i[3],"lessThan"):this.emit_binary_op(i[0],i[1],i[2],i[3],"<");break;case ie.OpULessThanEqual:case ie.OpSLessThanEqual:C=r===ie.OpULessThanEqual?n:s;this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op_cast(i[0],i[1],i[2],i[3],"lessThanEqual",C,yt(r)):this.emit_binary_op_cast(i[0],i[1],i[2],i[3],"<=",C,yt(r));break;case ie.OpFOrdLessThanEqual:this.expression_type(i[2]).vecsize>1?this.emit_binary_func_op(i[0],i[1],i[2],i[3],"lessThanEqual"):this.emit_binary_op(i[0],i[1],i[2],i[3],"<=");break;case ie.OpSConvert:case ie.OpConvertSToF:case ie.OpUConvert:case ie.OpConvertUToF:var We=r===ie.OpSConvert||r===ie.OpConvertSToF?s:n,Qe=(u=i[0],h=i[1],C=this.get(w,u),this.expression_type(i[2]));P=this.type_to_glsl_constructor(C);Qe.width<C.width||gt(C)?this.emit_unary_func_op_cast(u,h,i[2],P,We,C.basetype):this.emit_unary_func_op(u,h,i[2],P);break;case ie.OpConvertFToU:case ie.OpConvertFToS:u=i[0],h=i[1],C=this.get(w,u);var Ye=d(w,C),Ze=this.expression_type(i[2]);Ye.basetype=r===ie.OpConvertFToS?vt(C.width):St(C.width);P=this.type_to_glsl_constructor(Ye);this.emit_unary_func_op_cast(u,h,i[2],P,Ze.basetype,Ye.basetype);break;case ie.OpFConvert:u=i[0],h=i[1],P=this.type_to_glsl_constructor(this.get(w,u));this.emit_unary_func_op(u,h,i[2],P);break;case ie.OpBitcast:u=i[0],h=i[1];var Je=i[2];if(!this.emit_complex_bitcast(u,h,Je)){je=this.bitcast_glsl_op(this.get(w,u),this.expression_type(Je));this.emit_unary_func_op(u,h,Je,je)}break;case ie.OpQuantizeToF16:u=i[0],h=i[1],Je=i[2],je="";switch((C=this.get(w,u)).vecsize){case 1:je="unpackHalf2x16(packHalf2x16(vec2("+this.to_expression(Je);break;case 2:je="unpackHalf2x16(packHalf2x16("+this.to_expression(Je)+"))";break;case 3:je="vec3("+(Ke="unpackHalf2x16(packHalf2x16("+this.to_expression(Je)+".xy))")+", "+(Xe="unpackHalf2x16(packHalf2x16("+this.to_expression(Je)+".zz)).x")+")";break;case 4:je="vec4("+(Ke="unpackHalf2x16(packHalf2x16("+this.to_expression(Je)+".xy))")+", "+(Xe="unpackHalf2x16(packHalf2x16("+this.to_expression(Je)+".zw))")+")";break;default:throw new Error("Illegal argument to OpQuantizeToF16.")}this.emit_op(u,h,je,this.should_forward(Je)),this.inherit_expression_dependencies(h,Je);break;case ie.OpDPdx:this.emit_unary_func_op(i[0],i[1],i[2],"dFdx"),this.is_legacy_es()&&this.require_extension_internal("GL_OES_standard_derivatives"),this.register_control_dependent_expression(i[1]);break;case ie.OpDPdy:this.emit_unary_func_op(i[0],i[1],i[2],"dFdy"),this.is_legacy_es()&&this.require_extension_internal("GL_OES_standard_derivatives"),this.register_control_dependent_expression(i[1]);break;case ie.OpDPdxFine:if(this.emit_unary_func_op(i[0],i[1],i[2],"dFdxFine"),p.es)throw new Error("GL_ARB_derivative_control is unavailable in OpenGL ES.");p.version<450&&this.require_extension_internal("GL_ARB_derivative_control"),this.register_control_dependent_expression(i[1]);break;case ie.OpDPdyFine:if(this.emit_unary_func_op(i[0],i[1],i[2],"dFdyFine"),p.es)throw new Error("GL_ARB_derivative_control is unavailable in OpenGL ES.");p.version<450&&this.require_extension_internal("GL_ARB_derivative_control"),this.register_control_dependent_expression(i[1]);break;case ie.OpDPdxCoarse:if(p.es)throw new Error("GL_ARB_derivative_control is unavailable in OpenGL ES.");this.emit_unary_func_op(i[0],i[1],i[2],"dFdxCoarse"),p.version<450&&this.require_extension_internal("GL_ARB_derivative_control"),this.register_control_dependent_expression(i[1]);break;case ie.OpDPdyCoarse:if(this.emit_unary_func_op(i[0],i[1],i[2],"dFdyCoarse"),p.es)throw new Error("GL_ARB_derivative_control is unavailable in OpenGL ES.");p.version<450&&this.require_extension_internal("GL_ARB_derivative_control"),this.register_control_dependent_expression(i[1]);break;case ie.OpFwidth:this.emit_unary_func_op(i[0],i[1],i[2],"fwidth"),this.is_legacy_es()&&this.require_extension_internal("GL_OES_standard_derivatives"),this.register_control_dependent_expression(i[1]);break;case ie.OpFwidthCoarse:if(this.emit_unary_func_op(i[0],i[1],i[2],"fwidthCoarse"),p.es)throw new Error("GL_ARB_derivative_control is unavailable in OpenGL ES.");p.version<450&&this.require_extension_internal("GL_ARB_derivative_control"),this.register_control_dependent_expression(i[1]);break;case ie.OpFwidthFine:if(this.emit_unary_func_op(i[0],i[1],i[2],"fwidthFine"),p.es)throw new Error("GL_ARB_derivative_control is unavailable in OpenGL ES.");p.version<450&&this.require_extension_internal("GL_ARB_derivative_control"),this.register_control_dependent_expression(i[1]);break;case ie.OpBitFieldInsert:this.emit_bitfield_insert_op(i[0],i[1],i[2],i[3],i[4],i[5],"bitfieldInsert",L.Int);break;case ie.OpBitFieldSExtract:this.emit_trinary_func_op_bitextract(i[0],i[1],i[2],i[3],i[4],"bitfieldExtract",s,s,L.Int,L.Int);break;case ie.OpBitFieldUExtract:this.emit_trinary_func_op_bitextract(i[0],i[1],i[2],i[3],i[4],"bitfieldExtract",n,n,L.Int,L.Int);break;case ie.OpBitReverse:this.emit_unary_func_op(i[0],i[1],i[2],"bitfieldReverse");break;case ie.OpBitCount:var $e=this.expression_type(i[2]).basetype;this.emit_unary_func_op_cast(i[0],i[1],i[2],"bitCount",$e,s);break;case ie.OpImageSampleExplicitLod:case ie.OpImageSampleProjExplicitLod:case ie.OpImageSampleDrefExplicitLod:case ie.OpImageSampleProjDrefExplicitLod:case ie.OpImageSampleImplicitLod:case ie.OpImageSampleProjImplicitLod:case ie.OpImageSampleDrefImplicitLod:case ie.OpImageSampleProjDrefImplicitLod:case ie.OpImageFetch:case ie.OpImageGather:case ie.OpImageDrefGather:this.emit_texture_op(e,!1);break;case ie.OpImageSparseSampleExplicitLod:case ie.OpImageSparseSampleProjExplicitLod:case ie.OpImageSparseSampleDrefExplicitLod:case ie.OpImageSparseSampleProjDrefExplicitLod:case ie.OpImageSparseSampleImplicitLod:case ie.OpImageSparseSampleProjImplicitLod:case ie.OpImageSparseSampleDrefImplicitLod:case ie.OpImageSparseSampleProjDrefImplicitLod:case ie.OpImageSparseFetch:case ie.OpImageSparseGather:case ie.OpImageSparseDrefGather:this.emit_texture_op(e,!0);break;case ie.OpImageSparseTexelsResident:if(p.es)throw new Error("Sparse feedback is not supported in GLSL.");this.require_extension_internal("GL_ARB_sparse_texture2"),this.emit_unary_func_op_cast(i[0],i[1],i[2],"sparseTexelsResidentARB",s,L.Boolean);break;case ie.OpImage:u=i[0],h=i[1],R=this.emit_op(u,h,this.to_expression(i[2]),!0,!0),we=this.maybe_get_backing_variable(i[2]);R.loaded_from=we?we.self:0;break;case ie.OpImageQueryLod:je=null;if(!p.es&&p.version<400)this.require_extension_internal("GL_ARB_texture_query_lod"),je="textureQueryLOD";else{if(p.es)throw new Error("textureQueryLod not supported in ES profile.");je="textureQueryLod"}var tt=this.to_expression(i[2]);this.has_decoration(i[2],te.DecorationNonUniform)&&(this.maybe_get_backing_variable(i[2])?tt=this.convert_non_uniform_expression(tt,i[2]):"\0"!==_.nonuniform_qualifier&&(tt=_.nonuniform_qualifier+"("+tt+")"));m=this.should_forward(i[3]);this.emit_op(i[0],i[1],je+"("+tt+", "+this.to_unpacked_expression(i[3])+")",m),this.inherit_expression_dependencies(i[1],i[2]),this.inherit_expression_dependencies(i[1],i[3]),this.register_control_dependent_expression(i[1]);break;case ie.OpImageQueryLevels:u=i[0],h=i[1];if(!p.es&&p.version<430&&this.require_extension_internal("GL_ARB_texture_query_levels"),p.es)throw new Error("textureQueryLevels not supported in ES profile.");I="textureQueryLevels("+this.convert_separate_image_to_expression(i[2])+")";var it=this.get(w,i[0]);I=this.bitcast_expression(it,L.Int,I),this.emit_op(u,h,I,!0);break;case ie.OpImageQuerySamples:C=this.expression_type(i[2]),u=i[0],h=i[1],I=void 0;I=2===C.image.sampled?"imageSamples("+this.to_non_uniform_aware_expression(i[2])+")":"textureSamples("+this.convert_separate_image_to_expression(i[2])+")";it=this.get(w,i[0]);I=this.bitcast_expression(it,L.Int,I),this.emit_op(u,h,I,!0);break;case ie.OpSampledImage:u=i[0],h=i[1];this.emit_sampled_image_op(u,h,i[2],i[3]),this.inherit_expression_dependencies(h,i[2]),this.inherit_expression_dependencies(h,i[3]);break;case ie.OpImageQuerySizeLod:u=i[0],h=i[1];var rt=i[2],at="textureSize";if(this.is_legacy_desktop()){C=this.expression_type(rt);var ot=this.get(w,C.self);at=this.legacy_tex_op(at,ot,rt)}else if(this.is_legacy_es())throw new Error("textureSize is not supported in ESSL 100.");I=at+"("+this.convert_separate_image_to_expression(rt)+", "+this.bitcast_expression(L.Int,i[3])+")",it=this.get(w,i[0]);I=this.bitcast_expression(it,L.Int,I),this.emit_op(u,h,I,!0);break;case ie.OpImageRead:case ie.OpImageSparseRead:var st=this.maybe_get_backing_variable(i[2]);if(st)(dt=et(x,l.meta,st.self).decoration.decoration_flags).get(te.DecorationNonReadable)&&(dt.clear(te.DecorationNonReadable),this.force_recompile());u=i[0],h=i[1],z=!1;var nt="";C=this.expression_type(i[2]);if(st&&st.remapped_variable){if(C.image.ms)throw new Error("Trying to remap multisampled image to variable, this is not possible.");var ct=this.pls_inputs.find((function(e){return e.id===st.self}));if(ct){var _t=Yt(ct.format);nt=this.remap_swizzle(this.get(w,u),_t,this.to_expression(i[2]))}else{if(!st.remapped_components)throw new Error("subpassInput was remapped, but remap_components is not set correctly.");nt=this.remap_swizzle(this.get(w,u),st.remapped_components,this.to_expression(i[2]))}z=!0}else if(C.image.dim===Ge.DimSubpassData){if(st&&this.subpass_input_is_framebuffer_fetch(st.self))nt=this.to_expression(st.self);else if(C.image.ms){if(i[4]!==Dt.ImageOperandsSampleMask||6!==a)throw new Error("Multisampled image used in OpImageRead, but unexpected operand mask was used.");var pt=i[5];nt="texelFetch("+this.to_non_uniform_aware_expression(i[2])+", ivec2(gl_FragCoord.xy), "+this.to_expression(pt)+")"}else nt="texelFetch("+this.to_non_uniform_aware_expression(i[2])+", ivec2(gl_FragCoord.xy), 0)";nt=this.remap_swizzle(this.get(w,u),4,nt),z=!0}else{var lt=r===ie.OpImageSparseRead,ut=void 0;lt&&this.emit_sparse_feedback_temporaries(i[0],i[1],ut);var ht=this.to_expression(i[3]);if((bt=d(w,this.expression_type(i[3]))).basetype=L.Int,ht=this.bitcast_expression(bt,this.expression_type(i[3]).basetype,ht),lt){if(C.image.ms){if(i[4]!==Dt.ImageOperandsSampleMask||6!==a)throw new Error("Multisampled image used in OpImageRead, but unexpected operand mask was used.");pt=i[5];this.statement(this.to_expression(ut.sparse_code_id)," = sparseImageLoadARB(",this.to_non_uniform_aware_expression(i[2]),", ",ht,", ",this.to_expression(pt),", ",this.to_expression(ut.sparse_texel_id),");")}else this.statement(this.to_expression(ut.sparse_code_id)," = sparseImageLoadARB(",this.to_non_uniform_aware_expression(i[2]),", ",ht,", ",this.to_expression(ut.sparse_texel_id),");");nt=this.type_to_glsl(this.get(w,u))+"("+this.to_expression(ut.sparse_code_id)+", "+this.to_expression(ut.sparse_texel_id)+")"}else if(C.image.ms){if(i[4]!==Dt.ImageOperandsSampleMask||6!==a)throw new Error("Multisampled image used in OpImageRead, but unexpected operand mask was used.");pt=i[5];nt="imageLoad("+this.to_non_uniform_aware_expression(i[2])+", "+ht+", "+this.to_expression(pt)+")"}else nt="imageLoad("+this.to_non_uniform_aware_expression(i[2])+", "+ht+")";lt||(nt=this.remap_swizzle(this.get(w,u),4,nt)),z=!1}if(st&&st.forwardable){m=!this.forced_temporaries.has(h),R=this.emit_op(u,h,nt,m);z||(R.loaded_from=st.self,m&&st.dependees.push(h))}else this.emit_op(u,h,nt,!1);this.inherit_expression_dependencies(h,i[2]),C.image.ms&&this.inherit_expression_dependencies(h,i[5]);break;case ie.OpImageTexelPointer:u=i[0],h=i[1],ht=this.to_expression(i[3]);(bt=d(w,this.expression_type(i[3]))).basetype=L.Int,ht=this.bitcast_expression(bt,this.expression_type(i[3]).basetype,ht);I=this.to_expression(i[2])+", "+ht,R=this.set(oe,h,I,u,!0),we=this.maybe_get_backing_variable(i[2]);R.loaded_from=we?we.self:0,this.inherit_expression_dependencies(h,i[3]);break;case ie.OpImageWrite:var dt;if(we=this.maybe_get_backing_variable(i[0]))(dt=et(x,l.meta,we.self).decoration.decoration_flags).get(te.DecorationNonWritable)&&(dt.clear(te.DecorationNonWritable),this.force_recompile());C=this.expression_type(i[0]);var ft=this.expression_type(i[2]),mt=d(w,ft);mt.vecsize=4;var bt;ht=this.to_expression(i[1]);if((bt=d(w,this.expression_type(i[1]))).basetype=L.Int,ht=this.bitcast_expression(bt,this.expression_type(i[1]).basetype,ht),C.image.ms){if(i[3]!==Dt.ImageOperandsSampleMask||5!==a)throw new Error("Multisampled image used in OpImageWrite, but unexpected operand mask was used.");pt=i[4];this.statement("imageStore(",this.to_non_uniform_aware_expression(i[0]),", ",ht,", ",this.to_expression(pt),", ",this.remap_swizzle(mt,ft.vecsize,this.to_expression(i[2])),");")}else this.statement("imageStore(",this.to_non_uniform_aware_expression(i[0]),", ",ht,", ",this.remap_swizzle(mt,ft.vecsize,this.to_expression(i[2])),");");we&&this.variable_storage_is_aliased(we)&&this.flush_all_aliased_variables();break;case ie.OpImageQuerySize:C=this.expression_type(i[2]),u=i[0],h=i[1];if(C.basetype!==L.Image)throw new Error("Invalid type for OpImageQuerySize.");I=void 0;if(2===C.image.sampled){if(!p.es&&p.version<430)this.require_extension_internal("GL_ARB_shader_image_size");else if(p.es&&p.version<310)throw new Error("At least ESSL 3.10 required for imageSize.");I="imageSize("+this.to_non_uniform_aware_expression(i[2])+")"}else{at="textureSize";if(this.is_legacy()){ot=this.get(w,C.self);at=this.legacy_tex_op(at,ot,i[2])}I=at+"("+this.convert_separate_image_to_expression(i[2])+")"}it=this.get(w,i[0]);I=this.bitcast_expression(it,L.Int,I),this.emit_op(u,h,I,!0);break;case ie.OpExtInst:var It=i[2],xt=this.get(ae,It).ext;if(xt!==Q.GLSL){if(xt===Q.SPV_debug_info)break;this.statement("// unimplemented ext op ",e.op);break}this.emit_glsl_op(i[0],i[1],i[3],i,4,a-4);break;case ie.OpFUnordEqual:case ie.OpFUnordNotEqual:case ie.OpFUnordLessThan:case ie.OpFUnordGreaterThan:case ie.OpFUnordLessThanEqual:case ie.OpFUnordGreaterThanEqual:Ke=i[2],Xe=i[3],I=void 0;if(this.expression_type(Ke).vecsize>1){var Ot=null;switch(r){case ie.OpFUnordEqual:Ot="notEqual";break;case ie.OpFUnordNotEqual:Ot="equal";break;case ie.OpFUnordLessThan:Ot="greaterThanEqual";break;case ie.OpFUnordLessThanEqual:Ot="greaterThan";break;case ie.OpFUnordGreaterThan:Ot="lessThanEqual";break;case ie.OpFUnordGreaterThanEqual:Ot="lessThan";break;default:console.assert(0)}I="not("+Ot+"("+this.to_unpacked_expression(Ke)+", "+this.to_unpacked_expression(Xe)+"))"}else{Ot=null;switch(r){case ie.OpFUnordEqual:Ot=" !== ";break;case ie.OpFUnordNotEqual:Ot=" === ";break;case ie.OpFUnordLessThan:Ot=" >= ";break;case ie.OpFUnordLessThanEqual:Ot=" > ";break;case ie.OpFUnordGreaterThan:Ot=" <= ";break;case ie.OpFUnordGreaterThanEqual:Ot=" < ";break;default:console.assert(0)}I="!("+this.to_enclosed_unpacked_expression(Ke)+Ot+this.to_enclosed_unpacked_expression(Xe)+")"}this.emit_op(i[0],i[1],I,this.should_forward(Ke)&&this.should_forward(Xe)),this.inherit_expression_dependencies(i[1],Ke),this.inherit_expression_dependencies(i[1],Xe);break;case ie.OpConvertUToPtr:if((C=this.get(w,i[0])).storage!==v.StorageClassPhysicalStorageBufferEXT)throw new Error("Only StorageClassPhysicalStorageBufferEXT is supported by OpConvertUToPtr.");2===(ee=this.expression_type(i[2])).vecsize&&this.require_extension_internal("GL_EXT_buffer_reference_uvec2");je=this.type_to_glsl(C);this.emit_unary_func_op(i[0],i[1],i[2],je);break;case ie.OpConvertPtrToU:C=this.get(w,i[0]);if(this.expression_type(i[2]).storage!==v.StorageClassPhysicalStorageBufferEXT)throw new Error("Only StorageClassPhysicalStorageBufferEXT is supported by OpConvertPtrToU.");2===C.vecsize&&this.require_extension_internal("GL_EXT_buffer_reference_uvec2");je=this.type_to_glsl(C);this.emit_unary_func_op(i[0],i[1],i[2],je);break;case ie.OpUndef:break;case ie.OpLine:this.emit_line_directive(i[0],i[1]);break;case ie.OpNoLine:break;case ie.OpDemoteToHelperInvocationEXT:case ie.OpIsHelperInvocationEXT:throw new Error("GL_EXT_demote_to_helper_invocation is only supported in Vulkan GLSL.");default:console.log("unimplemented op ",e.op),this.statement("// unimplemented op ",e.op)}},i.prototype.emit_block_instructions=function(e){this.current_emitting_block=e;for(var t=0,i=e.ops;t<i.length;t++){var r=i[t];this.emit_instruction(r)}this.current_emitting_block=null},i.prototype.emit_glsl_op=function(e,t,i,r,a,o){var s=i;if(this.is_legacy()&&function(e){switch(e){case Ue.GLSLstd450UClamp:case Ue.GLSLstd450UMin:case Ue.GLSLstd450UMax:case Ue.GLSLstd450FindUMsb:return!0;default:return!1}}(s))throw new Error("Unsigned integers are not supported on legacy GLSL targets.");var n=this.get_integer_width_for_glsl_instruction(s,r,a,o),c=vt(n),_=St(n),p=this.options,l=this.ir;switch(s){case Ue.GLSLstd450Round:if(this.is_legacy()){var u=this.to_enclosed_expression(r[a]),h=this.expression_type(r[a]),f="floor("+u+" + "+this.type_to_glsl_constructor(h)+"(0.5))",m=this.should_forward(r[a]);this.emit_op(e,t,f,m),this.inherit_expression_dependencies(t,r[a])}else this.emit_unary_func_op(e,t,r[a],"round");break;case Ue.GLSLstd450RoundEven:if(this.is_legacy()){if(p.es)throw new Error("roundEven supported only in ESSL 300.");this.require_extension_internal("GL_EXT_gpu_shader4"),this.emit_unary_func_op(e,t,r[a],"round")}else this.emit_unary_func_op(e,t,r[a],"roundEven");break;case Ue.GLSLstd450Trunc:this.emit_unary_func_op(e,t,r[a],"trunc");break;case Ue.GLSLstd450SAbs:this.emit_unary_func_op_cast(e,t,r[a],"abs",c,c);break;case Ue.GLSLstd450FAbs:this.emit_unary_func_op(e,t,r[a],"abs");break;case Ue.GLSLstd450SSign:this.emit_unary_func_op_cast(e,t,r[a],"sign",c,c);break;case Ue.GLSLstd450FSign:this.emit_unary_func_op(e,t,r[a],"sign");break;case Ue.GLSLstd450Floor:this.emit_unary_func_op(e,t,r[a],"floor");break;case Ue.GLSLstd450Ceil:this.emit_unary_func_op(e,t,r[a],"ceil");break;case Ue.GLSLstd450Fract:this.emit_unary_func_op(e,t,r[a],"fract");break;case Ue.GLSLstd450Radians:this.emit_unary_func_op(e,t,r[a],"radians");break;case Ue.GLSLstd450Degrees:this.emit_unary_func_op(e,t,r[a],"degrees");break;case Ue.GLSLstd450Fma:if(!p.es&&p.version<400||p.es&&p.version<320){f=this.to_enclosed_expression(r[a])+" * "+this.to_enclosed_expression(r[a+1])+" + "+this.to_enclosed_expression(r[a+2]);this.emit_op(e,t,f,this.should_forward(r[a])&&this.should_forward(r[a+1])&&this.should_forward(r[a+2]));for(var g=0;g<3;g++)this.inherit_expression_dependencies(t,r[g])}else this.emit_trinary_func_op(e,t,r[a],r[a+1],r[a+2],"fma");break;case Ue.GLSLstd450Modf:this.register_call_out_argument(r[a+1]),this.forced_temporaries.add(t),this.emit_binary_func_op(e,t,r[a],r[a+1],"modf");break;case Ue.GLSLstd450ModfStruct:var b=this.get(w,e);this.emit_uninitialized_temporary_expression(e,t),this.statement(this.to_expression(t),".",this.to_member_name(b,0)," = ","modf(",this.to_expression(r[a]),", ",this.to_expression(t),".",this.to_member_name(b,1),");");break;case Ue.GLSLstd450UMin:this.emit_binary_func_op_cast(e,t,r[a],r[a+1],"min",_,!1);break;case Ue.GLSLstd450SMin:this.emit_binary_func_op_cast(e,t,r[a],r[a+1],"min",c,!1);break;case Ue.GLSLstd450FMin:this.emit_binary_func_op(e,t,r[a],r[a+1],"min");break;case Ue.GLSLstd450FMax:this.emit_binary_func_op(e,t,r[a],r[a+1],"max");break;case Ue.GLSLstd450UMax:this.emit_binary_func_op_cast(e,t,r[a],r[a+1],"max",_,!1);break;case Ue.GLSLstd450SMax:this.emit_binary_func_op_cast(e,t,r[a],r[a+1],"max",c,!1);break;case Ue.GLSLstd450FClamp:this.emit_trinary_func_op(e,t,r[a],r[a+1],r[a+2],"clamp");break;case Ue.GLSLstd450UClamp:this.emit_trinary_func_op_cast(e,t,r[a],r[a+1],r[a+2],"clamp",_);break;case Ue.GLSLstd450SClamp:this.emit_trinary_func_op_cast(e,t,r[a],r[a+1],r[a+2],"clamp",c);break;case Ue.GLSLstd450Sin:this.emit_unary_func_op(e,t,r[a],"sin");break;case Ue.GLSLstd450Cos:this.emit_unary_func_op(e,t,r[a],"cos");break;case Ue.GLSLstd450Tan:this.emit_unary_func_op(e,t,r[a],"tan");break;case Ue.GLSLstd450Asin:this.emit_unary_func_op(e,t,r[a],"asin");break;case Ue.GLSLstd450Acos:this.emit_unary_func_op(e,t,r[a],"acos");break;case Ue.GLSLstd450Atan:this.emit_unary_func_op(e,t,r[a],"atan");break;case Ue.GLSLstd450Sinh:this.emit_unary_func_op(e,t,r[a],"sinh");break;case Ue.GLSLstd450Cosh:this.emit_unary_func_op(e,t,r[a],"cosh");break;case Ue.GLSLstd450Tanh:this.emit_unary_func_op(e,t,r[a],"tanh");break;case Ue.GLSLstd450Asinh:this.emit_unary_func_op(e,t,r[a],"asinh");break;case Ue.GLSLstd450Acosh:this.emit_unary_func_op(e,t,r[a],"acosh");break;case Ue.GLSLstd450Atanh:this.emit_unary_func_op(e,t,r[a],"atanh");break;case Ue.GLSLstd450Atan2:this.emit_binary_func_op(e,t,r[a],r[a+1],"atan");break;case Ue.GLSLstd450Pow:this.emit_binary_func_op(e,t,r[a],r[a+1],"pow");break;case Ue.GLSLstd450Exp:this.emit_unary_func_op(e,t,r[a],"exp");break;case Ue.GLSLstd450Log:this.emit_unary_func_op(e,t,r[a],"log");break;case Ue.GLSLstd450Exp2:this.emit_unary_func_op(e,t,r[a],"exp2");break;case Ue.GLSLstd450Log2:this.emit_unary_func_op(e,t,r[a],"log2");break;case Ue.GLSLstd450Sqrt:this.emit_unary_func_op(e,t,r[a],"sqrt");break;case Ue.GLSLstd450InverseSqrt:this.emit_unary_func_op(e,t,r[a],"inversesqrt");break;case Ue.GLSLstd450Determinant:this.emit_unary_func_op(e,t,r[a],"determinant");break;case Ue.GLSLstd450MatrixInverse:this.emit_unary_func_op(e,t,r[a],"inverse");break;case Ue.GLSLstd450FMix:case Ue.GLSLstd450IMix:this.emit_mix_op(e,t,r[a],r[a+1],r[a+2]);break;case Ue.GLSLstd450Step:this.emit_binary_func_op(e,t,r[a],r[a+1],"step");break;case Ue.GLSLstd450SmoothStep:this.emit_trinary_func_op(e,t,r[a],r[a+1],r[a+2],"smoothstep");break;case Ue.GLSLstd450Frexp:this.register_call_out_argument(r[a+1]),this.forced_temporaries.add(t),this.emit_binary_func_op(e,t,r[a],r[a+1],"frexp");break;case Ue.GLSLstd450FrexpStruct:b=this.get(w,e);this.emit_uninitialized_temporary_expression(e,t),this.statement(this.to_expression(t),".",this.to_member_name(b,0)," = ","frexp(",this.to_expression(r[a]),", ",this.to_expression(t),".",this.to_member_name(b,1),");");break;case Ue.GLSLstd450Ldexp:m=this.should_forward(r[a])&&this.should_forward(r[a+1]),u=this.to_unpacked_expression(r[a]);var y=this.to_unpacked_expression(r[a+1]),v=this.expression_type(r[a+1]);if(v.basetype!==L.Int){var S=d(w,v);S.basetype=L.Int,y=this.type_to_glsl_constructor(S)+"("+y+")"}f="ldexp("+u+", "+y+")";this.emit_op(e,t,f,m),this.inherit_expression_dependencies(t,r[a]),this.inherit_expression_dependencies(t,r[a+1]);break;case Ue.GLSLstd450PackSnorm4x8:this.emit_unary_func_op(e,t,r[a],"packSnorm4x8");break;case Ue.GLSLstd450PackUnorm4x8:this.emit_unary_func_op(e,t,r[a],"packUnorm4x8");break;case Ue.GLSLstd450PackSnorm2x16:this.emit_unary_func_op(e,t,r[a],"packSnorm2x16");break;case Ue.GLSLstd450PackUnorm2x16:this.emit_unary_func_op(e,t,r[a],"packUnorm2x16");break;case Ue.GLSLstd450PackHalf2x16:this.emit_unary_func_op(e,t,r[a],"packHalf2x16");break;case Ue.GLSLstd450UnpackSnorm4x8:this.emit_unary_func_op(e,t,r[a],"unpackSnorm4x8");break;case Ue.GLSLstd450UnpackUnorm4x8:this.emit_unary_func_op(e,t,r[a],"unpackUnorm4x8");break;case Ue.GLSLstd450UnpackSnorm2x16:this.emit_unary_func_op(e,t,r[a],"unpackSnorm2x16");break;case Ue.GLSLstd450UnpackUnorm2x16:this.emit_unary_func_op(e,t,r[a],"unpackUnorm2x16");break;case Ue.GLSLstd450UnpackHalf2x16:this.emit_unary_func_op(e,t,r[a],"unpackHalf2x16");break;case Ue.GLSLstd450PackDouble2x32:this.emit_unary_func_op(e,t,r[a],"packDouble2x32");break;case Ue.GLSLstd450UnpackDouble2x32:this.emit_unary_func_op(e,t,r[a],"unpackDouble2x32");break;case Ue.GLSLstd450Length:this.emit_unary_func_op(e,t,r[a],"length");break;case Ue.GLSLstd450Distance:this.emit_binary_func_op(e,t,r[a],r[a+1],"distance");break;case Ue.GLSLstd450Cross:this.emit_binary_func_op(e,t,r[a],r[a+1],"cross");break;case Ue.GLSLstd450Normalize:this.emit_unary_func_op(e,t,r[a],"normalize");break;case Ue.GLSLstd450FaceForward:this.emit_trinary_func_op(e,t,r[a],r[a+1],r[a+2],"faceforward");break;case Ue.GLSLstd450Reflect:this.emit_binary_func_op(e,t,r[a],r[a+1],"reflect");break;case Ue.GLSLstd450Refract:this.emit_trinary_func_op(e,t,r[a],r[a+1],r[a+2],"refract");break;case Ue.GLSLstd450FindILsb:this.emit_unary_func_op_cast(e,t,r[a],"findLSB",this.expression_type(r[a]).basetype,c);break;case Ue.GLSLstd450FindSMsb:this.emit_unary_func_op_cast(e,t,r[a],"findMSB",c,c);break;case Ue.GLSLstd450FindUMsb:this.emit_unary_func_op_cast(e,t,r[a],"findMSB",_,c);break;case Ue.GLSLstd450InterpolateAtCentroid:this.emit_unary_func_op(e,t,r[a],"interpolateAtCentroid");break;case Ue.GLSLstd450InterpolateAtSample:this.emit_binary_func_op(e,t,r[a],r[a+1],"interpolateAtSample");break;case Ue.GLSLstd450InterpolateAtOffset:this.emit_binary_func_op(e,t,r[a],r[a+1],"interpolateAtOffset");break;case Ue.GLSLstd450NMin:case Ue.GLSLstd450NMax:this.emit_nminmax_op(e,t,r[a],r[a+1],s);break;case Ue.GLSLstd450NClamp:var I=et(0,this.extra_sub_expressions,t|Rt.EXTRA_SUB_EXPRESSION_TYPE_AUX);I||(I=l.increase_bound_by(1)),l.meta[I]=d(x,l.meta[t]),this.emit_nminmax_op(e,I,r[a],r[a+1],Ue.GLSLstd450NMax),this.emit_nminmax_op(e,t,I,r[a+2],Ue.GLSLstd450NMin);break;default:this.statement("// unimplemented GLSL op ",i)}},i.prototype.emit_header=function(){var e=this.get_entry_point(),t=this.options;100!==t.version&&this.statement("#version ",t.version,t.es&&t.version>100?" es":""),!t.es&&t.version<420&&(t.enable_420pack_extension&&(this.statement("#ifdef GL_ARB_shading_language_420pack"),this.statement("#extension GL_ARB_shading_language_420pack : require"),this.statement("#endif")),e.flags.get(Ee.ExecutionModeEarlyFragmentTests)&&this.require_extension_internal("GL_ARB_shader_image_load_store")),e.flags.get(Ee.ExecutionModePostDepthCoverage)&&this.require_extension_internal("GL_ARB_post_depth_coverage");var i=e.flags.get(Ee.ExecutionModePixelInterlockOrderedEXT)||e.flags.get(Ee.ExecutionModePixelInterlockUnorderedEXT)||e.flags.get(Ee.ExecutionModeSampleInterlockOrderedEXT)||e.flags.get(Ee.ExecutionModeSampleInterlockUnorderedEXT);if(i)if(t.es){if(t.version<310)throw new Error("At least ESSL 3.10 required for fragment shader interlock.");this.require_extension_internal("GL_NV_fragment_shader_interlock")}else t.version<420&&this.require_extension_internal("GL_ARB_shader_image_load_store"),this.require_extension_internal("GL_ARB_fragment_shader_interlock");for(var r=0,a=this.forced_extensions;r<a.length;r++){var o=a[r];"GL_EXT_shader_explicit_arithmetic_types_float16"===o?(this.statement("#if defined(GL_AMD_gpu_shader_half_float)"),this.statement("#extension GL_AMD_gpu_shader_half_float : require"),this.statement("#elif defined(GL_NV_gpu_shader5)"),this.statement("#extension GL_NV_gpu_shader5 : require"),this.statement("#else"),this.statement("#error No extension available for FP16."),this.statement("#endif")):"GL_EXT_shader_explicit_arithmetic_types_int16"===o?(this.statement("#if defined(GL_AMD_gpu_shader_int16)"),this.statement("#extension GL_AMD_gpu_shader_int16 : require"),this.statement("#elif defined(GL_NV_gpu_shader5)"),this.statement("#extension GL_NV_gpu_shader5 : require"),this.statement("#else"),this.statement("#error No extension available for Int16."),this.statement("#endif")):"GL_ARB_post_depth_coverage"===o?t.es?this.statement("#extension GL_EXT_post_depth_coverage : require"):(this.statement("#if defined(GL_ARB_post_depth_coverge)"),this.statement("#extension GL_ARB_post_depth_coverage : require"),this.statement("#else"),this.statement("#extension GL_EXT_post_depth_coverage : require"),this.statement("#endif")):/*!options.vulkan_semantics &&*/"GL_ARB_shader_draw_parameters"===o?(this.statement("#ifdef ",o),this.statement("#extension ",o," : enable"),this.statement("#endif")):"GL_EXT_control_flow_attributes"===o?(this.statement("#if defined(GL_EXT_control_flow_attributes)"),this.statement("#extension GL_EXT_control_flow_attributes : require"),this.statement("#define SPIRV_CROSS_FLATTEN [[flatten]]"),this.statement("#define SPIRV_CROSS_BRANCH [[dont_flatten]]"),this.statement("#define SPIRV_CROSS_UNROLL [[unroll]]"),this.statement("#define SPIRV_CROSS_LOOP [[dont_unroll]]"),this.statement("#else"),this.statement("#define SPIRV_CROSS_FLATTEN"),this.statement("#define SPIRV_CROSS_BRANCH"),this.statement("#define SPIRV_CROSS_UNROLL"),this.statement("#define SPIRV_CROSS_LOOP"),this.statement("#endif")):"GL_NV_fragment_shader_interlock"===o?(this.statement("#extension GL_NV_fragment_shader_interlock : require"),this.statement("#define SPIRV_Cross_beginInvocationInterlock() beginInvocationInterlockNV()"),this.statement("#define SPIRV_Cross_endInvocationInterlock() endInvocationInterlockNV()")):"GL_ARB_fragment_shader_interlock"===o?(this.statement("#ifdef GL_ARB_fragment_shader_interlock"),this.statement("#extension GL_ARB_fragment_shader_interlock : enable"),this.statement("#define SPIRV_Cross_beginInvocationInterlock() beginInvocationInterlockARB()"),this.statement("#define SPIRV_Cross_endInvocationInterlock() endInvocationInterlockARB()"),this.statement("#elif defined(GL_INTEL_fragment_shader_ordering)"),this.statement("#extension GL_INTEL_fragment_shader_ordering : enable"),this.statement("#define SPIRV_Cross_beginInvocationInterlock() beginFragmentShaderOrderingINTEL()"),this.statement("#define SPIRV_Cross_endInvocationInterlock()"),this.statement("#endif")):this.statement("#extension ",o," : require")}for(var s=0,n=this.header_lines;s<n.length;s++){var c=n[s];this.statement(c)}var _=[],p=[];switch(e.model){case Se.ExecutionModelVertex:t.ovr_multiview_view_count&&_.push("num_views = "+t.ovr_multiview_view_count);break;case Se.ExecutionModelFragment:if(t.es){switch(t.fragment.default_float_precision){case It.Lowp:this.statement("precision lowp float;");break;case It.Mediump:this.statement("precision mediump float;");break;case It.Highp:this.statement("precision highp float;")}switch(t.fragment.default_int_precision){case It.Lowp:this.statement("precision lowp int;");break;case It.Mediump:this.statement("precision mediump int;");break;case It.Highp:this.statement("precision highp int;")}}e.flags.get(Ee.ExecutionModeEarlyFragmentTests)&&_.push("early_fragment_tests"),e.flags.get(Ee.ExecutionModePostDepthCoverage)&&_.push("post_depth_coverage"),i&&this.statement("#if defined(GL_ARB_fragment_shader_interlock)"),e.flags.get(Ee.ExecutionModePixelInterlockOrderedEXT)?this.statement("layout(pixel_interlock_ordered) in;"):e.flags.get(Ee.ExecutionModePixelInterlockUnorderedEXT)?this.statement("layout(pixel_interlock_unordered) in;"):e.flags.get(Ee.ExecutionModeSampleInterlockOrderedEXT)?this.statement("layout(sample_interlock_ordered) in;"):e.flags.get(Ee.ExecutionModeSampleInterlockUnorderedEXT)&&this.statement("layout(sample_interlock_unordered) in;"),i&&(this.statement("#elif !defined(GL_INTEL_fragment_shader_ordering)"),this.statement("#error Fragment Shader Interlock/Ordering extension missing!"),this.statement("#endif")),!t.es&&e.flags.get(Ee.ExecutionModeDepthGreater)?this.statement("layout(depth_greater) out float gl_FragDepth;"):!t.es&&e.flags.get(Ee.ExecutionModeDepthLess)&&this.statement("layout(depth_less) out float gl_FragDepth;")}_.length>0&&this.statement("layout(",_.join(", "),") in;"),p.length>0&&this.statement("layout(",p.join(", "),") out;"),this.statement("")},i.prototype.emit_sampled_image_op=function(e,t,i,r){this.emit_op(e,t,this.to_combined_image_sampler(i,r),!0,!0),this.forwarded_temporaries.delete(t)},i.prototype.emit_texture_op=function(e,t){var i=this.stream(e),r=e.op,a=[],o=i[0],s=i[1],n=this.get(w,o),c={sparse_code_id:0,sparse_texel_id:0};t&&this.emit_sparse_feedback_temporaries(o,s,c);var _={value:!1},p=this.to_texture_op(e,t,_,a);t&&(this.statement(this.to_expression(c.sparse_code_id)," = ",p,";"),p=this.type_to_glsl(n)+"("+this.to_expression(c.sparse_code_id)+", "+this.to_expression(c.sparse_texel_id)+")",_.value=!0,a=[]),this.emit_op(o,s,p,_.value);for(var l=0,u=a;l<u.length;l++){var h=u[l];this.inherit_expression_dependencies(s,h)}switch(r){case ie.OpImageSampleDrefImplicitLod:case ie.OpImageSampleImplicitLod:case ie.OpImageSampleProjImplicitLod:case ie.OpImageSampleProjDrefImplicitLod:this.register_control_dependent_expression(s)}},i.prototype.to_texture_op=function(e,t,i,r){var a,o=this.stream(e),s=e.op,n=e.length,c=o[0],_=o[2],p=o[3],l=0,u=0,h=!1,d=!1,f=!1,m=!1,g=this.get(w,c),b=this.options,y=this.backend;switch(r.push(p),this.has_decoration(_,te.DecorationNonUniform)&&!this.maybe_get_backing_variable(_)&&(m=!0),s){case ie.OpImageSampleDrefImplicitLod:case ie.OpImageSampleDrefExplicitLod:case ie.OpImageSparseSampleDrefImplicitLod:case ie.OpImageSparseSampleDrefExplicitLod:l=o[4],a=5,n-=5;break;case ie.OpImageSampleProjDrefImplicitLod:case ie.OpImageSampleProjDrefExplicitLod:case ie.OpImageSparseSampleProjDrefImplicitLod:case ie.OpImageSparseSampleProjDrefExplicitLod:l=o[4],a=5,n-=5,d=!0;break;case ie.OpImageDrefGather:case ie.OpImageSparseDrefGather:if(l=o[4],a=5,n-=5,h=!0,b.es&&b.version<310)throw new Error("textureGather requires ESSL 310.");if(!b.es&&b.version<400)throw new Error("textureGather with depth compare requires GLSL 400.");break;case ie.OpImageGather:case ie.OpImageSparseGather:if(u=o[4],a=5,n-=5,h=!0,b.es&&b.version<310)throw new Error("textureGather requires ESSL 310.");if(!b.es&&b.version<400){if(!this.expression_is_constant_null(u))throw new Error("textureGather with component requires GLSL 400.");this.require_extension_internal("GL_ARB_texture_gather")}break;case ie.OpImageFetch:case ie.OpImageSparseFetch:case ie.OpImageRead:a=4,n-=4,f=!0;break;case ie.OpImageSampleProjImplicitLod:case ie.OpImageSampleProjExplicitLod:case ie.OpImageSparseSampleProjImplicitLod:case ie.OpImageSparseSampleProjExplicitLod:a=4,n-=4,d=!0;break;default:a=4,n-=4}var v=this.expression_type(_),S=this.get(w,v.self),I=0;switch(S.image.dim){case Ge.Dim1D:I=1;break;case Ge.Dim2D:I=2;break;case Ge.Dim3D:case Ge.DimCube:I=3;break;case Ge.DimBuffer:I=1;break;default:I=2}l&&r.push(l),d&&I++,S.image.arrayed&&I++;var x=0;n&&(x=o[a++],n--);var O=function(e,t){n&&x&t&&(e=o[a++],r.push(e),n--)};O(0,Dt.ImageOperandsBiasMask),O(0,Dt.ImageOperandsLodMask),O(0,Dt.ImageOperandsGradMask),O(0,Dt.ImageOperandsGradMask),O(0,Dt.ImageOperandsConstOffsetMask),O(0,Dt.ImageOperandsOffsetMask),O(0,Dt.ImageOperandsConstOffsetsMask),O(0,Dt.ImageOperandsSampleMask),O(0,Dt.ImageOperandsMinLodMask);var k=new At;k.img=_,k.imgtype=S,k.is_fetch=f,k.is_gather=h,k.is_proj=d;var L="",E=new Nt;E.base=k,E.has_array_offsets=!1,E.has_offset=!1,E.has_grad=!1,E.has_dref=0!==l,E.is_sparse_feedback=t,E.has_min_lod=!1,E.lod=0,L+=this.to_function_name(E),L+="(";var C=0;t&&(C=this.get_sparse_feedback_texel_id(o[1]));var T=new Pt;if(T.base=k,T.coord=p,T.coord_components=I,T.dref=l,T.grad_x=0,T.grad_y=0,T.lod=0,T.coffset=0,T.offset=0,T.bias=0,T.component=u,T.sample=0,T.sparse_texel=C,T.min_lod=0,T.nonuniform_expression=m,L+=this.to_function_args(T,i),L+=")",this.is_legacy()&&this.is_depth_image(S,_)&&(L+=".r"),y.comparison_image_samples_scalar&&function(e){switch(e){case ie.OpImageSampleExplicitLod:case ie.OpImageSampleImplicitLod:case ie.OpImageSampleProjExplicitLod:case ie.OpImageSampleProjImplicitLod:case ie.OpImageFetch:case ie.OpImageRead:case ie.OpImageSparseSampleExplicitLod:case ie.OpImageSparseSampleImplicitLod:case ie.OpImageSparseSampleProjExplicitLod:case ie.OpImageSparseSampleProjImplicitLod:case ie.OpImageSparseFetch:case ie.OpImageSparseRead:return!0;default:return!1}}(s)){var D=!1,R=this.maybe_get(se,_),M=R?R.image:_;(R&&this.is_depth_image(S,R.image)||this.is_depth_image(S,_))&&(D=!0);var B=this.maybe_get_backing_variable(M);B&&this.is_depth_image(this.get(w,B.basetype),B.self)&&(D=!0),D&&(L=this.remap_swizzle(g,1,L))}return!t&&!y.support_small_type_sampling_result&&g.width<32&&(L=this.type_to_glsl_constructor(g)+"("+L+")"),s===ie.OpImageRead&&(L=this.remap_swizzle(g,4,L)),L},i.prototype.emit_line_directive=function(e,t){this.redirect_statement||this.options.emit_line_directives&&(this.require_extension_internal("GL_GOOGLE_cpp_style_line_directive"),this.statement_no_indent("#line ",t,' "',this.get(_e,e).str,'"'))},i.prototype.emit_struct_member=function(e,t,i,r,a){void 0===r&&(r="");var o,s=this.get(w,t),n=this.ir,c=et(x,n.meta,e.self).members;o=i<c.length?c[i].decoration_flags:new y;var _="",p=et(x,n.meta,e.self).decoration.decoration_flags;(p.get(te.DecorationBlock)||p.get(te.DecorationBufferBlock))&&(_=this.to_interpolation_qualifiers(o)),this.statement(this.layout_for_member(e,i),_,r,this.flags_to_qualifiers_glsl(s,o),this.variable_decl(s,this.to_member_name(e,i)),";")},i.prototype.emit_struct_padding_target=function(e){},i.prototype.to_function_name=function(e){var t=this.options;if(e.has_min_lod){if(t.es)throw new Error("Sparse residency is not supported in ESSL.");this.require_extension_internal("GL_ARB_sparse_texture_clamp")}var i="",r=e.base.imgtype,a=e.base.img,o=!1;if((r.image.arrayed&&r.image.dim===Ge.Dim2D||r.image.dim===Ge.DimCube)&&this.is_depth_image(r,a)&&e.lod){if(!this.expression_is_constant_null(e.lod))throw new Error("textureLod on sampler2DArrayShadow is not constant 0.0. This cannot be expressed in GLSL.");o=!0}return e.is_sparse_feedback&&(i+="sparse"),e.base.is_fetch?i+=e.is_sparse_feedback?"TexelFetch":"texelFetch":(i+=e.is_sparse_feedback?"Texture":"texture",e.base.is_gather&&(i+="Gather"),e.has_array_offsets&&(i+="Offsets"),e.base.is_proj&&(i+="Proj"),(e.has_grad||o)&&(i+="Grad"),0===e.lod||o||(i+="Lod")),e.has_offset&&(i+="Offset"),e.has_min_lod&&(i+="Clamp"),(e.is_sparse_feedback||e.has_min_lod)&&(i+="ARB"),this.is_legacy()&&!e.base.is_gather?this.legacy_tex_op(i,r,a):i},i.prototype.to_function_args=function(e,t){var i,r=e.base.img,a=e.base.imgtype,o=this.backend;i=e.base.is_fetch?this.convert_separate_image_to_expression(r):this.to_non_uniform_aware_expression(r),e.nonuniform_expression&&i.indexOf("[")>=0&&(i=o.nonuniform_qualifier+"("+i+")");var s=o.swizzle_is_function,n=this.should_forward(e.coord),c=function(e,t){if(e===t)return"";switch(e){case 1:return".x";case 2:return s?".xy()":".xy";case 3:return s?".xyz()":".xyz";default:return""}}(e.coord_components,this.expression_type(e.coord).vecsize),_=""===c?this.to_expression(e.coord):this.to_enclosed_expression(e.coord)+c,p=this.expression_type(e.coord);if(p.basetype===L.UInt){var l=d(w,p);l.vecsize=e.coord_components,l.basetype=L.Int,_=this.bitcast_expression(l,p.basetype,_)}var u=(a.image.arrayed&&a.image.dim===Ge.Dim2D||a.image.dim===Ge.DimCube)&&this.is_depth_image(a,r)&&0!==e.lod;if(e.dref)if(n=n&&this.should_forward(e.dref),e.base.is_gather||4===e.coord_components)i+=", ",i+=this.to_expression(e.coord),i+=", ",i+=this.to_expression(e.dref);else if(e.base.is_proj)if(i+=", vec4(",a.image.dim===Ge.Dim1D)i+=this.to_enclosed_expression(e.coord)+".x",i+=", ",i+="0.0, ",i+=this.to_expression(e.dref),i+=", ",i+=this.to_enclosed_expression(e.coord)+".y)";else{if(a.image.dim!==Ge.Dim2D)throw new Error("Invalid type for textureProj with shadow.");i+=this.to_enclosed_expression(e.coord)+(s?".xy()":".xy"),i+=", ",i+=this.to_expression(e.dref),i+=", ",i+=this.to_enclosed_expression(e.coord)+".z)"}else{var h=d(w,this.expression_type(e.coord));h.vecsize=e.coord_components+1,i+=", ",i+=this.type_to_glsl_constructor(h),i+="(",i+=_,i+=", ",i+=this.to_expression(e.dref),i+=")"}else i+=", ",i+=_;if((e.grad_x||e.grad_y)&&(n=(n=n&&this.should_forward(e.grad_x))&&this.should_forward(e.grad_y),i+=", ",i+=this.to_expression(e.grad_x),i+=", ",i+=this.to_expression(e.grad_y)),e.lod)if(u)a.image.dim===Ge.Dim2D?i+=", vec2(0.0), vec2(0.0)":a.image.dim===Ge.DimCube&&(i+=", vec3(0.0), vec3(0.0)");else{n=n&&this.should_forward(e.lod),i+=", ";var f=this.expression_type(e.lod);e.base.is_fetch&&a.image.dim!==Ge.DimBuffer&&!a.image.ms&&f.basetype!==L.Int?i+="int("+this.to_expression(e.lod)+")":i+=this.to_expression(e.lod)}else e.base.is_fetch&&a.image.dim!==Ge.DimBuffer&&!a.image.ms&&(i+=", 0");(e.coffset?(n=n&&this.should_forward(e.coffset),i+=", ",i+=this.to_expression(e.coffset)):e.offset&&(n=n&&this.should_forward(e.offset),i+=", ",i+=this.to_expression(e.offset)),e.sample&&(i+=", ",i+=this.to_expression(e.sample)),e.min_lod&&(i+=", ",i+=this.to_expression(e.min_lod)),e.sparse_texel&&(i+=", ",i+=this.to_expression(e.sparse_texel)),e.bias&&(n=n&&this.should_forward(e.bias),i+=", ",i+=this.to_expression(e.bias)),e.component&&!this.expression_is_constant_null(e.component))&&(n=n&&this.should_forward(e.component),i+=", ",this.expression_type(e.component).basetype===L.Int?i+=this.to_expression(e.component):i+="int("+this.to_expression(e.component)+")");return t.value=n,i},i.prototype.emit_sparse_feedback_temporaries=function(e,t,i){if(this.options.es)throw new Error("Sparse texture feedback is not supported on ESSL.");this.require_extension_internal("GL_ARB_sparse_texture2");var r=et(0,this.extra_sub_expressions,t);0===r&&(r=this.ir.increase_bound_by(2),this.extra_sub_expressions[t]=r),i.sparse_code_id=r+0,i.sparse_texel_id=r+1;var a=this.get(w,e);if(a.basetype!==L.Struct||2!==a.member_types.length)throw new Error("Invalid return type for sparse feedback.");this.emit_uninitialized_temporary(a.member_types[0],i.sparse_code_id),this.emit_uninitialized_temporary(a.member_types[1],i.sparse_texel_id)},i.prototype.get_sparse_feedback_texel_id=function(e){return this.extra_sub_expressions[e]||0},i.prototype.emit_buffer_block=function(e){var t=this.get(w,e.basetype),i=e.storage===v.StorageClassUniform&&this.has_decoration(t.self,te.DecorationBlock),r=this.options,a=this.ir;this.flattened_buffer_blocks.has(e.self)?this.emit_buffer_block_flattened(e):this.is_legacy()||!r.es&&130===r.version||i&&r.emit_uniform_buffer_as_plain_uniforms?""===a.get_name(e.self)&&r.unnamed_ubo_to_global_uniforms?(this.emit_buffer_block_global(e),this.removed_structs.add(e.self)):this.emit_buffer_block_legacy(e):this.emit_buffer_block_native(e)},i.prototype.emit_push_constant_block=function(e){var t=this.options;this.flattened_buffer_blocks.has(e.self)?this.emit_buffer_block_flattened(e):t.emit_push_constant_as_uniform_buffer?this.emit_buffer_block_native(e):this.emit_push_constant_block_glsl(e)},i.prototype.emit_buffer_block_legacy=function(e){var t=this.get(w,e.basetype),i=this.ir,r=et(x,i.meta,t.self);if(e.storage===v.StorageClassStorageBuffer||r.decoration.decoration_flags.get(te.DecorationBufferBlock))throw new Error("SSBOs not supported in legacy targets.");var a=r.decoration.decoration_flags,o=a.get(te.DecorationBlock);a.clear(te.DecorationBlock),this.emit_struct(t),o&&a.set(te.DecorationBlock),this.emit_uniform(e),this.statement("")},i.prototype.emit_buffer_block_flattened=function(e){var t=this.get(w,e.basetype),i=this.to_name(t.self,!1),r=(this.get_declared_struct_size(t)+15)/16,a=this.get_common_basic_type(t);if(void 0===a)throw new Error("All basic types in a flattened block must be the same.");var o=new w;if(o.basetype=a,o.vecsize=4,a!==L.Float&&a!==L.Int&&a!==L.UInt)throw new Error("Basic types in a flattened UBO must be float, int or uint.");var s=this.ir.get_buffer_block_flags(e);this.statement("uniform ",this.flags_to_qualifiers_glsl(o,s),this.type_to_glsl(o)," ",i,"[",r,"];")},i.prototype.emit_flattened_io_block=function(e,t){var i=this.get(w,e.basetype);if(i.array.length>0)throw new Error("Array of varying structs cannot be flattened to legacy-compatible varyings.");var r=i.type_alias?this.get(w,i.type_alias):i,a=this.ir,o=et(x,a.meta,r.self).decoration,s=o.decoration_flags.clone();o.decoration_flags.set(te.DecorationBlock),r.member_name_cache.clear();var n=[];n.push(0);for(var c=this.to_name(e.self),_=0,p=0,l=r.member_types;p<l.length;p++){var u=l[p];this.add_member_name(r,_);var h=this.get(w,u);n[n.length-1]=_,h.basetype===L.Struct?this.emit_flattened_io_block_struct(c,r,t,n):this.emit_flattened_io_block_member(c,r,t,n),_++}o.decoration_flags=s,this.flattened_structs[e.self]=!0},i.prototype.emit_flattened_io_block_struct=function(e,t,i,r){var a=r.concat();a.push(0);for(var o=t,s=0,n=r;s<n.length;s++){var c=n[s];o=this.get(w,o.member_types[c])}if(console.assert(o.basetype===L.Struct),o.array.length>0)throw new Error("Cannot flatten array of structs in I/O blocks.");for(var _=0;_<o.member_types.length;_++)a[a.length-1]=_,this.get(w,o.member_types[_]).basetype===L.Struct?this.emit_flattened_io_block_struct(e,t,i,a):this.emit_flattened_io_block_member(e,t,i,a)},i.prototype.emit_flattened_io_block_member=function(e,t,i,r){for(var a=t.self,o=t,s=null,n=e,c=0,_=r;c<_.length;c++){var p=_[c];n+="_",n+=this.to_member_name(o,p),s=o,a=o.member_types[p],o=this.get(w,a)}console.assert(o.basetype!==L.Struct),s.type_alias&&(s=this.get(w,s.type_alias)),n=de.sanitize_underscores(n);var l=r[r.length-1];this.get_member_name(s.self,l);var u=this.to_member_name(s,l);this.set_member_name(s.self,l,n),this.emit_struct_member(s,a,l,i),this.set_member_name(s.self,l,u)},i.prototype.emit_block_chain=function(e){var i=this,r=!1,a=!1,o=!1,s=!1,n=!1,c=new Bt(this,"current_loop_level"),_=this.backend,p=this.ir;e.merge===M.MergeLoop&&this.add_loop_level(),this.emit_hoisted_temporaries(e.declare_temporary);var l=N.ContinueNone;e.continue_block&&(l=this.continue_block_type(this.get(J,e.continue_block)))===N.ComplexLoop&&(e.complex_continue=!0);for(var u=0,h=e.loop_variables;u<h.length;u++){var d=h[u];(g=this.get(E,d)).loop_variable_enable=!0,this.emit_variable_temporary_copies(g)}for(var f=[],m=0;m<e.dominated_variables.length;m++){d=e.dominated_variables[m];var g=this.get(E,d);f[m]=g.deferred_declaration}if(!this.is_legacy_es()&&this.block_is_loop_candidate(e,A.MergeToSelectContinueForLoop)?(this.flush_undeclared_variables(e),this.attempt_emit_loop_header(e,A.MergeToSelectContinueForLoop)&&(this.execution_is_noop(this.get(J,e.true_block),this.get(J,e.merge_block))?a=!0:r=!0,s=!0,n=!0)):this.block_is_loop_candidate(e,A.MergeToSelectForLoop)?(this.flush_undeclared_variables(e),this.attempt_emit_loop_header(e,A.MergeToSelectForLoop)&&(this.execution_is_noop(this.get(J,e.true_block),this.get(J,e.merge_block))?a=!0:r=!0,s=!0)):this.block_is_loop_candidate(e,A.MergeToDirectForLoop)?(this.flush_undeclared_variables(e),this.attempt_emit_loop_header(e,A.MergeToDirectForLoop)&&(o=!0,s=!0)):l===N.DoWhileLoop?(this.flush_undeclared_variables(e),this.emit_while_loop_initializers(e),s=!0,this.emit_hoisted_temporaries(e.potential_declare_temporary),this.statement("do"),this.begin_scope(),this.emit_block_instructions(e)):e.merge===M.MergeLoop?(this.flush_undeclared_variables(e),this.emit_while_loop_initializers(e),s=!0,this.get(J,e.continue_block).complex_continue=!0,l=N.ComplexLoop,this.emit_hoisted_temporaries(e.potential_declare_temporary),this.emit_block_hints(e),this.statement("for (;;)"),this.begin_scope(),this.emit_block_instructions(e)):this.emit_block_instructions(e),!s&&e.loop_variables.length>0){this.force_recompile();for(var b=0,y=e.loop_variables;b<y.length;b++){g=y[b];this.get(E,g).loop_variable=!1}e.loop_variables=[]}this.flush_undeclared_variables(e);var S=!0;switch(e.terminator){case R.Direct:e.loop_dominator===e.next_block?(this.branch(e.self,e.next_block),S=!1):o?S=!1:(this.is_continue(e.next_block)||this.is_break(e.next_block)||this.is_conditional(e.next_block))&&(this.branch(e.self,e.next_block),S=!1);break;case R.Select:if(r)if(n){console.assert(e.true_block===e.continue_block);var I=(me=this.get(J,e.continue_block)).complex_continue;me.complex_continue=!0,this.branch(e.self,e.true_block),me.complex_continue=I}else this.branch(e.self,e.true_block);else if(a)if(n){console.assert(e.false_block===e.continue_block);I=(me=this.get(J,e.continue_block)).complex_continue;me.complex_continue=!0,this.branch(e.self,e.false_block),me.complex_continue=I}else this.branch(e.self,e.false_block);else this.branch(e.self,e.condition,e.true_block,e.false_block);break;case R.MultiSelect:var x=(de=this.expression_type(e.condition)).basetype===L.UInt||de.basetype===L.UShort||de.basetype===L.UByte||de.basetype===L.UInt64;if(e.merge===M.MergeNone)throw new Error("Switch statement is not structured");if(!_.support_64bit_switch&&(de.basetype===L.UInt64||de.basetype===L.Int64))throw new Error("Cannot use 64-bit switch selectors.");var O="";de.basetype===L.UInt&&_.uint32_t_literal_suffix?O="u":de.basetype===L.Int64&&_.support_64bit_switch?O="l":de.basetype===L.UInt64&&_.support_64bit_switch?O="ul":de.basetype===L.UShort?O=_.uint16_t_literal_suffix:de.basetype===L.Short&&(O=_.int16_t_literal_suffix);var k=this.current_emitting_switch;this.current_emitting_switch=e,e.need_ladder_break&&this.statement("bool _",e.self,"_ladder_break = false;");for(var C=[],w=[],T=[],D=this.get_case_list(e),B=0,P=D;B<P.length;B++){var G=P[B];G.block!==e.next_block&&G.block!==e.default_block?(C.hasOwnProperty(G.block)||w.push(G.block),et(Array,C,G.block).push(G.value)):G.block===e.next_block&&e.default_block!==e.next_block&&T.push(G.value)}if(e.default_block!==e.next_block){var F=this.get(J,e.default_block),z=w.length,U=!1;for(m=0;m<z;m++){var V=this.get(J,w[m]);if(this.execution_is_direct_branch(V,F)){w.splice(m+1,0,e.default_block),U=!0;break}if(this.execution_is_direct_branch(F,V)){w.splice(m,0,e.default_block),U=!0;break}}if(U){if(this.is_legacy_es())throw new Error("Default case label fallthrough to other case label is not supported in ESSL 1.0.")}else w.push(e.default_block);C[e.default_block]=[]}var H=w.length,q=function(e,t,i){return le(i?e:t<=32?BigInt(Number(e)):BigInt(e))},K=function(e,t,r){for(var a="",o=t.length,s=0;s<o;s++)s&&(a+=" || "),a+=(o>1?"(":"")+i.to_enclosed_expression(e)+" === "+t[s]+r+(o>1?")":"");return a};for(m=1;_.support_case_fallthrough&&m<H;m++)if(this.flush_phi_required(e.self,w[m])&&this.flush_phi_required(w[m-1],w[m])){var X=w[m];if(this.get(J,X).ignore_phi_from_block=0,(re=C[X]).length){Q=[];for(var j=0,W=re;j<W.length;j++){ee=W[j];Q.push(this.to_enclosed_expression(e.condition)+" === "+q(ee,de.width,x))}this.statement("if (",Q.join(" || "),")"),this.begin_scope(),this.flush_phi(e.self,X),this.end_scope()}else{for(var Q=[],Y=0;Y<H;Y++)for(var Z=0,$=et(Array,C,w[Y]);Z<$.length;Z++){var ee=$[Z];Q.push(this.to_enclosed_expression(e.condition)+" !== "+q(ee,de.width,x))}this.statement("if (",Q.join(" && "),")"),this.begin_scope(),this.flush_phi(e.self,X),this.end_scope()}this.get(J,X).ignore_phi_from_block=e.self}var te=e.default_block!==e.merge_block&&!D.length;if(te||this.is_legacy_es())if(this.is_legacy_es()){var ie=this.statement_count;this.statement("for (int spvDummy",ie," = 0; spvDummy",ie," < 1; spvDummy",ie,"++)")}else this.statement("do");else this.emit_block_hints(e),this.statement("switch (",this.to_unpacked_expression(e.condition),")");this.begin_scope();for(m=0;m<H;m++){var re;if((re=C[X=w[m]]).length)if(this.is_legacy_es())this.statement(m?"else ":"","if (",K(e.condition,re,O),")");else for(var ae=0,oe=re;ae<oe.length;ae++){var se=oe[ae];this.statement("case ",q(se,de.width,x),O,":")}else te||(this.is_legacy_es()?this.statement("else"):this.statement("default:"));V=this.get(J,X);_.support_case_fallthrough&&m+1<H&&this.execution_is_direct_branch(V,this.get(J,w[m+1]))?this.current_emitting_switch_fallthrough=!0:this.current_emitting_switch_fallthrough=!1,te||this.begin_scope(),this.branch(e.self,X),te||this.end_scope(),this.current_emitting_switch_fallthrough=!1}var ne=this.flush_phi_required(e.self,e.next_block),ce=e.default_block===e.next_block||0!==T.length;if(ne&&ce||0!==T.length){for(var _e=0,pe=T;_e<pe.length;_e++){se=pe[_e];this.statement("case ",q(se,de.width,x),O,":")}e.default_block===e.next_block&&(this.is_legacy_es()?this.statement("else"):this.statement("default:")),this.begin_scope(),this.flush_phi(e.self,e.next_block),this.statement("break;"),this.end_scope()}te&&!this.is_legacy_es()?this.end_scope_decl("while(false)"):this.end_scope(),e.need_ladder_break&&(this.statement("if (_",e.self,"_ladder_break)"),this.begin_scope(),this.statement("break;"),this.end_scope()),this.current_emitting_switch=k;break;case R.Return:for(var ue=0,he=this.current_function.fixup_hooks_out;ue<he.length;ue++){(0,he[ue])()}this.processing_entry_point&&this.emit_fixup();var de,fe=this.get_cfg_for_current_function();if(e.return_value)(de=this.expression_type(e.return_value)).array.length&&!_.can_return_array?(p.ids[e.return_value].get_type()!==t.TypeUndef&&this.emit_array_copy("spvReturnValue",0,e.return_value,v.StorageClassFunction,this.get_expression_effective_storage_class(e.return_value)),fe.node_terminates_control_flow_in_sub_graph(this.current_function.entry_block,e.self)&&e.loop_dominator===J.NoDominator||this.statement("return;")):p.ids[e.return_value].get_type()!==t.TypeUndef&&this.statement("return ",this.to_unpacked_expression(e.return_value),";");else fe.node_terminates_control_flow_in_sub_graph(this.current_function.entry_block,e.self)&&e.loop_dominator===J.NoDominator||this.statement("return;");break;case R.Kill:this.statement(_.discard_literal,";"),e.return_value&&this.statement("return ",this.to_unpacked_expression(e.return_value),";");break;case R.Unreachable:S=!1;break;case R.IgnoreIntersection:this.statement("ignoreIntersectionEXT;");break;case R.TerminateRay:this.statement("terminateRayEXT;");break;default:throw new Error("Unimplemented block terminator.")}if(e.next_block&&S&&(e.merge!==M.MergeSelection&&(this.flush_phi(e.self,e.next_block),this.get(J,e.next_block).invalidate_expressions=e.invalidate_expressions),this.current_emitting_switch_fallthrough||(this.is_loop_break(e.next_block)?(console.assert(e.merge===M.MergeSelection),this.statement("break;")):this.is_continue(e.next_block)?(console.assert(e.merge===M.MergeSelection),this.branch_to_continue(e.self,e.next_block)):e.self!==e.next_block&&this.emit_block_chain(this.get(J,e.next_block)))),e.merge===M.MergeLoop){if(l===N.DoWhileLoop){var me=this.get(J,e.continue_block),ge=this.execution_is_noop(this.get(J,me.true_block),this.get(J,me.loop_dominator)),be=this.statement_count;this.emit_continue_block(e.continue_block,ge,!ge),this.statement_count!==be&&(this.get(J,e.continue_block).complex_continue=!0,this.force_recompile());var ye=this.to_expression(me.condition);ge||(ye="!"+this.enclose_expression(ye)),this.end_scope_decl("while ("+ye+")")}else this.end_scope();c.release(),this.is_continue(e.merge_block)?this.branch_to_continue(e.self,e.merge_block):this.emit_block_chain(this.get(J,e.merge_block))}e.invalidate_expressions=[],console.assert(f.length===e.dominated_variables.length);for(m=0;m<e.dominated_variables.length;m++){g=e.dominated_variables[m];this.get(E,g).deferred_declaration=f[m]}for(var ve=0,Se=e.loop_variables;ve<Se.length;ve++){d=Se[ve];this.get(E,d).loop_variable_enable=!1}c.release()},i.prototype.emit_hoisted_temporaries=function(e){e.sort((function(e,t){return e.second-t.second}));for(var t=this.ir,i=this.options,r=0,a=e;r<a.length;r++){var o=a[r];this.add_local_variable_name(o.second);var s=et(x,t.meta,o.second).decoration.decoration_flags,n=this.get(w,o.first),c="";i.force_zero_initialized_variables&&this.type_can_zero_initialize(n)&&(c=" = "+this.to_zero_initialized_expression(o.first)),this.statement(this.flags_to_qualifiers_glsl(n,s),this.variable_decl(n,this.to_name(o.second)),c,";"),this.hoisted_temporaries.add(o.second),this.forced_temporaries.add(o.second),this.set(oe,o.second,this.to_name(o.second),o.first,!0)}},i.prototype.emit_uniform=function(e){var t=this.get(w,e.basetype),i=this.options;if(t.basetype===L.Image&&2===t.image.sampled&&t.image.dim!==Ge.DimSubpassData)if(!i.es&&i.version<420)this.require_extension_internal("GL_ARB_shader_image_load_store");else if(i.es&&i.version<310)throw new Error("At least ESSL 3.10 required for shader image load store.");this.add_resource_name(e.self),this.statement(this.layout_for_variable(e),this.variable_decl(e),";")},i.prototype.unpack_expression_type=function(e,t,i,r,a){return e},i.prototype.builtin_translates_to_nonarray=function(e){return!1},i.prototype.emit_copy_logical_type=function(e,t,i,r,a){var o=this.get(w,t),s=this.get(w,r);if(o.array.length>0){var n=this.to_array_size_literal(o);a.push(0);for(var c=0;c<n;c++)a[a.length-1]=c,this.emit_copy_logical_type(e,o.parent_type,i,s.parent_type,a)}else if(o.basetype===L.Struct){a.push(0);var _=o.member_types.length;for(c=0;c<_;c++)a[a.length-1]=c,this.emit_copy_logical_type(e,o.member_types[c],i,s.member_types[c],a)}else{var p=new Tt,l=new Tt,u=this.access_chain_internal(e,a,0,a.length,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT,p),h=this.access_chain_internal(i,a,0,a.length,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT,l),d=this.ir.increase_bound_by(2);e=d,i=d+1,this.set(oe,e,u,t,!0).need_transpose=p.need_transpose,p.storage_is_packed&&this.set_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypePacked),0!==p.storage_physical_type&&this.set_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypeID,p.storage_physical_type),this.forwarded_temporaries.add(e),this.suppressed_usage_tracking.add(e),this.set(oe,i,h,r,!0).need_transpose=l.need_transpose,l.storage_is_packed&&this.set_extended_decoration(i,b.SPIRVCrossDecorationPhysicalTypePacked),0!==l.storage_physical_type&&this.set_extended_decoration(i,b.SPIRVCrossDecorationPhysicalTypeID,l.storage_physical_type),this.forwarded_temporaries.add(i),this.suppressed_usage_tracking.add(i),this.emit_store_statement(e,i)}},i.prototype.statement_inner=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0;i<e.length;++i)e[i],this.buffer.append(e[i]),this.statement_count++},i.prototype.type_to_glsl=function(e,t){if(void 0===t&&(t=0),e.pointer&&e.storage===v.StorageClassPhysicalStorageBufferEXT&&e.basetype!==L.Struct){for(var i=this.type_to_glsl(this.get_pointee_type(e)),r=0;r<e.array.length;r++)e.array_size_literal[r]?i+=e.array[r]+"_":i+="id".concat(e.array[r],'_"');return i+="Pointer"}var a=this.backend;switch(e.basetype){case L.Struct:return a.explicit_struct_type?"struct "+this.to_name(e.self):this.to_name(e.self);case L.Image:case L.SampledImage:return this.image_type_glsl(e,t);case L.Sampler:return this.comparison_ids.has(t)?"samplerShadow":"sampler";case L.AccelerationStructure:throw new Error("AccelerationStructure is not supported");case L.RayQuery:throw new Error("RayQuery is not supported");case L.Void:return"void"}if(e.basetype===L.UInt&&this.is_legacy())throw new Error("Unsigned integers are not supported on legacy targets.");if(1===e.vecsize&&1===e.columns)switch(e.basetype){case L.Boolean:return"bool";case L.SByte:return a.basic_int8_type;case L.UByte:return a.basic_uint8_type;case L.Short:return a.basic_int16_type;case L.UShort:return a.basic_uint16_type;case L.Int:return a.basic_int_type;case L.UInt:return a.basic_uint_type;case L.AtomicCounter:return"atomic_uint";case L.Half:return"float16_t";case L.Float:return"float";case L.Double:return"double";case L.Int64:return"int64_t";case L.UInt64:return"uint64_t";default:return"???"}else if(e.vecsize>1&&1===e.columns)switch(e.basetype){case L.Boolean:return"bvec"+e.vecsize;case L.SByte:return"i8vec"+e.vecsize;case L.UByte:return"u8vec"+e.vecsize;case L.Short:return"i16vec"+e.vecsize;case L.UShort:return"u16vec"+e.vecsize;case L.Int:return"ivec"+e.vecsize;case L.UInt:return"uvec"+e.vecsize;case L.Half:return"f16vec"+e.vecsize;case L.Float:return"vec"+e.vecsize;case L.Double:return"dvec"+e.vecsize;case L.Int64:return"i64vec"+e.vecsize;case L.UInt64:return"u64vec"+e.vecsize;default:return"???"}else if(e.vecsize===e.columns)switch(e.basetype){case L.Boolean:return"bmat"+e.vecsize;case L.Int:return"imat"+e.vecsize;case L.UInt:return"umat"+e.vecsize;case L.Half:return"f16mat"+e.vecsize;case L.Float:return"mat"+e.vecsize;case L.Double:return"dmat"+e.vecsize;default:return"???"}else switch(e.basetype){case L.Boolean:return"bmat".concat(e.columns,"x").concat(e.vecsize);case L.Int:return"imat".concat(e.columns,"x").concat(e.vecsize);case L.UInt:return"umat".concat(e.columns,"x").concat(e.vecsize);case L.Half:return"f16mat".concat(e.columns,"x").concat(e.vecsize);case L.Float:return"mat".concat(e.columns,"x").concat(e.vecsize);case L.Double:return"dmat".concat(e.columns,"x").concat(e.vecsize);default:return"???"}},i.prototype.builtin_to_glsl=function(e,t){var i=this.options;switch(e){case m.BuiltInPosition:return"gl_Position";case m.BuiltInPointSize:return"gl_PointSize";case m.BuiltInClipDistance:return"gl_ClipDistance";case m.BuiltInCullDistance:return"gl_CullDistance";case m.BuiltInVertexId:return"gl_VertexID";case m.BuiltInInstanceId:return!i.es&&i.version<140&&this.require_extension_internal("GL_ARB_draw_instanced"),"gl_InstanceID";case m.BuiltInVertexIndex:return"gl_VertexID";case m.BuiltInInstanceIndex:return!i.es&&i.version<140&&this.require_extension_internal("GL_ARB_draw_instanced"),i.vertex.support_nonzero_base_instance?(this.require_extension_internal("GL_ARB_shader_draw_parameters"),"(gl_InstanceID + SPIRV_Cross_BaseInstance)"):"gl_InstanceID";case m.BuiltInPrimitiveId:return t===v.StorageClassInput&&this.get_entry_point().model===Se.ExecutionModelGeometry?"gl_PrimitiveIDIn":"gl_PrimitiveID";case m.BuiltInInvocationId:return"gl_InvocationID";case m.BuiltInLayer:return"gl_Layer";case m.BuiltInViewportIndex:return"gl_ViewportIndex";case m.BuiltInTessLevelOuter:return"gl_TessLevelOuter";case m.BuiltInTessLevelInner:return"gl_TessLevelInner";case m.BuiltInTessCoord:return"gl_TessCoord";case m.BuiltInFragCoord:return"gl_FragCoord";case m.BuiltInPointCoord:return"gl_PointCoord";case m.BuiltInFrontFacing:return"gl_FrontFacing";case m.BuiltInFragDepth:return"gl_FragDepth";case m.BuiltInNumWorkgroups:return"gl_NumWorkGroups";case m.BuiltInWorkgroupSize:return"gl_WorkGroupSize";case m.BuiltInWorkgroupId:return"gl_WorkGroupID";case m.BuiltInLocalInvocationId:return"gl_LocalInvocationID";case m.BuiltInGlobalInvocationId:return"gl_GlobalInvocationID";case m.BuiltInLocalInvocationIndex:return"gl_LocalInvocationIndex";case m.BuiltInHelperInvocation:return"gl_HelperInvocation";case m.BuiltInBaseVertex:if(i.es)throw new Error("BaseVertex not supported in ES profile.");return this.require_extension_internal("GL_ARB_shader_draw_parameters"),"SPIRV_Cross_BaseVertex";case m.BuiltInBaseInstance:if(i.es)throw new Error("BaseInstance not supported in ES profile.");return this.require_extension_internal("GL_ARB_shader_draw_parameters"),"SPIRV_Cross_BaseInstance";case m.BuiltInDrawIndex:if(i.es)throw new Error("DrawIndex not supported in ES profile.");return this.require_extension_internal("GL_ARB_shader_draw_parameters"),"gl_DrawIDARB";case m.BuiltInSampleId:if(i.es&&i.version<320&&this.require_extension_internal("GL_OES_sample_variables"),!i.es&&i.version<400)throw new Error("gl_SampleID not supported before GLSL 400.");return"gl_SampleID";case m.BuiltInSampleMask:if(i.es&&i.version<320&&this.require_extension_internal("GL_OES_sample_variables"),!i.es&&i.version<400)throw new Error("gl_SampleMask/gl_SampleMaskIn not supported before GLSL 400.");return t===v.StorageClassInput?"gl_SampleMaskIn":"gl_SampleMask";case m.BuiltInSamplePosition:if(i.es&&i.version<320&&this.require_extension_internal("GL_OES_sample_variables"),!i.es&&i.version<400)throw new Error("gl_SamplePosition not supported before GLSL 400.");return"gl_SamplePosition";case m.BuiltInViewIndex:return"gl_ViewID_OVR";case m.BuiltInNumSubgroups:case m.BuiltInSubgroupId:case m.BuiltInSubgroupSize:case m.BuiltInSubgroupLocalInvocationId:case m.BuiltInSubgroupEqMask:case m.BuiltInSubgroupGeMask:case m.BuiltInSubgroupGtMask:case m.BuiltInSubgroupLeMask:case m.BuiltInSubgroupLtMask:throw new Error("Subgroups not supported");case m.BuiltInLaunchIdKHR:case m.BuiltInLaunchSizeKHR:case m.BuiltInWorldRayOriginKHR:case m.BuiltInWorldRayDirectionKHR:case m.BuiltInObjectRayOriginKHR:case m.BuiltInObjectRayDirectionKHR:case m.BuiltInRayTminKHR:case m.BuiltInRayTmaxKHR:case m.BuiltInInstanceCustomIndexKHR:case m.BuiltInObjectToWorldKHR:case m.BuiltInWorldToObjectKHR:case m.BuiltInHitTNV:case m.BuiltInHitKindKHR:case m.BuiltInIncomingRayFlagsKHR:throw new Error("Raytracing not supported");case m.BuiltInBaryCoordNV:if(i.es&&i.version<320)throw new Error("gl_BaryCoordNV requires ESSL 320.");if(!i.es&&i.version<450)throw new Error("gl_BaryCoordNV requires GLSL 450.");return this.require_extension_internal("GL_NV_fragment_shader_barycentric"),"gl_BaryCoordNV";case m.BuiltInBaryCoordNoPerspNV:if(i.es&&i.version<320)throw new Error("gl_BaryCoordNoPerspNV requires ESSL 320.");if(!i.es&&i.version<450)throw new Error("gl_BaryCoordNoPerspNV requires GLSL 450.");return this.require_extension_internal("GL_NV_fragment_shader_barycentric"),"gl_BaryCoordNoPerspNV";case m.BuiltInFragStencilRefEXT:if(i.es)throw new Error("Stencil export not supported in GLES.");return this.require_extension_internal("GL_ARB_shader_stencil_export"),"gl_FragStencilRefARB";case m.BuiltInPrimitiveShadingRateKHR:throw new Error("Can only use PrimitiveShadingRateKHR in Vulkan GLSL.");case m.BuiltInShadingRateKHR:throw new Error("Can only use ShadingRateKHR in Vulkan GLSL.");case m.BuiltInDeviceIndex:throw new Error("Need Vulkan semantics for device group support.");case m.BuiltInFullyCoveredEXT:if(i.es)throw new Error("Need desktop GL to use GL_NV_conservative_raster_underestimation.");return this.require_extension_internal("GL_NV_conservative_raster_underestimation"),"gl_FragFullyCoveredNV";default:return"gl_BuiltIn_"+le(e)}},i.prototype.image_type_glsl=function(e,t){void 0===t&&(t=0);var i="";switch(this.get(w,e.image.type).basetype){case L.Int:case L.Short:case L.SByte:i="i";break;case L.UInt:case L.UShort:case L.UByte:i="u"}var r=this.options;if(e.basetype===L.Image&&e.image.dim===Ge.DimSubpassData&&this.subpass_input_is_framebuffer_fetch(t)){var a=d(w,this.get(w,e.image.type));return a.vecsize=4,this.type_to_glsl(a)}switch(e.basetype===L.Image&&e.image.dim!==Ge.DimSubpassData?e.image.dim===Ge.DimBuffer&&1===e.image.sampled?i+="sampler":i+=2===e.image.sampled?"image":"texture":i+="sampler",e.image.dim){case Ge.Dim1D:i+="1D";break;case Ge.Dim2D:i+="2D";break;case Ge.Dim3D:i+="3D";break;case Ge.DimCube:i+="Cube";break;case Ge.DimRect:if(r.es)throw new Error("Rectangle textures are not supported on OpenGL ES.");this.is_legacy_desktop()&&this.require_extension_internal("GL_ARB_texture_rectangle"),i+="2DRect";break;case Ge.DimBuffer:r.es&&r.version<320?this.require_extension_internal("GL_EXT_texture_buffer"):!r.es&&r.version<300&&this.require_extension_internal("GL_EXT_texture_buffer_object"),i+="Buffer";break;case Ge.DimSubpassData:i+="2D";break;default:throw new Error("Only 1D, 2D, 2DRect, 3D, Buffer, InputTarget and Cube textures supported.")}return e.image.ms&&(i+="MS"),e.image.arrayed&&(this.is_legacy_desktop()&&this.require_extension_internal("GL_EXT_texture_array"),i+="Array"),e.basetype!==L.SampledImage&&e.basetype!==L.Sampler||!this.is_depth_image(e,t)||(i+="Shadow"),i},i.prototype.constant_expression=function(e){var t=this.get(w,e.constant_type),i=this.backend;if(t.pointer)return i.null_pointer_literal;if(e.subconstants.length>0){var r=void 0,a=!1;i.use_initializer_list&&i.use_typed_initializer_list&&t.basetype===L.Struct&&0===t.array.length?r=this.type_to_glsl_constructor(t)+"{ ":i.use_initializer_list&&i.use_typed_initializer_list&&i.array_is_value_type&&t.array.length>0?(r=this.type_to_glsl_constructor(t)+"({ ",a=!0):r=i.use_initializer_list?"{ ":this.type_to_glsl_constructor(t)+"(";for(var o=0;o<e.subconstants.length;++o){var s=e.subconstants[o],n=this.get(U,s);n.specialization?r+=this.to_name(s):r+=this.constant_expression(n),o!==e.subconstants.length-1&&(r+=", ")}return r+=i.use_initializer_list?" }":")",a&&(r+=")"),r}if(t.basetype===L.Struct&&0===t.member_types.length)return i.supports_empty_struct?"{ }":i.use_typed_initializer_list?this.type_to_glsl(this.get(w,e.constant_type))+"{ 0 }":i.use_initializer_list?"{ 0 }":this.type_to_glsl(this.get(w,e.constant_type))+"(0)";if(1===e.columns())return this.constant_expression_vector(e,0);r=this.type_to_glsl(this.get(w,e.constant_type))+"(";for(var c=0;c<e.columns();c++)0!==e.specialization_constant_id(c)?r+=this.to_name(e.specialization_constant_id(c)):r+=this.constant_expression_vector(e,c),c+1<e.columns()&&(r+=", ");return r+=")"},i.prototype.constant_op_expression=function(e){var t=this.get(w,e.basetype),i=!1,r=!1,a="";if(this.is_legacy()&&function(e){switch(e){case ie.OpShiftRightLogical:case ie.OpUGreaterThan:case ie.OpUGreaterThanEqual:case ie.OpULessThan:case ie.OpULessThanEqual:case ie.OpUConvert:case ie.OpUDiv:case ie.OpUMod:case ie.OpUMulExtended:case ie.OpConvertUToF:case ie.OpConvertFToU:return!0;default:return!1}}(e.opcode))throw new Error("Unsigned integers are not supported on legacy targets.");switch(e.opcode){case ie.OpSConvert:case ie.OpUConvert:case ie.OpFConvert:a=this.type_to_glsl_constructor(t);break;case ie.OpSNegate:case ie.OpNot:case ie.OpLogicalNot:r=!0,a=zt[e.opcode];break;case ie.OpIAdd:case ie.OpISub:case ie.OpIMul:case ie.OpSDiv:case ie.OpUDiv:case ie.OpUMod:case ie.OpSMod:case ie.OpShiftRightLogical:case ie.OpShiftRightArithmetic:case ie.OpShiftLeftLogical:case ie.OpBitwiseOr:case ie.OpBitwiseXor:case ie.OpBitwiseAnd:case ie.OpLogicalOr:case ie.OpLogicalAnd:case ie.OpLogicalEqual:case ie.OpLogicalNotEqual:case ie.OpIEqual:case ie.OpINotEqual:case ie.OpULessThan:case ie.OpSLessThan:case ie.OpULessThanEqual:case ie.OpSLessThanEqual:case ie.OpUGreaterThan:case ie.OpSGreaterThan:case ie.OpUGreaterThanEqual:case ie.OpSGreaterThanEqual:i=!0,a=zt[e.opcode];break;case ie.OpSRem:var o=e.arguments[0],s=e.arguments[1];return this.to_enclosed_expression(o),this.to_enclosed_expression(s),this.to_enclosed_expression(o)+" / "+this.to_enclosed_expression(s)+")";case ie.OpSelect:if(e.arguments.length<3)throw new Error("Not enough arguments to OpSpecConstantOp.");var n=this.to_trivial_mix_op(t,e.arguments[2],e.arguments[1],e.arguments[0]);if(!n)return this.to_ternary_expression(t,e.arguments[0],e.arguments[1],e.arguments[2]);a=n;break;case ie.OpVectorShuffle:var c=this.type_to_glsl_constructor(t);c+="(";for(var _=this.expression_type(e.arguments[0]).vecsize,p=this.to_enclosed_expression(e.arguments[0]),l=this.to_enclosed_expression(e.arguments[1]),u=2;u<e.arguments.length;u++){var h=e.arguments[u];c+=h>=_?l+"."+"xyzw"[h-_]:p+"."+"xyzw"[h],u+1<e.arguments.length&&(c+=", ")}return c+=")";case ie.OpCompositeExtract:return c=this.access_chain_internal(e.arguments[0],e.arguments,1,e.arguments.length-1,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT,null);case ie.OpCompositeInsert:throw new Error("OpCompositeInsert spec constant op is not supported.");default:throw new Error("Unimplemented spec constant op.")}var d,f=0;(r||i||e.opcode===ie.OpSConvert||e.opcode===ie.OpUConvert)&&(f=this.expression_type(e.arguments[0]).width);var m=yt(e.opcode);switch(e.opcode){case ie.OpIEqual:case ie.OpINotEqual:case ie.OpSLessThan:case ie.OpSLessThanEqual:case ie.OpSGreaterThan:case ie.OpSGreaterThanEqual:case ie.OpSMod:case ie.OpSDiv:case ie.OpShiftRightArithmetic:case ie.OpSConvert:case ie.OpSNegate:d=vt(f);break;case ie.OpULessThan:case ie.OpULessThanEqual:case ie.OpUGreaterThan:case ie.OpUGreaterThanEqual:case ie.OpUMod:case ie.OpUDiv:case ie.OpShiftRightLogical:case ie.OpUConvert:d=St(f);break;default:d=t.basetype}if(i){if(e.arguments.length<2)throw new Error("Not enough arguments to OpSpecConstantOp.");var g={cast_op0:"",cast_op1:"",input_type:d},b=this.binary_op_bitcast_helper(g,e.arguments[0],e.arguments[1],m);if(d=g.input_type,t.basetype!==d&&t.basetype!==L.Boolean){b.basetype=d;c=this.bitcast_glsl_op(t,b);return c+="("+g.cast_op0+" "+a+" "+g.cast_op1+")"}return"("+g.cast_op0+" "+a+" "+g.cast_op1+")"}if(r){if(e.arguments.length<1)throw new Error("Not enough arguments to OpSpecConstantOp.");return"("+a+this.bitcast_glsl(t,e.arguments[0])+")"}if(e.opcode===ie.OpSConvert||e.opcode===ie.OpUConvert){if(e.arguments.length<1)throw new Error("Not enough arguments to OpSpecConstantOp.");var y=this.expression_type(e.arguments[0]);if(y.width<t.width&&d!==y.basetype){var v=y;return v.basetype=d,a+"("+this.bitcast_glsl(v,e.arguments[0])+")"}return a+"("+this.to_expression(e.arguments[0])+")"}if(e.arguments.length<1)throw new Error("Not enough arguments to OpSpecConstantOp.");return a+"("+this.to_expression(e.arguments[0])+")"},i.prototype.constant_expression_vector=function(e,t){var i=d(w,this.get(w,e.constant_type));i.columns=1;var r=d(w,i);r.vecsize=1;var a=this.backend,o="",s=a.use_constructor_splatting&&e.vector_size()>1,n=a.can_swizzle_scalar&&e.vector_size()>1;if(gt(i)||(n=!1),s||n)for(var c=0;c<e.vector_size();c++)if(0!==e.specialization_constant_id(t,c)){s=!1,n=!1;break}if(s||n)if(64===i.width){var _=e.scalar_u64(t,0);for(c=1;c<e.vector_size();c++)if(_!==e.scalar_u64(t,c)){s=!1,n=!1;break}}else for(_=e.scalar(t,0),c=1;c<e.vector_size();c++)_!==e.scalar(t,c)&&(s=!1,n=!1);switch(e.vector_size()>1&&!n&&(o+=this.type_to_glsl(i)+"("),i.basetype){case L.Half:if(s||n)o+=this.convert_half_to_string(e,t,0),n&&(o=this.remap_swizzle(this.get(w,e.constant_type),1,o));else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):o+=this.convert_half_to_string(e,t,c),c+1<e.vector_size()&&(o+=", ");break;case L.Float:if(s||n)o+=this.convert_float_to_string(e,t,0),n&&(o=this.remap_swizzle(this.get(w,e.constant_type),1,o));else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):o+=this.convert_float_to_string(e,t,c),c+1<e.vector_size()&&(o+=", ");break;case L.Double:if(s||n)o+=this.convert_double_to_string(e,t,0),n&&(o=this.remap_swizzle(this.get(w,e.constant_type),1,o));else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):o+=this.convert_double_to_string(e,t,c),c+1<e.vector_size()&&(o+=", ");break;case L.Int64:var p=i;p.vecsize=1,p.columns=1;var l=this.type_to_glsl(p);if(s)o+=le(e.scalar_i64(t,0),l,a.long_long_literal_suffix);else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):o+=le(e.scalar_i64(t,c),l,a.long_long_literal_suffix),c+1<e.vector_size()&&(o+=", ");break;case L.UInt64:if(s)o+=le(e.scalar_u64(t,0)),a.long_long_literal_suffix?o+="ull":o+="ul";else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):(o+=le(e.scalar_u64(t,c)),a.long_long_literal_suffix?o+="ull":o+="ul"),c+1<e.vector_size()&&(o+=", ");break;case L.UInt:if(s)if(o+=le(e.scalar(t,0)),this.is_legacy()){if(e.scalar_i32(t,0)<0)throw new Error("Tried to convert uint literal into int, but this made the literal negative.")}else a.uint32_t_literal_suffix&&(o+="u");else for(c=0;c<e.vector_size();c++){if(e.vector_size()>1&&0!==e.specialization_constant_id(t,c))o+=this.to_expression(e.specialization_constant_id(t,c));else if(o+=le(e.scalar(t,c)),this.is_legacy()){if(e.scalar_i32(t,c)<0)throw new Error("Tried to convert uint literal into int, but this made the literal negative.")}else a.uint32_t_literal_suffix&&(o+="u");c+1<e.vector_size()&&(o+=", ")}break;case L.Int:if(s)o+=le(e.scalar_i32(t,0));else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):o+=le(e.scalar_i32(t,c)),c+1<e.vector_size()&&(o+=", ");break;case L.UShort:if(s)o+=le(e.scalar(t,0));else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):""!==a.uint16_t_literal_suffix?(o+=le(e.scalar_u16(t,c)),o+=a.uint16_t_literal_suffix):(o+=this.type_to_glsl(r),o+="(",o+=le(e.scalar_u16(t,c)),o+=")"),c+1<e.vector_size()&&(o+=", ");break;case L.Short:if(s)o+=le(e.scalar_i16(t,0));else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):""!==a.int16_t_literal_suffix?(o+=le(e.scalar_i16(t,c)),o+=a.int16_t_literal_suffix):(o+=this.type_to_glsl(r),o+="(",o+=le(e.scalar_i16(t,c)),o+=")"),c+1<e.vector_size()&&(o+=", ");break;case L.UByte:if(s)o+=le(e.scalar_u8(t,0));else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):(o+=this.type_to_glsl(r),o+="(",o+=le(e.scalar_u8(t,c)),o+=")"),c+1<e.vector_size()&&(o+=", ");break;case L.SByte:if(s)o+=le(e.scalar_i8(t,0));else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):(o+=this.type_to_glsl(r),o+="(",o+=le(e.scalar_i8(t,c)),o+=")"),c+1<e.vector_size()&&(o+=", ");break;case L.Boolean:if(s)o+=e.scalar(t,0)?"true":"false";else for(c=0;c<e.vector_size();c++)e.vector_size()>1&&0!==e.specialization_constant_id(t,c)?o+=this.to_expression(e.specialization_constant_id(t,c)):o+=e.scalar(t,c)?"true":"false",c+1<e.vector_size()&&(o+=", ");break;default:throw new Error("Invalid constant expression basetype.")}return e.vector_size()>1&&!n&&(o+=")"),o},i.prototype.statement=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.is_forcing_recompilation())this.statement_count++;else if(this.redirect_statement)this.redirect_statement.push(e.join("")),this.statement_count++;else{for(var i=0;i<this.indent;i++)this.buffer.append("   ");this.statement_inner.apply(this,e),this.buffer.append("\n")}},i.prototype.statement_no_indent=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.indent;this.indent=0,this.statement.apply(this,e),this.indent=i},i.prototype.begin_scope=function(){this.statement("{"),this.indent++},i.prototype.end_scope=function(e){if(!this.indent)throw new Error("Popping empty indent stack.");this.indent--,e?this.statement("}",e):this.statement("}")},i.prototype.end_scope_decl=function(e){if(!this.indent)throw new Error("Popping empty indent stack.");this.indent--,e?this.statement("} ",e,";"):this.statement("};")},i.prototype.add_resource_name=function(e){var t=et(x,this.ir.meta,e).decoration;t.alias=this.add_variable(this.resource_names,this.block_names,t.alias)},i.prototype.add_local_variable_name=function(e){var t=et(x,this.ir.meta,e).decoration;t.alias=this.add_variable(this.local_variable_names,this.block_names,t.alias)},i.prototype.add_member_name=function(e,t){var i=et(x,this.ir.meta,e.self).members;if(t<i.length&&""!==i[t].alias){var r=i[t].alias;if(""===r)return;r=de.sanitize_identifier(r,!0,!0),r=this.update_name_cache(e.member_name_cache,r),i[t].alias=r}},i.prototype.type_to_array_glsl=function(e){if(e.pointer&&e.storage===v.StorageClassPhysicalStorageBufferEXT&&e.basetype!==L.Struct)return"";if(0===e.array.length)return"";var t=this.options;if(t.flatten_multidimensional_arrays){var i="";i+="[";for(var r=e.array.length;r;r--)i+=this.enclose_expression(this.to_array_size(e,r-1)),r>1&&(i+=" * ");return i+="]"}if(e.array.length>1)if(!t.es&&t.version<430)this.require_extension_internal("GL_ARB_arrays_of_arrays");else if(t.es&&t.version<310)throw new Error("Arrays of arrays not supported before ESSL version 310. Try using --flatten-multidimensional-arrays or set options.flatten_multidimensional_arrays to true.");for(i="",r=e.array.length;r;r--)i+="[",i+=this.to_array_size(e,r-1),i+="]";return i},i.prototype.add_function_overload=function(e){for(var t=new Mt,i=0,r=e.arguments;i<r.length;i++){var a=r[i],o=this.get_pointee_type_id(a.type),s=this.get(w,o);this.combined_image_samplers.length&&(s.basetype===L.SampledImage||s.basetype===L.Image&&1===s.image.sampled||s.basetype===L.Sampler)||t.u32(o)}var n=t.get(),c=this.to_name(e.self),_=this.function_overloads[c];if(_){var p=_;p.has(n)?(this.add_resource_name(e.self),et(Set,this.function_overloads,this.to_name(e.self)).add(n)):p.add(n)}else this.add_resource_name(e.self),et(Set,this.function_overloads,this.to_name(e.self)).add(n)},i.prototype.to_array_size=function(e,t){console.assert(e.array.length===e.array_size_literal.length);var i=e.array[t];return e.array_size_literal[t]?i?le(i):this.backend.unsized_array_supported?"":"1":this.to_expression(i)},i.prototype.to_array_size_literal=function(e,t){return void 0===t&&(t=e.array.length-1),console.assert(e.array.length===e.array_size_literal.length),e.array_size_literal[t]?e.array[t]:this.evaluate_constant_u32(e.array[t])},i.prototype.emit_fixup=function(){if(this.is_vertex_like_shader()){if(this.options.vertex.fixup_clipspace){var e=this.backend.float_literal_suffix?"f":"";this.statement("gl_Position.z = 2.0",e," * gl_Position.z - gl_Position.w;")}this.options.vertex.flip_vert_y&&this.statement("gl_Position.y = -gl_Position.y;")}},i.prototype.variable_decl=function(e,i,r){if(void 0===r&&(r=0),e instanceof w){var a=e,o=this.type_to_glsl(a,r);return(o=this.remap_variable_type_name(a,i,o))+" "+i+this.type_to_array_glsl(a)}var s=this.get_variable_data_type(e);if(s.pointer_depth>1&&!this.backend.support_pointer_to_pointer)throw new Error("Cannot declare pointer-to-pointer types.");var n=this.options,c=this.ir,_=this.to_qualifiers_glsl(e.self)+this.variable_decl(s,this.to_name(e.self),e.self);if(e.loop_variable&&e.static_expression){var p=e.static_expression;c.ids[p].get_type()!==t.TypeUndef?_+=" = "+this.to_unpacked_expression(e.static_expression):n.force_zero_initialized_variables&&this.type_can_zero_initialize(s)&&(_+=" = "+this.to_zero_initialized_expression(this.get_variable_data_type_id(e)))}else if(e.initializer&&!this.variable_decl_is_remapped_storage(e,v.StorageClassWorkgroup)){p=e.initializer;c.ids[p].get_type()!==t.TypeUndef?_+=" = "+this.to_initializer_expression(e):n.force_zero_initialized_variables&&this.type_can_zero_initialize(s)&&(_+=" = "+this.to_zero_initialized_expression(this.get_variable_data_type_id(e)))}return _},i.prototype.variable_decl_function_local=function(e){var t=e.storage;e.storage=v.StorageClassFunction;var i=this.variable_decl(e);return e.storage=t,i},i.prototype.variable_decl_is_remapped_storage=function(e,t){return e.storage===t},i.prototype.to_func_call_arg=function(e,t){var i=t,r=this.maybe_get(E,t);return r&&r.basevariable&&(i=r.basevariable),this.to_expression(i)},i.prototype.is_non_native_row_major_matrix=function(e){if(this.backend.native_row_major_matrix&&!this.is_legacy())return!1;var t=this.maybe_get(oe,e);return t?t.need_transpose:this.has_decoration(e,te.DecorationRowMajor)},i.prototype.member_is_non_native_row_major_matrix=function(e,t){if(this.backend.native_row_major_matrix&&!this.is_legacy())return!1;if(!this.has_member_decoration(e.self,t,te.DecorationRowMajor))return!1;var i=this.get(w,e.member_types[t]);if(i.columns!==i.vecsize)throw new Error("Row-major matrices must be square on this platform.");return!0},i.prototype.member_is_remapped_physical_type=function(e,t){return this.has_extended_member_decoration(e.self,t,b.SPIRVCrossDecorationPhysicalTypeID)},i.prototype.member_is_packed_physical_type=function(e,t){return this.has_extended_member_decoration(e.self,t,b.SPIRVCrossDecorationPhysicalTypePacked)},i.prototype.convert_row_major_matrix=function(e,t,i,r){if(e=this.strip_enclosed_expression(e),this.is_matrix(t)){if(this.options.version<120){if(2===t.vecsize&&2===t.columns)this.requires_transpose_2x2||(this.requires_transpose_2x2=!0,this.force_recompile());else if(3===t.vecsize&&3===t.columns)this.requires_transpose_3x3||(this.requires_transpose_3x3=!0,this.force_recompile());else{if(4!==t.vecsize||4!==t.columns)throw new Error("Non-square matrices are not supported in legacy GLSL, cannot transpose.");this.requires_transpose_4x4||(this.requires_transpose_4x4=!0,this.force_recompile())}return"spvTranspose(".concat(e,")")}return"transpose(".concat(e,")")}var a=e.lastIndexOf("[");if(-1===a)return e;var o=e.substring(a);e=e.substring(0,a);for(var s=this.type_to_glsl_constructor(t)+"(",n=0;n<t.vecsize;n++)s+="".concat(e,"[").concat(n,"]").concat(o),n+1<t.vecsize&&(s+=", ");return s+=")"},i.prototype.preserve_alias_on_reset=function(e){this.preserved_aliases[e]=this.get_name(e)},i.prototype.reset_name_caches=function(){var e=this;this.preserved_aliases.forEach((function(t,i){return e.set_name(i,t)})),this.preserved_aliases=[],this.resource_names.clear(),this.block_input_names.clear(),this.block_output_names.clear(),this.block_ubo_names.clear(),this.block_ssbo_names.clear(),this.block_names.clear(),this.function_overloads={}},i.prototype.emit_struct=function(e){if(0===e.type_alias||this.has_extended_decoration(e.type_alias,b.SPIRVCrossDecorationBufferBlockRepacked)){this.add_resource_name(e.self);var t=this.type_to_glsl(e),i=this.backend;this.statement(i.explicit_struct_type?"":"struct ",t),this.begin_scope(),e.member_name_cache.clear();for(var r=0,a=!1,o=0,s=e.member_types;o<s.length;o++){var n=s[o];this.add_member_name(e,r),this.emit_struct_member(e,n,r),r++,a=!0}this.type_is_empty(e)&&!i.supports_empty_struct&&(this.statement("int empty_struct_member;"),a=!0),this.has_extended_decoration(e.self,b.SPIRVCrossDecorationPaddingTarget)&&this.emit_struct_padding_target(e),this.end_scope_decl(),a&&this.statement("")}},i.prototype.emit_resources=function(){var e=this,i=this.get_entry_point(),r=this.options,a=this.ir;if(this.replace_illegal_names(),i.model===Se.ExecutionModelFragment&&this.is_legacy()&&this.replace_fragment_outputs(),(this.pls_inputs.length>0||this.pls_outputs.length>0)&&this.emit_pls(),r.separate_shader_objects&&!r.es&&i.model!==Se.ExecutionModelFragment){if(i.model===Se.ExecutionModelVertex)this.emit_declared_builtin_block(v.StorageClassOutput,i.model)}else if(this.should_force_emit_builtin_block(v.StorageClassOutput))this.emit_declared_builtin_block(v.StorageClassOutput,i.model);else if(i.geometry_passthrough)this.emit_declared_builtin_block(v.StorageClassInput,i.model);else{var o=i.model===Se.ExecutionModelFragment?"in":"out";0!==this.clip_distance_count&&this.statement(o," float gl_ClipDistance[",this.clip_distance_count,"];"),0!==this.cull_distance_count&&this.statement(o," float gl_CullDistance[",this.cull_distance_count,"];"),0===this.clip_distance_count&&0===this.cull_distance_count||this.statement("")}this.position_invariant&&(this.statement("invariant gl_Position;"),this.statement(""));for(var s=!1,n=a.create_loop_hard_lock(),c=0,_=a.ids_for_constant_or_type;c<_.length;c++){var p=_[c],l=a.ids[p];if(l.get_type()===t.TypeConstant){var u=l.get(U);(u.specialization||u.is_used_as_lut)&&(/*!options.vulkan_semantics &&*/u.specialization&&(u.specialization_constant_macro_name=this.constant_value_macro_name(this.get_decoration(u.self,te.DecorationSpecId))),this.emit_constant(u),s=!0)}else if(l.get_type()===t.TypeConstantOp)this.emit_specialization_constant_op(l.get(V)),s=!0;else if(l.get_type()===t.TypeType){(f=l.get(w)).basetype===L.Struct&&0===f.array.length&&!f.pointer&&!this.has_decoration(f.self,te.DecorationBlock)&&!this.has_decoration(f.self,te.DecorationBufferBlock)&&(s&&this.statement(""),s=!1,this.emit_struct(f))}}if(n.dispose(),s&&this.statement(""),s=!1,a.addressing_model===$.AddressingModelPhysicalStorageBuffer64EXT){for(var h=0,d=this.physical_storage_non_block_pointer_types;h<d.length;h++){var f=d[h];this.emit_buffer_reference_block(f,!1)}a.for_each_typed_id(w,(function(t,i){i.basetype===L.Struct&&i.pointer&&1===i.pointer_depth&&!e.type_is_array_of_pointers(i)&&i.storage===v.StorageClassPhysicalStorageBufferEXT&&e.emit_buffer_reference_block(t,!0)})),a.for_each_typed_id(w,(function(t,i){i.basetype===L.Struct&&i.pointer&&1===i.pointer_depth&&!e.type_is_array_of_pointers(i)&&i.storage===v.StorageClassPhysicalStorageBufferEXT&&e.emit_buffer_reference_block(t,!1)}))}a.for_each_typed_id(E,(function(t,i){var r=e.get(w,i.basetype),o=r.storage===v.StorageClassStorageBuffer||r.storage===v.StorageClassUniform||r.storage===v.StorageClassShaderRecordBufferKHR,s=et(x,a.meta,r.self).decoration.decoration_flags,n=s.get(te.DecorationBlock)||s.get(te.DecorationBufferBlock);i.storage!==v.StorageClassFunction&&r.pointer&&o&&!e.is_hidden_variable(i)&&n&&e.emit_buffer_block(i)})),a.for_each_typed_id(E,(function(t,i){var r=e.get(w,i.basetype);i.storage!==v.StorageClassFunction&&r.pointer&&r.storage===v.StorageClassPushConstant&&!e.is_hidden_variable(i)&&e.emit_push_constant_block(i)})),a.for_each_typed_id(E,(function(t,i){var r=e.get(w,i.basetype),a=r.basetype===L.Image&&r.image.dim===Ge.DimBuffer,o=r.basetype===L.Image&&1===r.image.sampled,n=r.basetype===L.Sampler;(a||!o&&!n)&&(i.storage===v.StorageClassFunction||!r.pointer||r.storage!==v.StorageClassUniformConstant&&r.storage!==v.StorageClassAtomicCounter&&r.storage!==v.StorageClassRayPayloadKHR&&r.storage!==v.StorageClassIncomingRayPayloadKHR&&r.storage!==v.StorageClassCallableDataKHR&&r.storage!==v.StorageClassIncomingCallableDataKHR&&r.storage!==v.StorageClassHitAttributeKHR||e.is_hidden_variable(i)||(e.emit_uniform(i),s=!0))})),s&&this.statement(""),s=!1;var g=!1;a.for_each_typed_id(E,(function(t,i){var a=e.get(w,i.basetype),o=e.is_hidden_variable(i);if(i.storage===v.StorageClassOutput&&!e.is_legacy()&&e.location_is_framebuffer_fetch(e.get_decoration(i.self,te.DecorationLocation))&&(o=!1),i.storage===v.StorageClassFunction||!a.pointer||i.storage!==v.StorageClassInput&&i.storage!==v.StorageClassOutput||!e.interface_variable_exists_in_entry_point(i.self)||o){if(e.is_builtin_variable(i)){var n=e.get_decoration(i.self,te.DecorationBuiltIn);!g&&(r.vertex.support_nonzero_base_instance&&n===m.BuiltInInstanceIndex||n===m.BuiltInBaseInstance)?(e.statement("#ifdef GL_ARB_shader_draw_parameters"),e.statement("#define SPIRV_Cross_BaseInstance gl_BaseInstanceARB"),e.statement("#else"),e.statement("uniform int SPIRV_Cross_BaseInstance;"),e.statement("#endif"),s=!0,g=!0):n===m.BuiltInBaseVertex?(e.statement("#ifdef GL_ARB_shader_draw_parameters"),e.statement("#define SPIRV_Cross_BaseVertex gl_BaseVertexARB"),e.statement("#else"),e.statement("uniform int SPIRV_Cross_BaseVertex;"),e.statement("#endif")):n===m.BuiltInDrawIndex&&(e.statement("#ifndef GL_ARB_shader_draw_parameters"),e.statement("#error GL_ARB_shader_draw_parameters is not supported."),e.statement("#endif"))}}else{if(r.es&&e.get_execution_model()===Se.ExecutionModelVertex&&i.storage===v.StorageClassInput&&1===a.array.length)throw new Error("OpenGL ES doesn't support array input variables in vertex shader.");e.emit_interface_block(i),s=!0}}));for(var b=0,y=this.global_variables;b<y.length;b++){var S=y[b],I=this.get(E,S);if(!this.is_hidden_variable(I,!0))if(I.storage!==v.StorageClassOutput){if(!this.variable_is_lut(I)){this.add_resource_name(I.self);var O="";r.force_zero_initialized_variables&&I.storage===v.StorageClassPrivate&&!I.initializer&&!I.static_expression&&this.type_can_zero_initialize(this.get_variable_data_type(I))&&(O=" = "+this.to_zero_initialized_expression(this.get_variable_data_type_id(I))),this.statement(this.variable_decl(I),O,";"),s=!0}}else I.initializer&&null!==this.maybe_get(U,I.initializer)&&this.emit_output_variable_initializer(I)}s&&this.statement(""),this.declare_undefined_values()},i.prototype.emit_extension_workarounds=function(e){if(this.workaround_ubo_load_overload_types.length){for(var t=0,i=this.workaround_ubo_load_overload_types;t<i.length;t++){var r=i[t],a=this.get(w,r);this.statement(this.type_to_glsl(a)," spvWorkaroundRowMajor(",this.type_to_glsl(a)," wrap) { return wrap; }")}this.statement("")}this.requires_transpose_2x2&&(this.statement("mat2 spvTranspose(mat2 m)"),this.begin_scope(),this.statement("return mat2(m[0][0], m[1][0], m[0][1], m[1][1]);"),this.end_scope(),this.statement("")),this.requires_transpose_3x3&&(this.statement("mat3 spvTranspose(mat3 m)"),this.begin_scope(),this.statement("return mat3(m[0][0], m[1][0], m[2][0], m[0][1], m[1][1], m[2][1], m[0][2], m[1][2], m[2][2]);"),this.end_scope(),this.statement("")),this.requires_transpose_4x4&&(this.statement("mat4 spvTranspose(mat4 m)"),this.begin_scope(),this.statement("return mat4(m[0][0], m[1][0], m[2][0], m[3][0], m[0][1], m[1][1], m[2][1], m[3][1], m[0][2], m[1][2], m[2][2], m[3][2], m[0][3], m[1][3], m[2][3], m[3][3]);"),this.end_scope(),this.statement(""))},i.prototype.emit_buffer_block_global=function(e){var t=this.get(w,e.basetype),i=this.ir,r=et(x,i.meta,t.self);if(e.storage===v.StorageClassStorageBuffer||r.decoration.decoration_flags.get(te.DecorationBufferBlock))throw new Error("SSBOs not supported in legacy targets.");for(var a=0,o=0,s=t.member_types;o<s.length;o++){var n=s[o],c=this.get(w,n);this.statement("uniform ",this.variable_decl(c,this.to_member_name(t,a)),";"),a++}this.statement("")},i.prototype.emit_buffer_block_native=function(e){var t=this.get(w,e.basetype),i=this.ir,r=i.get_buffer_block_flags(e),a=et(x,i.meta,t.self).decoration,o=e.storage===v.StorageClassStorageBuffer||e.storage===v.StorageClassShaderRecordBufferKHR||a.decoration_flags.get(te.DecorationBufferBlock),s=o&&r.get(te.DecorationRestrict),n=o&&r.get(te.DecorationNonReadable),c=o&&r.get(te.DecorationNonWritable),_=o&&r.get(te.DecorationCoherent),p=this.to_name(t.self,!1),l=o?this.block_ssbo_names:this.block_ubo_names;(""===a.alias||l.has(p)||this.resource_names.has(p))&&(p=this.get_block_fallback_name(e.self)),""===(p=this.add_variable(l,this.resource_names,p))&&(p="_"+this.get(w,e.basetype).self+"_"+e.self),this.block_names.add(p),l.add(p),this.declared_block_names[e.self]=p,this.statement(this.layout_for_variable(e),_?"coherent ":"",s?"restrict ":"",n?"writeonly ":"",c?"readonly ":"",o?"buffer ":"uniform ",p),this.begin_scope(),t.member_name_cache.clear();for(var u=0,h=0,d=t.member_types;h<d.length;h++){var f=d[h];this.add_member_name(t,u),this.emit_struct_member(t,f,u),u++}this.preserve_alias_on_reset(e.self),this.add_resource_name(e.self),this.end_scope_decl(this.to_name(e.self)+this.type_to_array_glsl(t)),this.statement("")},i.prototype.emit_buffer_reference_block=function(e,t){var i=this.get(w,e),r="",a=this.ir;if(t?(r=this.to_name(i.self,!1),(0===et(x,a.meta,i.self).decoration.alias.length||this.block_ssbo_names.has(r)||this.resource_names.has(r))&&(r="_"+i.self),0===(r=this.add_variable(this.block_ssbo_names,this.resource_names,r)).length&&(r="_"+i.self),this.block_names.add(r),this.block_ssbo_names.add(r),et(x,a.meta,i.self).decoration.alias=r):r=i.basetype!==L.Struct?this.type_to_glsl(i):this.to_name(i.self,!1),t)this.statement("layout(buffer_reference) buffer ",r,";");else{var o=this.physical_storage_type_to_alignment[e],s=0;if(o&&(s=o.alignment),i.basetype===L.Struct){var n=["buffer_reference"];s&&n.push("buffer_reference_align = "+s),n.push(this.buffer_to_packing_standard(i,!0));var c=a.get_buffer_block_type_flags(i),_="";c.get(te.DecorationRestrict)&&(_+=" restrict"),c.get(te.DecorationCoherent)&&(_+=" coherent"),c.get(te.DecorationNonReadable)&&(_+=" writeonly"),c.get(te.DecorationNonWritable)&&(_+=" readonly"),this.statement("layout(",n.join(", "),")",_," buffer ",r)}else s?this.statement("layout(buffer_reference, buffer_reference_align = ",s,") buffer ",r):this.statement("layout(buffer_reference) buffer ",r);if(this.begin_scope(),i.basetype===L.Struct){i.member_name_cache.clear();for(var p=0,l=0,u=i.member_types;l<u.length;l++){var h=u[l];this.add_member_name(i,p),this.emit_struct_member(i,h,p),p++}}else{var d=this.get_pointee_type(i);this.statement(this.type_to_glsl(d)," value",this.type_to_array_glsl(d),";")}this.end_scope_decl(),this.statement("")}},i.prototype.emit_declared_builtin_block=function(e,t){var i=this,r=new y,a=new y,o=!1,s=!1,n=0,c=0,_=!1,p=!1,l=!1,u=0,h=0,d=0,f=[],g=this.ir,b=this.options;if(g.for_each_typed_id(E,(function(t,b){var S=i.get(w,b.basetype),I=i.has_decoration(S.self,te.DecorationBlock),O=new y;if(b.storage===e&&I&&i.is_builtin_variable(b)){for(var k=0,L=0,E=et(x,g.meta,S.self).members;L<E.length;L++){if((R=E[L]).builtin&&(O.set(R.builtin_type),R.builtin_type===m.BuiltInCullDistance?n=i.to_array_size_literal(i.get(w,S.member_types[k])):R.builtin_type===m.BuiltInClipDistance&&(c=i.to_array_size_literal(i.get(w,S.member_types[k]))),qt(R.builtin_type)&&R.decoration_flags.get(te.DecorationOffset)&&(l=!0,f[R.builtin_type]=R.offset),qt(R.builtin_type)&&R.decoration_flags.get(te.DecorationStream))){var C=R.stream;if(p&&d!==C)throw new Error("IO block member Stream mismatch.");p=!0,d=C}k++}if(e===v.StorageClassOutput&&i.has_decoration(b.self,te.DecorationXfbBuffer)&&i.has_decoration(b.self,te.DecorationXfbStride)){var T=i.get_decoration(b.self,te.DecorationXfbBuffer),D=i.get_decoration(b.self,te.DecorationXfbStride);if(_&&T!==h)throw new Error("IO block member XfbBuffer mismatch.");if(_&&D!==u)throw new Error("IO block member XfbBuffer mismatch.");_=!0,h=T,u=D}if(e===v.StorageClassOutput&&i.has_decoration(b.self,te.DecorationStream)){C=i.get_decoration(b.self,te.DecorationStream);if(p&&d!==C)throw new Error("IO block member Stream mismatch.");p=!0,d=C}}else if(b.storage===e&&!I&&i.is_builtin_variable(b)){var R;if((R=et(x,g.meta,b.self).decoration).builtin){if(a.set(R.builtin_type),R.builtin_type===m.BuiltInCullDistance?n=i.to_array_size_literal(S):R.builtin_type===m.BuiltInClipDistance&&(c=i.to_array_size_literal(S)),qt(R.builtin_type)&&R.decoration_flags.get(te.DecorationXfbStride)&&R.decoration_flags.get(te.DecorationXfbBuffer)&&R.decoration_flags.get(te.DecorationOffset)){l=!0,f[R.builtin_type]=R.offset;T=R.xfb_buffer,D=R.xfb_stride;if(_&&T!==h)throw new Error("IO block member XfbBuffer mismatch.");if(_&&D!==u)throw new Error("IO block member XfbBuffer mismatch.");_=!0,h=T,u=D}if(qt(R.builtin_type)&&R.decoration_flags.get(te.DecorationStream)){C=i.get_decoration(b.self,te.DecorationStream);if(p&&d!==C)throw new Error("IO block member Stream mismatch.");p=!0,d=C}}}if(!O.empty()){if(o)throw new Error("Cannot use more than one builtin I/O block.");r=O,o=!0,s=S.array.length>0}})),(a=new y(a.get_lower())).set(m.BuiltInPosition),a.set(m.BuiltInPointSize),a.set(m.BuiltInClipDistance),a.set(m.BuiltInCullDistance),o||(r=a),!r.empty()){if(e===v.StorageClassOutput){var S=[];if(_&&l){if(b.es){if(b.es)throw new Error("Need GL_ARB_enhanced_layouts for xfb_stride or xfb_buffer.")}else{if(b.version<440&&b.version>=140)this.require_extension_internal("GL_ARB_enhanced_layouts");else if(b.version<140)throw new Error("Component decoration is not supported in targets below GLSL 1.40.");!b.es&&b.version<440&&this.require_extension_internal("GL_ARB_enhanced_layouts")}S.push("xfb_buffer = ".concat(h,", xfb_stride = ").concat(u))}if(p){if(this.get_execution_model()!==Se.ExecutionModelGeometry)throw new Error("Geometry streams can only be used in geometry shaders.");if(b.es)throw new Error("Multiple geometry streams not supported in ESSL.");b.version<400&&this.require_extension_internal("GL_ARB_transform_feedback3"),S.push("stream = "+d)}S.length>0?this.statement("layout(",S.join(", "),") out gl_PerVertex"):this.statement("out gl_PerVertex")}else this.get_entry_point().geometry_passthrough?this.statement("layout(passthrough) in gl_PerVertex"):this.statement("in gl_PerVertex");var I;if(this.begin_scope(),r.get(m.BuiltInPosition))(I=f[m.BuiltInPosition])?this.statement("layout(xfb_offset = ",I,") vec4 gl_Position;"):this.statement("vec4 gl_Position;");if(r.get(m.BuiltInPointSize))(I=f.find[m.BuiltInPointSize])?this.statement("layout(xfb_offset = ",I,") float gl_PointSize;"):this.statement("float gl_PointSize;");if(r.get(m.BuiltInClipDistance))(I=f[m.BuiltInClipDistance])?this.statement("layout(xfb_offset = ",I,") float gl_ClipDistance[",c,"];"):this.statement("float gl_ClipDistance[",c,"];");if(r.get(m.BuiltInCullDistance))(I=f[m.BuiltInCullDistance])?this.statement("layout(xfb_offset = ",I,") float gl_CullDistance[",n,"];"):this.statement("float gl_CullDistance[",n,"];");s||this.end_scope_decl(),this.statement("")}},i.prototype.should_force_emit_builtin_block=function(e){var t=this;if(e!==v.StorageClassOutput)return!1;var i=!1;return this.ir.for_each_typed_id(E,(function(r,a){if(!i){var o=t.get(w,a.basetype),s=t.has_decoration(o.self,te.DecorationBlock);if(a.storage===e&&s&&t.is_builtin_variable(a))for(var n=o.member_types.length,c=0;c<n;c++)t.has_member_decoration(o.self,c,te.DecorationBuiltIn)&&qt(t.get_member_decoration(o.self,c,te.DecorationBuiltIn))&&t.has_member_decoration(o.self,c,te.DecorationOffset)&&(i=!0);else a.storage===e&&!s&&t.is_builtin_variable(a)&&qt(t.get_decoration(o.self,te.DecorationBuiltIn))&&t.has_decoration(a.self,te.DecorationOffset)&&(i=!0)}})),i},i.prototype.emit_push_constant_block_glsl=function(e){var t=this.ir,i=this.get(w,e.basetype),r=et(x,t.meta,e.self).decoration.decoration_flags;r.clear(te.DecorationBinding),r.clear(te.DecorationDescriptorSet);var a=et(x,t.meta,i.self).decoration.decoration_flags,o=a.get(te.DecorationBlock);a.clear(te.DecorationBlock),this.emit_struct(i),o&&a.set(te.DecorationBlock),this.emit_uniform(e),this.statement("")},i.prototype.emit_interface_block=function(e){var t=this.get(w,e.basetype),i=this.ir,r=this.options;e.storage===v.StorageClassInput&&t.basetype===L.Double&&!r.es&&r.version<410&&this.require_extension_internal("GL_ARB_vertex_attrib_64bit");var a=et(x,i.meta,t.self).decoration.decoration_flags.get(te.DecorationBlock),o=this.to_storage_qualifiers_glsl(e);if(a)if(r.force_flattened_io_blocks||r.es&&r.version<310||!r.es&&r.version<150)this.emit_flattened_io_block(e,o);else{r.es&&r.version<320&&(this.has_extension("GL_EXT_geometry_shader")||this.has_extension("GL_EXT_tessellation_shader")||this.require_extension_internal("GL_EXT_shader_io_blocks")),this.fixup_io_block_patch_qualifiers(e);var s=this.to_name(t.self,!1),n=t.storage===v.StorageClassInput?this.block_input_names:this.block_output_names;0===s.length||n.has(s)?s=this.get_fallback_name(t.self):n.add(s),0===s.length&&(s="_"+this.get(w,e.basetype).self+"_"+e.self),this.resource_names.add(s);var c=this.has_decoration(e.self,te.DecorationPatch);this.statement(this.layout_for_variable(e),c?"patch ":"",o,s),this.begin_scope(),t.member_name_cache.clear();for(var _=0,p=0,l=t.member_types;p<l.length;p++){var u=l[p];this.add_member_name(t,_),this.emit_struct_member(t,u,_),_++}this.add_resource_name(e.self),this.end_scope_decl(this.to_name(e.self)+this.type_to_array_glsl(t)),this.statement("")}else t.basetype===L.Struct&&(r.force_flattened_io_blocks||r.es&&r.version<310||!r.es&&r.version<150)?this.emit_flattened_io_block(e,o):(this.add_resource_name(e.self),this.statement(this.layout_for_variable(e),this.to_qualifiers_glsl(e.self),this.variable_decl(t,this.to_name(e.self),e.self),";"))},i.prototype.constant_value_macro_name=function(e){return this.options.specConstPrefix+e},i.prototype.get_constant_mapping_to_workgroup_component=function(e){var t=this.get_entry_point(),i=-1;return 0===t.workgroup_size.constant&&t.flags.get(Ee.ExecutionModeLocalSizeId)&&(e.self===t.workgroup_size.id_x?i=0:e.self===t.workgroup_size.id_y?i=1:e.self===t.workgroup_size.id_z&&(i=2)),i},i.prototype.emit_constant=function(e){var t=this.get(w,e.constant_type),i=this.to_name(e.self),r=new Gt,a=new Gt,o=new Gt,s=this.get_work_group_size_specialization_constants(r,a,o);if(e.self!==s){var n=e.self===r.id||e.self===a.id||e.self===o.id;if(/*!options.vulkan_semantics &&*/!n||this.has_decoration(e.self,te.DecorationSpecId))if(this.has_decoration(e.self,te.DecorationSpecId)){var c=e.specialization_constant_macro_name;this.statement("#ifndef ",c),this.statement("#define ",c," ",this.constant_expression(e)),this.statement("#endif"),n||this.statement("const ",this.variable_decl(t,i)," = ",c,";")}else this.statement("const ",this.variable_decl(t,i)," = ",this.constant_expression(e),";")}},i.prototype.emit_specialization_constant_op=function(e){var t=this.get(w,e.basetype),i=this.to_name(e.self);this.statement("const ",this.variable_decl(t,i)," = ",this.constant_op_expression(e),";")},i.prototype.emit_continue_block=function(e,t,i){var r=this.get(J,e);this.current_continue_block=r;var a=[],o=this.redirect_statement;this.redirect_statement=a;for(var s=this.ir;0==(et(0,s.block_meta,r.self)&re.BLOCK_META_LOOP_HEADER_BIT);)if(this.emit_block_instructions(r),r.next_block)this.flush_phi(e,r.next_block),r=this.get(J,r.next_block);else if(r.true_block&&t)this.flush_phi(e,r.true_block),r=this.get(J,r.true_block);else{if(!r.false_block||!i)throw new Error("Invalid continue block detected!");this.flush_phi(e,r.false_block),r=this.get(J,r.false_block)}this.redirect_statement=o;for(var n=0;n<a.length;++n){var c=a[n];""!==c&&";"===c.charAt(c.length-1)&&(a[n]=c.substring(0,c.length-1))}return this.current_continue_block=null,a.join(", ")},i.prototype.attempt_emit_loop_header=function(e,t){var i=this.continue_block_type(this.get(J,e.continue_block));if(t===A.MergeToSelectForLoop||t===A.MergeToSelectContinueForLoop){var r=this.statement_count;this.emit_block_instructions(e);var a=!this.forced_temporaries.has(e.condition);if(r===this.statement_count&&a){switch(i){case N.ForLoop:this.flush_undeclared_variables(e);var o=this.emit_for_loop_initializers(e),s=this.to_expression(e.condition);if(this.execution_is_noop(this.get(J,e.true_block),this.get(J,e.merge_block))&&(s="!"+this.enclose_expression(s)),this.emit_block_hints(e),t!==A.MergeToSelectContinueForLoop){var n=this.emit_continue_block(e.continue_block,!1,!1);this.statement("for (",o,"; ",s,"; ",n,")")}else this.statement("for (",o,"; ",s,"; )");break;case N.WhileLoop:this.flush_undeclared_variables(e),this.emit_while_loop_initializers(e),this.emit_block_hints(e);s=this.to_expression(e.condition);this.execution_is_noop(this.get(J,e.true_block),this.get(J,e.merge_block))&&(s="!"+this.enclose_expression(s)),this.statement("while (",s,")");break;default:return e.disable_block_optimization=!0,this.force_recompile(),this.begin_scope(),!1}return this.begin_scope(),!0}return e.disable_block_optimization=!0,this.force_recompile(),this.begin_scope(),!1}if(t===A.MergeToDirectForLoop){var c=this.get(J,e.next_block);this.flush_undeclared_variables(c);r=this.statement_count;this.emit_block_instructions(c);a=!this.forced_temporaries.has(c.condition);if(r===this.statement_count&&a){var _=c.true_block;switch(i){case N.ForLoop:o=this.emit_for_loop_initializers(e),s=this.to_expression(c.condition);this.execution_is_noop(this.get(J,c.true_block),this.get(J,e.merge_block))&&(s="!"+this.enclose_expression(s),_=c.false_block);n=this.emit_continue_block(e.continue_block,!1,!1);this.emit_block_hints(e),this.statement("for (",o,"; ",s,"; ",n,")");break;case N.WhileLoop:this.emit_while_loop_initializers(e),this.emit_block_hints(e);s=this.to_expression(c.condition);this.execution_is_noop(this.get(J,c.true_block),this.get(J,e.merge_block))&&(s="!"+this.enclose_expression(s),_=c.false_block),this.statement("while (",s,")");break;default:return e.disable_block_optimization=!0,this.force_recompile(),this.begin_scope(),!1}return this.begin_scope(),this.branch(c.self,_),!0}return e.disable_block_optimization=!0,this.force_recompile(),this.begin_scope(),!1}return!1},i.prototype.branch_to_continue=function(e,t){var i=this.get(J,t);if(e!==t)if(console.assert(this.is_continue(t)),i.complex_continue){var r=this.expression_usage_counts.concat();this.emit_block_chain(i),this.expression_usage_counts=r}else{var a=this.get(J,e),o=!1,s=0;if(a.merge_block?s=e:a.loop_dominator!==J.NoDominator&&(s=a.loop_dominator),0!==s)o=this.get_cfg_for_current_function().node_terminates_control_flow_in_sub_graph(s,e);o||this.statement("continue;")}},i.prototype.branch=function(e,t,i,r){void 0===i?this._branch(e,t):this._branchTrueFalse(e,t,i,r)},i.prototype._branch=function(e,t){this.flush_phi(e,t),this.flush_control_dependent_expressions(e);var i=this.is_continue(t),r=this.ir;if(0!=(r.block_meta[t]&re.BLOCK_META_LOOP_HEADER_BIT)&&this.get(J,e).loop_dominator===t)this.statement("continue;");else if(e!==t&&this.is_break(t))this.current_emitting_switch&&this.is_loop_break(t)&&this.current_emitting_switch.loop_dominator!==J.NoDominator&&this.get(J,this.current_emitting_switch.loop_dominator).merge_block===t&&(this.current_emitting_switch.need_ladder_break||(this.force_recompile(),this.current_emitting_switch.need_ladder_break=!0),this.statement("_",this.current_emitting_switch.self,"_ladder_break = true;")),this.statement("break;");else if(i||e===t){var a=0!=(et(0,r.block_meta,t)&(re.BLOCK_META_SELECTION_MERGE_BIT|re.BLOCK_META_MULTISELECT_MERGE_BIT|re.BLOCK_META_LOOP_MERGE_BIT));i&&a||this.branch_to_continue(e,t)}else this.is_conditional(t)||this.emit_block_chain(this.get(J,t))},i.prototype._branchTrueFalse=function(e,t,i,r){var a=this.get(J,e),o=a.merge===M.MergeSelection?a.next_block:0,s=i!==o||this.flush_phi_required(e,i),n=r!==o||this.flush_phi_required(e,r);(s||n)&&(a.hint!==B.HintFlatten&&a.hint!==B.HintDontFlatten||this.emit_block_hints(a),s?(this.statement("if (",this.to_expression(t),")"),this.begin_scope(),this.branch(e,i),this.end_scope(),n&&(this.statement("else"),this.begin_scope(),this.branch(e,r),this.end_scope())):n&&(this.statement("if (!",this.to_enclosed_expression(t),")"),this.begin_scope(),this.branch(e,r),this.end_scope()))},i.prototype.flush_phi=function(e,t){var i=this.get(J,t);if(i.ignore_phi_from_block!==e)for(var r=new Set,a=0;a<i.phi_variables.length;++a){var o=i.phi_variables[a];if(o.parent===e){var s=this.get(E,o.function_variable);if(s.loop_variable&&!s.loop_variable_enable)s.static_expression=o.local_variable;else{this.flush_variable_declaration(o.function_variable);for(var n=!1,c=a+1;c<i.phi_variables.length;++c){var _=i.phi_variables[c];if(_.local_variable===o.function_variable&&_.parent===e){n=!0;break}}n&&(s.allocate_temporary_copy||(s.allocate_temporary_copy=!0,this.force_recompile()),this.statement("_",o.function_variable,"_copy"," = ",this.to_name(o.function_variable),";"),r.add(o.function_variable));var p=this.to_expression(o.function_variable),l=void 0;l=r.has(o.local_variable)?"_"+o.local_variable+"_copy":this.to_pointer_expression(o.local_variable),this.optimize_read_modify_write(this.get(w,s.basetype),p,l)||this.statement(p," = ",l,";")}this.register_write(o.function_variable)}}},i.prototype.flush_variable_declaration=function(e){var t=this.maybe_get(E,e),i=this.options;if(t&&t.deferred_declaration){var r="";!i.force_zero_initialized_variables||t.storage!==v.StorageClassFunction&&t.storage!==v.StorageClassGeneric&&t.storage!==v.StorageClassPrivate||t.initializer||!this.type_can_zero_initialize(this.get_variable_data_type(t))||(r=" = "+this.to_zero_initialized_expression(this.get_variable_data_type_id(t))),this.statement(this.variable_decl_function_local(t),r,";"),t.deferred_declaration=!1}t&&this.emit_variable_temporary_copies(t)},i.prototype.flush_undeclared_variables=function(e){for(var t=0,i=e.dominated_variables;t<i.length;t++){var r=i[t];this.flush_variable_declaration(r)}},i.prototype.emit_variable_temporary_copies=function(e){if(e.allocate_temporary_copy&&!this.flushed_phi_variables.has(e.self)){var t=this.get(w,e.basetype),i=this.get_decoration_bitset(e.self);this.statement(this.flags_to_qualifiers_glsl(t,i),this.variable_decl(t,"_"+e.self+"_copy"),";"),this.flushed_phi_variables.add(e.self)}},i.prototype.should_dereference=function(e){if(!this.expression_type(e).pointer)return!1;if(!this.expression_is_lvalue(e))return!1;var t=this.maybe_get(E,e);if(t)return t.phi_variable;var i=this.maybe_get(oe,e);return!i||!i.access_chain},i.prototype.should_forward=function(e){var t=this.maybe_get(E,e);return!(!t||!t.forwardable)||!this.options.force_temporary&&!!this.is_immutable(e)},i.prototype.should_suppress_usage_tracking=function(e){return!this.expression_is_forwarded(e)||this.expression_suppresses_usage_tracking(e)},i.prototype.emit_mix_op=function(e,t,i,r,a){var o=this.expression_type(a),s=this.get(w,e);s.pointer&&(this.register_write(i),this.register_write(r));var n=this.backend,c=this.options,_=n.boolean_mix_function&&(c.es&&c.version>=310||!c.es&&c.version>=450),p=this.to_trivial_mix_op(s,i,r,a),l=void 0!==p;if(1===o.vecsize&&(_=!1),l)this.emit_unary_func_op(e,t,a,p);else if(_||o.basetype!==L.Boolean)o.basetype===L.Boolean?this.emit_trinary_func_op(e,t,i,r,a,n.boolean_mix_function):this.emit_trinary_func_op(e,t,i,r,a,"mix");else{var u=this.to_ternary_expression(this.get(w,e),a,r,i);this.emit_op(e,t,u,this.should_forward(i)&&this.should_forward(r)&&this.should_forward(a)),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r),this.inherit_expression_dependencies(t,a)}},i.prototype.emit_nminmax_op=function(e,t,i,r,a){var o=this.ir,s=et(0,this.extra_sub_expressions,t);if(!s){s=o.increase_bound_by(5);var n=d(w,this.get(w,e));n.basetype=L.Boolean,this.set(w,s,n)}var c=s+0,_=s+1,p=s+2,l=s+3,u=s+4;o.meta[l]=d(x,o.meta[t]),o.meta[u]=d(x,o.meta[t]),this.emit_unary_func_op(c,_,i,"isnan"),this.emit_unary_func_op(c,p,r,"isnan"),this.emit_binary_func_op(e,l,i,r,a===Ue.GLSLstd450NMin?"min":"max"),this.emit_mix_op(e,u,l,r,_),this.emit_mix_op(e,t,u,i,p)},i.prototype.to_trivial_mix_op=function(e,t,i,r){var a=this.backend,o=this.maybe_get(U,t),s=this.maybe_get(U,i),n=this.expression_type(r);if(o&&s&&!o.specialization&&!s.specialization){var c=this.get(w,o.constant_type);if(n.basetype===L.Boolean&&c.basetype!==L.Struct&&!this.is_array(c)&&(a.use_constructor_splatting||c.vecsize===n.vecsize)&&!(c.columns>1)){for(var _=!0,p=0;_&&p<c.vecsize;p++)switch(e.basetype){case L.Short:case L.UShort:_=0===o.scalar_u16(0,p)&&1===s.scalar_u16(0,p);break;case L.Int:case L.UInt:_=0===o.scalar(0,p)&&1===s.scalar(0,p);break;case L.Half:_=0===o.scalar_f16(0,p)&&1===s.scalar_f16(0,p);break;case L.Float:_=0===o.scalar_f32(0,p)&&1===s.scalar_f32(0,p);break;case L.Double:_=0===o.scalar_f64(0,p)&&1===s.scalar_f64(0,p);break;case L.Int64:case L.UInt64:_=o.scalar_u64(0,p)===BigInt(0)&&s.scalar_u64(0,p)===BigInt(1);break;default:_=!1}return _?this.type_to_glsl_constructor(e):void 0}}},i.prototype.emit_trinary_func_op=function(e,t,i,r,a,o){var s=this.should_forward(i)&&this.should_forward(r)&&this.should_forward(a);this.emit_op(e,t,o+"("+this.to_unpacked_expression(i)+", "+this.to_unpacked_expression(r)+", "+this.to_unpacked_expression(a)+")",s),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r),this.inherit_expression_dependencies(t,a)},i.prototype.emit_binary_func_op=function(e,t,i,r,a){var o=this.should_forward(i)&&this.should_forward(r);this.emit_op(e,t,a+"("+this.to_unpacked_expression(i)+", "+this.to_unpacked_expression(r)+")",o),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r)},i.prototype.emit_trinary_func_op_bitextract=function(e,t,i,r,a,o,s,n,c,_){var p=this.get(w,e),l=d(w,p);l.basetype=n;var u=this.expression_type(i).basetype!==n?this.bitcast_glsl(l,i):this.to_unpacked_expression(i),h=this.to_unpacked_expression(r),f=this.to_unpacked_expression(a);l.basetype=c,l.vecsize=1;var m=this.expression_type(r).basetype!==c?this.type_to_glsl_constructor(l)+"("+h+")":h;l.basetype=_,l.vecsize=1;var g=this.expression_type(a).basetype!==_?this.type_to_glsl_constructor(l)+"("+f+")":f,b="";p.basetype!==s?(l.vecsize=p.vecsize,l.basetype=s,b=this.bitcast_glsl_op(p,l),b+="("+o+"("+u+", "+m+", "+g+"))"):b+=o+"("+u+", "+m+", "+g+")",this.emit_op(e,t,b,this.should_forward(i)&&this.should_forward(r)&&this.should_forward(a)),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r),this.inherit_expression_dependencies(t,a)},i.prototype.emit_bitfield_insert_op=function(e,t,i,r,a,o,s,n){var c=this.should_forward(i)&&this.should_forward(r)&&this.should_forward(a)&&this.should_forward(o),_=this.to_unpacked_expression(i),p=this.to_unpacked_expression(r),l=this.to_unpacked_expression(a),u=this.to_unpacked_expression(o),h=new w;h.vecsize=1,h.basetype=n,this.expression_type(a).basetype!==n&&(l=this.type_to_glsl_constructor(h)+"("+l+")"),this.expression_type(o).basetype!==n&&(u=this.type_to_glsl_constructor(h)+"("+u+")"),this.emit_op(e,t,s+"("+_+", "+p+", "+l+", "+u+")",c),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r),this.inherit_expression_dependencies(t,a),this.inherit_expression_dependencies(t,o)},i.prototype.emit_unary_func_op=function(e,t,i,r){var a=this.should_forward(i);this.emit_op(e,t,r+"("+this.to_unpacked_expression(i)+")",a),this.inherit_expression_dependencies(t,i)},i.prototype.emit_binary_op=function(e,t,i,r,a){var o=this.backend.support_precise_qualifier&&this.has_decoration(t,te.DecorationNoContraction)&&gt(this.get(w,e)),s=this.should_forward(i)&&this.should_forward(r)&&!o;this.emit_op(e,t,this.to_enclosed_unpacked_expression(i)+" "+a+" "+this.to_enclosed_unpacked_expression(r),s),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r)},i.prototype.emit_unrolled_binary_op=function(e,t,i,r,a,o,s){var n=this.expression_type(i),c=this.expression_type(r),_=d(w,n),p=d(w,c);_.basetype=s,p.basetype=s,_.vecsize=1,p.vecsize=1;var l=this.get(w,e),u=this.type_to_glsl_constructor(l);u+="(";for(var h=0;h<l.vecsize;h++)o&&(u+="!("),s!==L.Unknown&&n.basetype!==s?u+=this.bitcast_expression(_,n.basetype,this.to_extract_component_expression(i,h)):u+=this.to_extract_component_expression(i,h),u+=" "+a+" ",s!==L.Unknown&&c.basetype!==s?u+=this.bitcast_expression(p,c.basetype,this.to_extract_component_expression(r,h)):u+=this.to_extract_component_expression(r,h),o&&(u+=")"),h+1<l.vecsize&&(u+=", ");u+=")",this.emit_op(e,t,u,this.should_forward(i)&&this.should_forward(r)),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r)},i.prototype.emit_unary_func_op_cast=function(e,t,i,r,a,o){var s=this.get(w,e),n=this.expression_type(i),c=d(w,s);c.basetype=a,c.width=n.width;var _="";_=n.basetype!==a?n.basetype===L.Boolean?this.type_to_glsl(c)+"("+this.to_unpacked_expression(i)+")":this.bitcast_glsl(c,i):this.to_unpacked_expression(i);var p="";s.basetype!==o?(c.basetype=o,c.width=s.width,p=s.basetype===L.Boolean?this.type_to_glsl(s):this.bitcast_glsl_op(s,c),p+="("+r+"("+_+"))"):p+=r+"("+_+")",this.emit_op(e,t,p,this.should_forward(i)),this.inherit_expression_dependencies(t,i)},i.prototype.emit_binary_func_op_cast=function(e,t,i,r,a,o,s){var n={cast_op0:"",cast_op1:"",input_type:o},c=this.binary_op_bitcast_helper(n,i,r,s),_=this.get(w,e),p="";_.basetype!==o&&_.basetype!==L.Boolean?(c.basetype=o,p=this.bitcast_glsl_op(_,c),p+="("+a+"("+n.cast_op0+", "+n.cast_op1+"))"):p+=a+"("+n.cast_op0+", "+n.cast_op1+")",this.emit_op(e,t,p,this.should_forward(i)&&this.should_forward(r)),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r)},i.prototype.emit_trinary_func_op_cast=function(e,t,i,r,a,o,s){var n=this.get(w,e),c=d(w,n);c.basetype=s;var _=this.expression_type(i).basetype!==s?this.bitcast_glsl(c,i):this.to_unpacked_expression(i),p=this.expression_type(r).basetype!==s?this.bitcast_glsl(c,r):this.to_unpacked_expression(r),l=this.expression_type(a).basetype!==s?this.bitcast_glsl(c,a):this.to_unpacked_expression(a),u="";n.basetype!==s?(u=this.bitcast_glsl_op(n,c),u+="("+o+"("+_+", "+p+", "+l+"))"):u+=o+"("+_+", "+p+", "+l+")",this.emit_op(e,t,u,this.should_forward(i)&&this.should_forward(r)&&this.should_forward(a)),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r),this.inherit_expression_dependencies(t,a)},i.prototype.emit_binary_op_cast=function(e,t,i,r,a,o,s){var n={cast_op0:"",cast_op1:"",input_type:o},c=this.binary_op_bitcast_helper(n,i,r,s),_=this.get(w,e),p="";_.basetype!==n.input_type&&_.basetype!==L.Boolean?(c.basetype=o,p=this.bitcast_glsl_op(_,c),p+="("+n.cast_op0+" "+a+" "+n.cast_op1+")"):p+=n.cast_op0+" "+a+" "+n.cast_op1,this.emit_op(e,t,p,this.should_forward(i)&&this.should_forward(r)),this.inherit_expression_dependencies(t,i),this.inherit_expression_dependencies(t,r)},i.prototype.binary_op_bitcast_helper=function(e,t,i,r){var a=this.expression_type(t),o=this.expression_type(i),s=a.basetype!==o.basetype||!r&&a.basetype!==e.input_type,n=new w;return n.basetype=e.input_type,n.vecsize=a.vecsize,n.columns=a.columns,n.width=a.width,s?(e.cast_op0=this.bitcast_glsl(n,t),e.cast_op1=this.bitcast_glsl(n,i)):(e.cast_op0=this.to_enclosed_unpacked_expression(t),e.cast_op1=this.to_enclosed_unpacked_expression(i),e.input_type=a.basetype),d(w,n)},i.prototype.emit_complex_bitcast=function(e,t,i){var r,a=this.get(w,e),o=this.expression_type(i);if(a.basetype===L.Half&&o.basetype===L.Float&&1===o.vecsize)r="unpackFloat2x16(floatBitsToUint("+this.to_unpacked_expression(i)+"))";else{if(a.basetype!==L.Float||o.basetype!==L.Half||2!==o.vecsize)return!1;r="uintBitsToFloat(packFloat2x16("+this.to_unpacked_expression(i)+"))"}return this.emit_op(e,t,r,this.should_forward(i)),!0},i.prototype.to_ternary_expression=function(e,t,i,r){var a,o=this;if(1===this.expression_type(t).vecsize)a=this.to_enclosed_expression(t)+" ? "+this.to_enclosed_pointer_expression(i)+" : "+this.to_enclosed_pointer_expression(r);else{var s=function(e,t){return o.to_extract_component_expression(e,t)};a=this.type_to_glsl_constructor(e),a+="(";for(var n=0;n<e.vecsize;n++)a+=s(t,n),a+=" ? ",a+=s(i,n),a+=" : ",a+=s(r,n),n+1<e.vecsize&&(a+=", ");a+=")"}return a},i.prototype.emit_unary_op=function(e,t,i,r){var a=this.should_forward(i);this.emit_op(e,t,r+this.to_enclosed_unpacked_expression(i),a),this.inherit_expression_dependencies(t,i)},i.prototype.expression_is_forwarded=function(e){return this.forwarded_temporaries.has(e)},i.prototype.expression_suppresses_usage_tracking=function(e){return this.suppressed_usage_tracking.has(e)},i.prototype.expression_read_implies_multiple_reads=function(e){var t=this.maybe_get(oe,e);return!!t&&this.current_loop_level>t.emitted_loop_level},i.prototype.emit_op=function(e,t,i,r,a){return void 0===a&&(a=!1),r&&!this.forced_temporaries.has(t)?(this.forwarded_temporaries.add(t),a&&this.suppressed_usage_tracking.add(t),this.set(oe,t,i,e,!0)):(this.statement(this.declare_temporary(e,t),i,";"),this.set(oe,t,this.to_name(t),e,!0))},i.prototype.access_chain_internal_append_index=function(e,t,i,r,a,o){var s=0!=(r&kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT),n=0==(r&kt.ACCESS_CHAIN_SKIP_REGISTER_EXPRESSION_READ_BIT);return e+="[",e+=s?le(o):this.to_unpacked_expression(o,n),e+="]"},i.prototype.access_chain_internal=function(e,i,r,a,o,s){var n=this,c="",_=this,p=_.backend,l=_.options,u=_.ir,h=0!=(o&kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT),d=0!=(o&kt.ACCESS_CHAIN_LITERAL_MSB_FORCE_ID),f=0!=(o&kt.ACCESS_CHAIN_CHAIN_ONLY_BIT),g=0!=(o&kt.ACCESS_CHAIN_PTR_CHAIN_BIT),y=0==(o&kt.ACCESS_CHAIN_SKIP_REGISTER_EXPRESSION_READ_BIT),S=0!=(o&kt.ACCESS_CHAIN_FLATTEN_ALL_MEMBERS_BIT);if(!f){var I=this.maybe_get(oe,e),O=I&&I.need_transpose;I&&(I.need_transpose=!1),c=this.to_enclosed_expression(e,y),I&&(I.need_transpose=O)}var k=this.expression_type_id(e);if(!p.native_pointers){if(g)throw new Error("Backend does not support native pointers and does not support OpPtrAccessChain.");if(this.should_dereference(e)){var C=this.get(w,k);c=this.dereference_expression(C,c)}}for(var T=this.get_pointee_type(k),D=c.indexOf("[")>=0,R=this.is_non_native_row_major_matrix(e),M=this.has_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypePacked),B=this.get_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypeID),A=this.has_decoration(e,te.DecorationInvariant),N=!1,P=!1,G=function(t,i){var r=o;i||(r&=~kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT),c=n.access_chain_internal_append_index(c,e,T,r,D,t)},F=0;F<a;F++){var z=i[F+r],V=h;if(V&&d&&z>>31!=0&&(V=!1,z&=2147483647),g&&0===F){if(l.flatten_multidimensional_arrays&&(N=P=T.array.length>=1)&&(c+="["),l.flatten_multidimensional_arrays&&P){c+=V?le(z):this.to_enclosed_expression(z,y);for(var H=T.array.length;H;H--)c+=" * ",c+=this.enclose_expression(this.to_array_size(T,H-1));0===T.array.length?N=!1:c+=" + ",N||(c+="]")}else G(z,V);T.basetype===L.ControlPointArray&&(k=T.parent_type,T=this.get(w,k)),D=!0}else if(T.array.length>0){l.flatten_multidimensional_arrays&&!N&&(N=P=T.array.length>1)&&(c+="["),console.assert(T.parent_type);var q=this.maybe_get(E,e);if(p.force_gl_in_out_block&&0===F&&q&&this.is_builtin_variable(q)&&!this.has_decoration(T.self,te.DecorationBlock))switch(X=et(x,u.meta,e).decoration.builtin_type){case m.BuiltInPosition:case m.BuiltInPointSize:q.storage===v.StorageClassInput?c="gl_in["+this.to_expression(z,y):q.storage===v.StorageClassOutput?c="gl_out["+this.to_expression(z,y):G(z,V);break;default:G(z,V)}else if(l.flatten_multidimensional_arrays&&P){var K=this.get(w,T.parent_type);c+=V?le(z):this.to_enclosed_expression(z,y);for(H=K.array.length;H;H--)c+=" * ",c+=this.enclose_expression(this.to_array_size(K,H-1));0===K.array.length?N=!1:c+=" + ",N||(c+="]")}else this.builtin_translates_to_nonarray(this.get_decoration(e,te.DecorationBuiltIn))||G(z,V);k=T.parent_type,T=this.get(w,k),D=!0}else if(T.basetype===L.Struct){if(V||(z=this.evaluate_constant_u32(z)),z<T.member_type_index_redirection.length&&(z=T.member_type_index_redirection[z]),z>=T.member_types.length)throw new Error("Member index is out of bounds!");var X;if(void 0!==(X=this.is_member_builtin(T,z))&&this.access_chain_needs_stage_io_builtin_translation(e))D?(c+=".",c+=this.builtin_to_glsl(X,T.storage)):c=this.builtin_to_glsl(X,T.storage);else{var j=this.get_member_qualified_name(k,z);""!==j?c=j:c+=S?"_"+this.to_member_name(T,z):this.to_member_reference(e,T,z,g)}this.has_member_decoration(T.self,z,te.DecorationInvariant)&&(A=!0),M=this.member_is_packed_physical_type(T,z),B=this.member_is_remapped_physical_type(T,z)?this.get_extended_member_decoration(T.self,z,b.SPIRVCrossDecorationPhysicalTypeID):0,R=this.member_is_non_native_row_major_matrix(T,z),T=this.get(w,T.member_types[z])}else if(T.columns>1)c+="[",c+=V?le(z):this.to_unpacked_expression(z,y),c+="]",k=T.parent_type,T=this.get(w,k);else if(T.vecsize>1){var W="";if(R){var Q=c.lastIndexOf("[");Q>=0&&(W=c.substring(Q),c=c.substring(0,Q))}var Y=v.StorageClassGeneric,Z=!1;if(0==(o&kt.ACCESS_CHAIN_FORCE_COMPOSITE_BIT)?this.expression_type(e).pointer&&(Y=this.get_expression_effective_storage_class(e)):Z=!0,R||Z||(c=this.prepare_access_chain_for_scalar_access(c,this.get(w,T.parent_type),Y,M)),V){var J=z>=T.vecsize;M||R?c+="["+(J?0:z)+"]":(c+=".",c+=this.index_to_swizzle(J?0:z))}else if(u.ids[z].get_type()!==t.TypeConstant||M||R)c+="["+this.to_unpacked_expression(z,y)+"]";else{var $=this.get(U,z);J=$.scalar()>=T.vecsize;$.specialization?c+="["+(J?"0":this.to_expression(z))+"]":c+="."+this.index_to_swizzle(J?0:$.scalar())}R&&!Z&&(c=this.prepare_access_chain_for_scalar_access(c,this.get(w,T.parent_type),Y,M)),c+=W,R=!1,M=!1,B=0,k=T.parent_type,T=this.get(w,k)}else if(!p.allow_truncated_access_chain)throw new Error("Cannot subdivide a scalar value!")}if(N)throw new Error("Flattening of multidimensional arrays were enabled, but the access chain was terminated in the middle of a multidimensional array. This is not supported.");return s&&(s.need_transpose=R,s.storage_is_packed=M,s.storage_is_invariant=A,s.storage_physical_type=B),c},i.prototype.get_expression_effective_storage_class=function(e){var i=this.maybe_get_backing_variable(e),r=this.ir.ids[e].get_type()===t.TypeExpression&&!this.get(oe,e).access_chain&&(this.forced_temporaries.has(e)||!this.forwarded_temporaries.has(e));return i&&!r?this.variable_decl_is_remapped_storage(i,v.StorageClassWorkgroup)?v.StorageClassWorkgroup:this.variable_decl_is_remapped_storage(i,v.StorageClassStorageBuffer)||i.storage===v.StorageClassUniform&&this.has_decoration(this.get(w,i.basetype).self,te.DecorationBufferBlock)?v.StorageClassStorageBuffer:i.storage:this.expression_type(e).storage},i.prototype.access_chain_needs_stage_io_builtin_translation=function(e){return!0},i.prototype.prepare_access_chain_for_scalar_access=function(e,t,i,r){return e},i.prototype.access_chain=function(e,t,i,r,a,o,s){if(void 0===o&&(o=null),void 0===s&&(s=!1),this.flattened_buffer_blocks.has(e)){var n={matrix_stride:0,array_stride:0,need_transpose:!1};return this.flattened_access_chain_offset(this.expression_type(e),t,i,r,0,16,n,s),o&&(o.need_transpose=a.columns>1&&n.need_transpose,o.storage_is_packed=!1),this.flattened_access_chain(e,t,i,r,a,0,n.matrix_stride,n.array_stride,n.need_transpose)}if(this.flattened_structs.hasOwnProperty(e)&&r>0){var c=kt.ACCESS_CHAIN_CHAIN_ONLY_BIT|kt.ACCESS_CHAIN_SKIP_REGISTER_EXPRESSION_READ_BIT;s&&(c|=kt.ACCESS_CHAIN_PTR_CHAIN_BIT),this.flattened_structs[e]&&(c|=kt.ACCESS_CHAIN_FLATTEN_ALL_MEMBERS_BIT,o&&(o.flattened_struct=a.basetype===L.Struct));var _=this.access_chain_internal(e,t,i,r,c,null).substring(1);o&&(o.need_transpose=!1,o.storage_is_packed=!1);var p=this.to_flattened_access_chain_expression(e)+"_"+_;return de.sanitize_underscores(p)}c=kt.ACCESS_CHAIN_SKIP_REGISTER_EXPRESSION_READ_BIT;return s&&(c|=kt.ACCESS_CHAIN_PTR_CHAIN_BIT),this.access_chain_internal(e,t,i,r,c,o)},i.prototype.flattened_access_chain=function(e,t,i,r,a,o,s,n,c){if(a.array.length>0)throw new Error("Access chains that result in an array can not be flattened");return a.basetype===L.Struct?this.flattened_access_chain_struct(e,t,i,r,a,o):a.columns>1?this.flattened_access_chain_matrix(e,t,i,r,a,o,s,c):this.flattened_access_chain_vector(e,t,i,r,a,o,s,c)},i.prototype.flattened_access_chain_struct=function(e,t,i,r,a,o){for(var s=this.type_to_glsl_constructor(a)+"(",n=0;n<a.member_types.length;++n){0!==n&&(s+=", ");var c=this.get(w,a.member_types[n]),_=this.type_struct_member_offset(a,n),p=!1,l=0;c.columns>1&&(p=this.combined_decoration_for_member(a,n).get(te.DecorationRowMajor),l=this.type_struct_member_matrix_stride(a,n));var u=this.flattened_access_chain(e,t,i,r,c,o+_,l,0,p);s+=p?this.convert_row_major_matrix(u,c,0,!1):u}return s+=")"},i.prototype.flattened_access_chain_matrix=function(e,t,i,r,a,o,s,n){console.assert(s);var c=d(w,a);if(n){var _=c.vecsize;c.vecsize=c.columns,c.columns=_}for(var p=this.type_to_glsl_constructor(c)+"(",l=0;l<c.columns;l++)0!==l&&(p+=", "),p+=this.flattened_access_chain_vector(e,t,i,r,c,o+l*s,s,!1);return p+=")"},i.prototype.flattened_access_chain_vector=function(e,t,i,r,a,o,s,n){var c=this.flattened_access_chain_offset(this.expression_type(e),t,i,r,o,16),_=this.to_name(this.expression_type(e).self);if(n){var p="";a.vecsize>1&&(p+=this.type_to_glsl_constructor(a),p+="(");for(var l=0;l<a.vecsize;++l){0!==l&&(p+=", ");var u=c.second+l*s;console.assert(u%(a.width/8)==0);var h=u/(a.width/8);p+=_,p+="[",p+=c.first,p+=le(h/4),p+="]",p+=this.vector_swizzle(1,h%4)}return a.vecsize>1&&(p+=")"),p}console.assert(c.second%(a.width/8)==0);h=c.second/(a.width/8),p="";return p+=_,p+="[",p+=c.first,p+=le(h/4),p+="]",p+=this.vector_swizzle(a.vecsize,h%4)},i.prototype.flattened_access_chain_offset=function(e,t,i,r,a,o,s,n){void 0===s&&(s=null),void 0===n&&(n=!1);for(var c=this.get_pointee_type(e),_="",p=(null==s?void 0:s.need_transpose)||!1,l=(null==s?void 0:s.matrix_stride)||0,u=(null==s?void 0:s.array_stride)||0,h=0;h<r;h++){var d=t[i+h];if(n&&0===h){if(!(u=this.get_decoration(e.self,te.DecorationArrayStride)))throw new Error("SPIR-V does not define ArrayStride for buffer block.");if(g=this.maybe_get(U,d))a+=g.scalar()*u;else{if(u%o)throw new Error("Array stride for dynamic indexing must be divisible by the size of a 4-component vector. Likely culprit here is a float or vec2 array inside a push constant block which is std430. This cannot be flattened. Try using std140 layout instead.");_+=this.to_enclosed_expression(d)+" * "+le(u/o)+" + "}}else if(c.array.length>0){if(g=this.maybe_get(U,d))a+=g.scalar()*u;else{if(u%o)throw new Error("Array stride for dynamic indexing must be divisible by the size of a 4-component vector. Likely culprit here is a float or vec2 array inside a push constant block which is std430. This cannot be flattened. Try using std140 layout instead.");_+=this.to_enclosed_expression(d,!1)+" * "+le(u/o)+" + "}var f=c.parent_type;(c=this.get(w,f)).array.length>0&&(u=this.get_decoration(f,te.DecorationArrayStride))}else if(c.basetype===L.Struct){if((d=this.evaluate_constant_u32(d))>=c.member_types.length)throw new Error("Member index is out of bounds!");a+=this.type_struct_member_offset(c,d);var m=c;(c=this.get(w,c.member_types[d])).columns>1?(l=this.type_struct_member_matrix_stride(m,d),p=this.combined_decoration_for_member(m,d).get(te.DecorationRowMajor)):p=!1,c.array.length>0&&(u=this.type_struct_member_array_stride(m,d))}else if(c.columns>1){if(g=this.maybe_get(U,d))a+=(d=this.evaluate_constant_u32(d))*(p?c.width/8:l);else{if((b=p?c.width/8:l)%o)throw new Error("Matrix stride for dynamic indexing must be divisible by the size of a 4-component vector. Likely culprit here is a row-major matrix being accessed dynamically. This cannot be flattened. Try using std140 layout instead.");_+=this.to_enclosed_expression(d,!1),_+=" * ",_+=le(b/o),_+=" + "}c=this.get(w,c.parent_type)}else{if(!(c.vecsize>1))throw new Error("Cannot subdivide a scalar value!");var g;if(g=this.maybe_get(U,d))a+=(d=this.evaluate_constant_u32(d))*(p?l:c.width/8);else{var b;if((b=p?l:c.width/8)%o)throw new Error("Stride for dynamic vector indexing must be divisible by the size of a 4-component vector. This cannot be flattened in legacy targets.");_+=this.to_enclosed_expression(d,!1)+" * "+le(b/o)+" + "}c=this.get(w,c.parent_type)}}return s&&(s.need_transpose=p,s.matrix_stride=l,s.array_stride=u),new Oe(_,a)},i.prototype.index_to_swizzle=function(e){switch(e){case 0:default:return"x";case 1:return"y";case 2:return"z";case 3:return"w"}},i.prototype.remap_swizzle=function(e,t,i){if(e.vecsize===t)return i;if(1!==t||this.backend.can_swizzle_scalar){for(var r=this.enclose_expression(i)+".",a=0;a<e.vecsize;a++)r+=this.index_to_swizzle(Math.min(a,t-1));return this.backend.swizzle_is_function&&e.vecsize>1&&(r+="()"),r=this.remove_duplicate_swizzle(r)||r}return this.type_to_glsl(e)+"("+i+")"},i.prototype.declare_temporary=function(e,t){var i=this.get(w,e),r=et(x,this.ir.meta,t).decoration.decoration_flags;if(this.current_continue_block&&!this.hoisted_temporaries.has(t)){var a=this.get(J,this.current_continue_block.loop_dominator);return a.declare_temporary.find((function(i){return i.first===e&&i.second===t}))||(a.declare_temporary.push(new Oe(e,t)),this.hoisted_temporaries.add(t),this.force_recompile()),this.to_name(t)+" = "}return this.hoisted_temporaries.has(t)?this.to_name(t)+" = ":(this.add_local_variable_name(t),this.flags_to_qualifiers_glsl(i,r)+this.variable_decl(i,this.to_name(t))+" = ")},i.prototype.emit_uninitialized_temporary=function(e,t){if(this.current_continue_block&&!this.hoisted_temporaries.has(t)){var i=this.get(J,this.current_continue_block.loop_dominator);i.declare_temporary.find((function(i){return i.first===e&&i.second===t}))||(i.declare_temporary.push(new Oe(e,t)),this.hoisted_temporaries.add(t),this.force_recompile())}else if(!this.hoisted_temporaries.has(t)){var r=this.get(w,e),a=et(x,this.ir.meta,t).decoration.decoration_flags;this.add_local_variable_name(t);var o="";this.options.force_zero_initialized_variables&&this.type_can_zero_initialize(r)&&(o=" = "+this.to_zero_initialized_expression(e)),this.statement(this.flags_to_qualifiers_glsl(r,a),this.variable_decl(r,this.to_name(t)),o,";")}},i.prototype.emit_uninitialized_temporary_expression=function(e,t){return this.forced_temporaries.add(t),this.emit_uninitialized_temporary(e,t),this.set(oe,t,this.to_name(t),e,!0)},i.prototype.append_global_func_args=function(e,t,i){for(var r=e.arguments,a=r.length,o=t;o<a;o++){var s=r[o];console.assert(s.alias_global_variable);var n=this.get(E,s.id).basevariable;n&&this.flush_variable_declaration(n),i.push(this.to_func_call_arg(s,s.id))}},i.prototype.to_non_uniform_aware_expression=function(e){var t=this.to_expression(e);return this.has_decoration(e,te.DecorationNonUniform)&&(t=this.convert_non_uniform_expression(t,e)),t},i.prototype.to_expression=function(e,i){void 0===i&&(i=!0),this.invalid_expressions.hasOwnProperty(e)&&this.handle_invalid_expression(e);var r=this.ir;if(r.ids[e].get_type()===t.TypeExpression)for(var a=0,o=this.get(oe,e).expression_dependencies;a<o.length;a++){var s=o[a];this.invalid_expressions.hasOwnProperty(s)&&this.handle_invalid_expression(s)}switch(i&&this.track_expression_read(e),r.ids[e].get_type()){case t.TypeExpression:var n=this.get(oe,e);if(n.base_expression)return this.to_enclosed_expression(n.base_expression)+n.expression;if(n.need_transpose){var c=this.get_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypeID),_=this.has_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypePacked);return this.convert_row_major_matrix(n.expression,this.get(w,n.expression_type),c,_)}return this.flattened_structs.hasOwnProperty(e)?this.load_flattened_struct(n.expression,this.get(w,n.expression_type)):this.is_forcing_recompilation()?"_":n.expression;case t.TypeConstant:var p=this.get(U,e),l=this.get(w,p.constant_type);if(this.has_decoration(p.self,te.DecorationBuiltIn))return this.builtin_to_glsl(this.get_decoration(p.self,te.DecorationBuiltIn),v.StorageClassGeneric);if(p.specialization){if(this.backend.workgroup_size_is_hidden){var u=this.get_constant_mapping_to_workgroup_component(p);if(u>=0){var h=this.builtin_to_glsl(m.BuiltInWorkgroupSize,v.StorageClassInput)+this.vector_swizzle(1,u);return l.basetype!==L.UInt&&(h=this.bitcast_expression(l,L.UInt,h)),h}}return this.to_name(e)}return p.is_used_as_lut?this.to_name(e):l.basetype!==L.Struct||this.backend.can_declare_struct_inline?l.array.length>0&&!this.backend.can_declare_arrays_inline?this.to_name(e):this.constant_expression(p):this.to_name(e);case t.TypeConstantOp:return this.to_name(e);case t.TypeVariable:var d=this.get(E,e);if(d.statically_assigned||d.loop_variable&&!d.loop_variable_enable)return this.to_expression(d.static_expression);if(d.deferred_declaration)return d.deferred_declaration=!1,this.variable_decl(d);if(this.flattened_structs.hasOwnProperty(e))return this.load_flattened_struct(this.to_name(e),this.get(w,d.basetype));var f=et(x,r.meta,d.self).decoration;return f.builtin?this.builtin_to_glsl(f.builtin_type,d.storage):this.to_name(e);case t.TypeCombinedImageSampler:throw new Error("Combined image samplers have no default expression representation.");case t.TypeAccessChain:throw new Error("Access chains have no default expression representation.");default:return this.to_name(e)}},i.prototype.to_composite_constructor_expression=function(e,t){var i=this.expression_type(e),r=this.backend;return i.array.length>0&&(!r.array_is_value_type||t&&!r.buffer_offset_array_is_value_type)?this.to_rerolled_array_expression(this.to_enclosed_expression(e),i):this.to_unpacked_expression(e)},i.prototype.to_rerolled_array_expression=function(e,t){for(var i=this.to_array_size_literal(t),r=this.get(w,t.parent_type),a="{ ",o=0;o<i;o++){var s=e+"["+le(o)+"]";0===r.array.length?a+=s:a+=this.to_rerolled_array_expression(s,r),o+1<i&&(a+=", ")}return a+=" }"},i.prototype.to_enclosed_expression=function(e,t){return void 0===t&&(t=!0),this.enclose_expression(this.to_expression(e,t))},i.prototype.to_unpacked_expression=function(e,t){void 0===t&&(t=!0);var i=this.maybe_get(oe,e),r=!!i&&i.need_transpose,a=this.has_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypeID),o=this.has_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypePacked);return r||!a&&!o?this.to_expression(e,t):this.unpack_expression_type(this.to_expression(e,t),this.get_pointee_type(this.expression_type_id(e)),this.get_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypeID),this.has_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypePacked),!1)},i.prototype.to_unpacked_row_major_matrix_expression=function(e){return this.unpack_expression_type(this.to_expression(e),this.expression_type(e),this.get_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypeID),this.has_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypePacked),!0)},i.prototype.to_enclosed_unpacked_expression=function(e,t){return void 0===t&&(t=!0),this.enclose_expression(this.to_unpacked_expression(e,t))},i.prototype.to_dereferenced_expression=function(e,t){void 0===t&&(t=!0);var i=this.expression_type(e);return i.pointer&&this.should_dereference(e)?this.dereference_expression(i,this.to_enclosed_expression(e,t)):this.to_expression(e,t)},i.prototype.to_pointer_expression=function(e,t){return void 0===t&&(t=!0),this.expression_type(e).pointer&&this.expression_is_lvalue(e)&&!this.should_dereference(e)?this.address_of_expression(this.to_enclosed_expression(e,t)):this.to_unpacked_expression(e,t)},i.prototype.to_enclosed_pointer_expression=function(e,t){return void 0===t&&(t=!0),this.expression_type(e).pointer&&this.expression_is_lvalue(e)&&!this.should_dereference(e)?this.address_of_expression(this.to_enclosed_expression(e,t)):this.to_enclosed_unpacked_expression(e,t)},i.prototype.to_extract_component_expression=function(e,t){var i=this.to_enclosed_expression(e);return this.has_extended_decoration(e,b.SPIRVCrossDecorationPhysicalTypePacked)?i+"["+t+"]":i+"."+this.index_to_swizzle(t)},i.prototype.to_extract_constant_composite_expression=function(e,t,i,r,a){var o=new U;o.constant_type=e;var s=this.get(w,t.constant_type);return console.assert(s.basetype!==L.Struct&&0===s.array.length),console.assert(!t.specialization),this.is_matrix(s)?2===a?(o.m.c[0].vecsize=1,o.m.columns=1,o.m.c[0].r[0]=t.m.c[i[r]].r[i[r+1]]):(console.assert(1===a),o.m.c[0].vecsize=s.vecsize,o.m.columns=1,o.m.c[0]=t.m.c[i[r]]):(console.assert(1===a),o.m.c[0].vecsize=1,o.m.columns=1,o.m.c[0].r[0]=t.m.c[0].r[i[r]]),this.constant_expression(o)},i.prototype.enclose_expression=function(e){var t=!1,i=e.length;i>0&&("-"!==(o=e.charAt(0))&&"+"!==o&&"!"!==o&&"~"!==o&&"&"!==o&&"*"!==o||(t=!0));if(!t){for(var r=0,a=0;a<i;++a){var o;if("("===(o=e.charAt(a))||"["===o)r++;else if(")"===o||"]"===o)console.assert(r),r--;else if(" "===o&&0===r){t=!0;break}}console.assert(0===r)}return t?"("+e+")":e},i.prototype.dereference_expression=function(e,t){return"&"===t.charAt(0)?t.substring(1):this.backend.native_pointers?"*"+t:e.storage===v.StorageClassPhysicalStorageBufferEXT&&e.basetype!==L.Struct&&1===e.pointer_depth?this.enclose_expression(t)+".value":t},i.prototype.address_of_expression=function(e){return e.length>3&&"("===e.charAt(0)&&"*"===e.charAt(1)&&")"===e.charAt(e.length-1)?this.enclose_expression(e.substring(2,e.length-1)):"*"===e.charAt(0)?e.substr(1):"&"+this.enclose_expression(e)},i.prototype.strip_enclosed_expression=function(e){var t=e.length,i=e.charAt(t-1);if(t<2||"("!==e.charAt(0)||")"!==i)return e;for(var r=0,a=0;a<t;++a){var o=e.charAt(a);if("("===o)r++;else if(")"===o&&0===--r&&o!==i)return e}return e.substring(1,t-1)},i.prototype.to_member_name=function(e,t){if(0!==e.type_alias&&!this.has_extended_decoration(e.type_alias,b.SPIRVCrossDecorationBufferBlockRepacked))return this.to_member_name(this.get(w,e.type_alias),t);var i=et(x,this.ir.meta,e.self).members;return t<i.length&&""!==i[t].alias?i[t].alias:"_m"+t},i.prototype.to_member_reference=function(e,t,i,r){return"."+this.to_member_name(t,i)},i.prototype.to_multi_member_reference=function(e,t){for(var i="",r=e,a=0;a<t.length;++a){var o=t[a];i+="."+this.to_member_name(r,o),r=this.get(w,r.member_types[o])}return i},i.prototype.type_to_glsl_constructor=function(e){var t=this.options,i=this.backend;if(i.use_array_constructor&&e.array.length>1){if(t.flatten_multidimensional_arrays)throw new Error("Cannot flatten constructors of multidimensional array constructors, e.g. float[][]().");if(!t.es&&t.version<430)this.require_extension_internal("GL_ARB_arrays_of_arrays");else if(t.es&&t.version<310)throw new Error("Arrays of arrays not supported before ESSL version 310.")}var r=this.type_to_glsl(e);if(i.use_array_constructor)for(var a=0;a<e.array.length;a++)r+="[]";return r},i.prototype.argument_decl=function(e){var t=this.expression_type(e.id),i="";return t.pointer&&(e.write_count&&e.read_count?i="inout ":e.write_count&&(i="out ")),(""===i?"":i+" ")+this.to_qualifiers_glsl(e.id)+this.variable_decl(t,this.to_name(e.id),e.id)},i.prototype.to_qualifiers_glsl=function(e){var t=this.ir,i=this.backend,r=et(x,t.meta,e).decoration.decoration_flags,a="",o=this.maybe_get(E,e);o&&o.storage===v.StorageClassWorkgroup&&!i.shared_is_implied&&(a+="shared "),a+=this.to_interpolation_qualifiers(r),o&&(a+=this.to_storage_qualifiers_glsl(o));var s=this.expression_type(e);if(s.image.dim!==Ge.DimSubpassData&&2===s.image.sampled){r.get(te.DecorationCoherent)&&(a+="coherent "),r.get(te.DecorationRestrict)&&(a+="restrict "),r.get(te.DecorationNonWritable)&&(a+="readonly ");var n=s.image.format===ut.ImageFormatUnknown;if(r.get(te.DecorationNonReadable)&&(a+="writeonly ",n=!1),n){if(this.options.es)throw new Error("Cannot use GL_EXT_shader_image_load_formatted in ESSL.");this.require_extension_internal("GL_EXT_shader_image_load_formatted")}}return a+=this.to_precision_qualifiers_glsl(e)},i.prototype.fixup_io_block_patch_qualifiers=function(e){var t=this.get(w,e.basetype);if(this.has_decoration(t.self,te.DecorationBlock)){for(var i=t.member_types.length,r=0;r<i;r++)if(this.has_member_decoration(t.self,r,te.DecorationPatch)){this.set_decoration(e.self,te.DecorationPatch);break}if(this.has_decoration(e.self,te.DecorationPatch))for(r=0;r<i;r++)this.unset_member_decoration(t.self,r,te.DecorationPatch)}},i.prototype.emit_output_variable_initializer=function(e){var t=this,i=this.ir,r=this.get(j,i.default_entry_point),a=this.get(w,e.basetype),o=this.has_decoration(e.self,te.DecorationPatch),s=this.has_decoration(a.self,te.DecorationBlock),n=this.get_execution_model()===Se.ExecutionModelTessellationControl&&!o;if(s){var c=a.member_types.length,_=1===a.array.length,p=1;_&&(p=this.to_array_size_literal(a));for(var l=n?1:p,u=function(s){if(h.has_member_decoration(a.self,s,te.DecorationBuiltIn)){if(h.get_member_decoration(a.self,s,te.DecorationBuiltIn)===m.BuiltInCullDistance&&!h.cull_distance_count)return"continue";if(h.get_member_decoration(a.self,s,te.DecorationBuiltIn)===m.BuiltInClipDistance&&!h.clip_distance_count)return"continue"}var c;if(_){c="_".concat(e.self,"_").concat(s,"_init");var u=h.get(w,e.basetype).member_types[s],d=h.get(w,u);d.parent_type=u,d.array.push(p),d.array_size_literal.push(!0);for(var f=[],g=h.get(U,e.initializer),b=0;b<p;b++)f.push(h.to_expression(h.get(U,g.subconstants[b]).subconstants[s]));h.statement("const ",h.type_to_glsl(d)," ",c,h.type_to_array_glsl(d)," = ",h.type_to_glsl_constructor(d),"(",f.join(", "),");")}var y=function(a){r.fixup_hooks_in.push((function(){var r=new Tt,p=t.get(U,e.initializer),l=0,u=0;if(n){var h=i.increase_bound_by(3),d=new w;d.basetype=L.UInt,d.width=32,t.set(w,h,d),t.set(oe,h+1,t.builtin_to_glsl(m.BuiltInInvocationId,v.StorageClassInput),h,!0),t.set(U,h+2,h,s,!1),l=h+1,u=h+2}if(o&&(t.statement("if (gl_InvocationID === 0)"),t.begin_scope()),_&&!n){var f=[a,s],g=t.access_chain_internal(e.self,f,0,2,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT,r);t.statement(g," = ",c,"[",a,"];")}else if(n){f=[l,u],g=t.access_chain_internal(e.self,f,0,2,0,r);t.statement(g," = ",c,"[",t.builtin_to_glsl(m.BuiltInInvocationId,v.StorageClassInput),"];")}else{g=t.access_chain_internal(e.self,[s],0,1,kt.ACCESS_CHAIN_INDEX_IS_LITERAL_BIT,r);t.statement(g," = ",t.to_expression(p.subconstants[s]),";")}o&&t.end_scope()}))};for(b=0;b<l;b++)y(b)},h=this,d=0;d<c;d++)u(d)}else if(n){var f="_".concat(e.self,"_init");this.statement("const ",this.type_to_glsl(a)," ",f,this.type_to_array_glsl(a)," = ",this.to_expression(e.initializer),";"),r.fixup_hooks_in.push((function(){t.statement(t.to_expression(e.self),"[gl_InvocationID] = ",f,"[gl_InvocationID];")}))}else if(this.has_decoration(e.self,te.DecorationBuiltIn)&&this.get_decoration(e.self,te.DecorationBuiltIn)===m.BuiltInSampleMask)r.fixup_hooks_in.push((function(){for(var i=t.get(U,e.initializer),r=i.subconstants.length,a=0;a<r;a++)t.statement(t.to_expression(e.self),"[",a,"] = ",le(t.get(U,i.subconstants[a]).scalar_i32()),";")}));else{var g="".concat(e.self,"_init");this.statement("const ",this.type_to_glsl(a)," ",g,this.type_to_array_glsl(a)," = ",this.to_expression(e.initializer),";"),r.fixup_hooks_in.push((function(){o&&(t.statement("if (gl_InvocationID === 0)"),t.begin_scope()),t.statement(t.to_expression(e.self)," = ",g,";"),o&&t.end_scope()}))}},i.prototype.to_precision_qualifiers_glsl=function(e){var t=this.expression_type(e);if(this.backend.allow_precision_qualifiers&&(t.basetype===L.Image||t.basetype===L.SampledImage)&&this.get(w,t.image.type).width<32)return"mediump ";return this.flags_to_qualifiers_glsl(t,et(x,this.ir.meta,e).decoration.decoration_flags)},i.prototype.to_storage_qualifiers_glsl=function(e){var t=this.get_entry_point();if(this.subpass_input_is_framebuffer_fetch(e.self))return"";if(e.storage===v.StorageClassInput||e.storage===v.StorageClassOutput){if(this.is_legacy()&&t.model===Se.ExecutionModelVertex)return e.storage===v.StorageClassInput?"attribute ":"varying ";if(this.is_legacy()&&t.model===Se.ExecutionModelFragment)return"varying ";if(t.model===Se.ExecutionModelFragment&&e.storage===v.StorageClassOutput){var i=this.get_decoration(e.self,te.DecorationLocation);return this.location_is_framebuffer_fetch(i)?"inout ":"out "}return e.storage===v.StorageClassInput?"in ":"out "}if(e.storage===v.StorageClassUniformConstant||e.storage===v.StorageClassUniform||e.storage===v.StorageClassPushConstant)return"uniform ";if(e.storage===v.StorageClassRayPayloadKHR)throw new Error("Raytracing not supported");if(e.storage===v.StorageClassIncomingRayPayloadKHR)throw new Error("Raytracing not supported");if(e.storage===v.StorageClassHitAttributeKHR)throw new Error("Raytracing not supported");if(e.storage===v.StorageClassCallableDataKHR)throw new Error("Raytracing not supported");if(e.storage===v.StorageClassIncomingCallableDataKHR)throw new Error("Raytracing not supported");return""},i.prototype.flags_to_qualifiers_glsl=function(e,t){if(t.get(te.DecorationRestrictPointerEXT))return"restrict ";var i=this.backend,r=this.options,a="";if(gt(e)&&t.get(te.DecorationNoContraction)&&i.support_precise_qualifier&&(a="precise "),!(e.basetype===L.Float||e.basetype===L.Int||e.basetype===L.UInt||e.basetype===L.Image||e.basetype===L.SampledImage||e.basetype===L.Sampler))return a;if(r.es){var o=this.get_entry_point();if(t.get(te.DecorationRelaxedPrecision)){var s=e.basetype===L.Float&&r.fragment.default_float_precision===It.Mediump&&o.model===Se.ExecutionModelFragment,n=(e.basetype===L.Int||e.basetype===L.UInt)&&r.fragment.default_int_precision===It.Mediump&&o.model===Se.ExecutionModelFragment;a+=s||n?"":"mediump "}else{var c=e.basetype===L.Float&&(r.fragment.default_float_precision===It.Highp&&o.model===Se.ExecutionModelFragment||o.model!==Se.ExecutionModelFragment),_=(e.basetype===L.Int||e.basetype===L.UInt)&&(r.fragment.default_int_precision===It.Highp&&o.model===Se.ExecutionModelFragment||o.model!==Se.ExecutionModelFragment);a+=c||_?"":"highp "}}else i.allow_precision_qualifiers&&t.get(te.DecorationRelaxedPrecision)&&(a+="mediump ");return a},i.prototype.format_to_glsl=function(e){if(this.options.es&&this.is_desktop_only_format(e))throw new Error("Attempting to use image format not supported in ES profile.");switch(e){case ut.ImageFormatRgba32f:return"rgba32f";case ut.ImageFormatRgba16f:return"rgba16f";case ut.ImageFormatR32f:return"r32f";case ut.ImageFormatRgba8:return"rgba8";case ut.ImageFormatRgba8Snorm:return"rgba8_snorm";case ut.ImageFormatRg32f:return"rg32f";case ut.ImageFormatRg16f:return"rg16f";case ut.ImageFormatRgba32i:return"rgba32i";case ut.ImageFormatRgba16i:return"rgba16i";case ut.ImageFormatR32i:return"r32i";case ut.ImageFormatRgba8i:return"rgba8i";case ut.ImageFormatRg32i:return"rg32i";case ut.ImageFormatRg16i:return"rg16i";case ut.ImageFormatRgba32ui:return"rgba32ui";case ut.ImageFormatRgba16ui:return"rgba16ui";case ut.ImageFormatR32ui:return"r32ui";case ut.ImageFormatRgba8ui:return"rgba8ui";case ut.ImageFormatRg32ui:return"rg32ui";case ut.ImageFormatRg16ui:return"rg16ui";case ut.ImageFormatR11fG11fB10f:return"r11f_g11f_b10f";case ut.ImageFormatR16f:return"r16f";case ut.ImageFormatRgb10A2:return"rgb10_a2";case ut.ImageFormatR8:return"r8";case ut.ImageFormatRg8:return"rg8";case ut.ImageFormatR16:return"r16";case ut.ImageFormatRg16:return"rg16";case ut.ImageFormatRgba16:return"rgba16";case ut.ImageFormatR16Snorm:return"r16_snorm";case ut.ImageFormatRg16Snorm:return"rg16_snorm";case ut.ImageFormatRgba16Snorm:return"rgba16_snorm";case ut.ImageFormatR8Snorm:return"r8_snorm";case ut.ImageFormatRg8Snorm:return"rg8_snorm";case ut.ImageFormatR8ui:return"r8ui";case ut.ImageFormatRg8ui:return"rg8ui";case ut.ImageFormatR16ui:return"r16ui";case ut.ImageFormatRgb10a2ui:return"rgb10_a2ui";case ut.ImageFormatR8i:return"r8i";case ut.ImageFormatRg8i:return"rg8i";case ut.ImageFormatR16i:return"r16i";default:return null}},i.prototype.layout_for_member=function(e,t){if(this.is_legacy())return"";if(!(this.has_decoration(e.self,te.DecorationBlock)||this.has_decoration(e.self,te.DecorationBufferBlock)))return"";var i=this.ir,r=this.options,a=et(x,i.meta,e.self).members;if(t>=a.length)return"";var o=a[t],s=[];if(this.has_member_decoration(e.self,t,te.DecorationPassthroughNV)&&s.push("passthrough"),this.combined_decoration_for_member(e,t).get(te.DecorationRowMajor)&&s.push("row_major"),o.decoration_flags.get(te.DecorationLocation)&&this.can_use_io_location(e.storage,!0)&&s.push("location = "+o.location),o.decoration_flags.get(te.DecorationComponent)&&this.can_use_io_location(e.storage,!0)){if(r.es)throw new Error("Component decoration is not supported in ES targets.");if(r.version<440&&r.version>=140)this.require_extension_internal("GL_ARB_enhanced_layouts");else if(r.version<140)throw new Error("Component decoration is not supported in targets below GLSL 1.40.");s.push("component = "+o.component)}if(this.has_extended_decoration(e.self,b.SPIRVCrossDecorationExplicitOffset)&&o.decoration_flags.get(te.DecorationOffset)?s.push("offset = "+o.offset):e.storage===v.StorageClassOutput&&o.decoration_flags.get(te.DecorationOffset)&&s.push("xfb_offset = "+o.offset),0===s.length)return"";var n="layout(";return n+=s.join(", "),n+=") "},i.prototype.to_interpolation_qualifiers=function(e){var t="";if(e.get(te.DecorationFlat)&&(t+="flat "),e.get(te.DecorationNoPerspective)&&(t+="noperspective "),e.get(te.DecorationCentroid)&&(t+="centroid "),e.get(te.DecorationPatch)&&(t+="patch "),e.get(te.DecorationSample)&&(t+="sample "),e.get(te.DecorationInvariant)&&(t+="invariant "),e.get(te.DecorationExplicitInterpAMD)&&(this.require_extension_internal("GL_AMD_shader_explicit_vertex_parameter"),t+="__explicitInterpAMD "),e.get(te.DecorationPerVertexNV)){var i=this.options;if(i.es&&i.version<320)throw new Error("pervertexNV requires ESSL 320.");if(!i.es&&i.version<450)throw new Error("pervertexNV requires GLSL 450.");this.require_extension_internal("GL_NV_fragment_shader_barycentric"),t+="pervertexNV "}return t},i.prototype.layout_for_variable=function(e){if(this.is_legacy())return"";if(this.subpass_input_is_framebuffer_fetch(e.self))return"";var t=this.options,i=this.ir,r=[],a=this.get(w,e.basetype),o=this.get_decoration_bitset(e.self),s=this.get_decoration_bitset(a.self);o.get(te.DecorationPassthroughNV)&&r.push("passthrough"),o.get(te.DecorationRowMajor)&&r.push("row_major"),o.get(te.DecorationColMajor)&&r.push("column_major");var n=this.has_decoration(a.self,te.DecorationBlock);if(o.get(te.DecorationLocation)&&this.can_use_io_location(e.storage,n)){for(var c=new y,_=et(x,i.meta,a.self).members,p=0;p<_.length;p++)c.merge_or(this.combined_decoration_for_member(a,p));c.get(te.DecorationLocation)||r.push("location = "+this.get_decoration(e.self,te.DecorationLocation))}this.get_execution_model()===Se.ExecutionModelFragment&&e.storage===v.StorageClassOutput&&this.location_is_non_coherent_framebuffer_fetch(this.get_decoration(e.self,te.DecorationLocation))&&r.push("noncoherent");var l=!1;if(n&&e.storage===v.StorageClassOutput){var u=a.member_types.length,h=!1,d=!1,f=!1,m=0,g=0,b=0;o.get(te.DecorationXfbBuffer)&&o.get(te.DecorationXfbStride)&&(h=!0,g=this.get_decoration(e.self,te.DecorationXfbBuffer),m=this.get_decoration(e.self,te.DecorationXfbStride)),o.get(te.DecorationStream)&&(f=!0,b=this.get_decoration(e.self,te.DecorationStream));for(p=0;p<u;p++){if(this.has_member_decoration(a.self,p,te.DecorationStream)){var S=this.get_member_decoration(a.self,p,te.DecorationStream);if(f&&S!==b)throw new Error("IO block member Stream mismatch.");f=!0,b=S}if(this.has_member_decoration(a.self,p,te.DecorationOffset)){if(d=!0,this.has_member_decoration(a.self,p,te.DecorationXfbBuffer)){var I=this.get_member_decoration(a.self,p,te.DecorationXfbBuffer);if(h&&I!==g)throw new Error("IO block member XfbBuffer mismatch.");h=!0,g=I}if(this.has_member_decoration(a.self,p,te.DecorationXfbStride)){var O=this.get_member_decoration(a.self,p,te.DecorationXfbStride);if(h&&O!==m)throw new Error("IO block member XfbStride mismatch.");h=!0,m=O}}}if(h&&d&&(r.push("xfb_buffer = "+g),r.push("xfb_stride = "+m),l=!0),f){if(this.get_execution_model()!==Se.ExecutionModelGeometry)throw new Error("Geometry streams can only be used in geometry shaders.");if(t.es)throw new Error("Multiple geometry streams not supported in ESSL.");t.version<400&&this.require_extension_internal("GL_ARB_transform_feedback3"),r.push("stream = "+this.get_decoration(e.self,te.DecorationStream))}}else if(e.storage===v.StorageClassOutput&&(o.get(te.DecorationXfbBuffer)&&o.get(te.DecorationXfbStride)&&o.get(te.DecorationOffset)&&(r.push("xfb_buffer = "+this.get_decoration(e.self,te.DecorationXfbBuffer)),r.push("xfb_stride = "+this.get_decoration(e.self,te.DecorationXfbStride)),r.push("xfb_offset = "+this.get_decoration(e.self,te.DecorationOffset)),l=!0),o.get(te.DecorationStream))){if(this.get_execution_model()!==Se.ExecutionModelGeometry)throw new Error("Geometry streams can only be used in geometry shaders.");if(t.es)throw new Error("Multiple geometry streams not supported in ESSL.");t.version<400&&this.require_extension_internal("GL_ARB_transform_feedback3"),r.push("stream = "+this.get_decoration(e.self,te.DecorationStream))}if(o.get(te.DecorationComponent)&&this.can_use_io_location(e.storage,n)&&(l=!0,r.push("component = "+this.get_decoration(e.self,te.DecorationComponent))),l)if(t.es){if(t.es)throw new Error("GL_ARB_enhanced_layouts is not supported in ESSL.")}else{if(t.version<440&&t.version>=140)this.require_extension_internal("GL_ARB_enhanced_layouts");else if(t.version<140)throw new Error("GL_ARB_enhanced_layouts is not supported in targets below GLSL 1.40.");!t.es&&t.version<440&&this.require_extension_internal("GL_ARB_enhanced_layouts")}o.get(te.DecorationIndex)&&r.push("index = "+this.get_decoration(e.self,te.DecorationIndex));var k,E=e.storage===v.StorageClassStorageBuffer||e.storage===v.StorageClassShaderRecordBufferKHR||e.storage===v.StorageClassUniform&&s.get(te.DecorationBufferBlock),C=e.storage===v.StorageClassPushConstant&&t.emit_push_constant_as_uniform_buffer,T=e.storage===v.StorageClassUniform&&s.get(te.DecorationBlock),D=t.es&&t.version>=300||!t.es&&t.version>=140;if(T&&t.emit_uniform_buffer_as_plain_uniforms&&(D=!1),k=t.es?t.version>=310:t.enable_420pack_extension||t.version>=420,D||e.storage!==v.StorageClassUniform||(k=!1),e.storage===v.StorageClassShaderRecordBufferKHR&&(k=!1),k&&o.get(te.DecorationBinding)&&r.push("binding = "+this.get_decoration(e.self,te.DecorationBinding)),e.storage!==v.StorageClassOutput&&o.get(te.DecorationOffset)&&r.push("offset = "+this.get_decoration(e.self,te.DecorationOffset)),D&&(T||C)?r.push(this.buffer_to_packing_standard(a,!1)):D&&E&&r.push(this.buffer_to_packing_standard(a,!0)),a.basetype===L.Image&&2===a.image.sampled){var R=this.format_to_glsl(a.image.format);R&&r.push(R)}return 0===r.length?"":"layout("+r.join(", ")+") "},i.prototype.to_combined_image_sampler=function(e,t){var i=this.to_non_uniform_aware_expression(e),r="",a=i.indexOf("[");a>=0&&(r=i.substring(a));var o=this.current_function.arguments,s=this.maybe_get_backing_variable(e),n=this.maybe_get_backing_variable(t);s&&(e=s.self),n&&(t=n.self);var c=o.find((function(t){return e===t.id})),_=o.find((function(e){return t===e.id}));if(c||_){var p=!c,l=!_,u=p?e:o.indexOf(c),h=l?t:o.indexOf(_);if(d=this.current_function.combined_parameters.find((function(e){return e.global_image===p&&e.global_sampler===l&&e.image_id===u&&e.sampler_id===h})))return this.to_expression(d.id)+r;throw new Error("Cannot find mapping for combined sampler parameter, was build_combined_image_samplers() used before compile() was called?")}var d=this.combined_image_samplers.find((function(i){return i.image_id===e&&i.sampler_id===t}));if(d)return this.to_expression(d.combined_id)+r;throw new Error("Cannot find mapping for combined sampler, was build_combined_image_samplers() used before compile() was called?")},i.prototype.skip_argument=function(e){var t=this.expression_type(e);return t.basetype===L.Sampler||t.basetype===L.Image&&1===t.image.sampled},i.prototype.emit_array_copy=function(e,t,i,r,a){this.statement(e," = ",this.to_expression(i),";")},i.prototype.emit_block_hints=function(e){var t=this.options;if(!(t.es&&t.version<310||!t.es&&t.version<140))switch(e.hint){case B.HintFlatten:this.require_extension_internal("GL_EXT_control_flow_attributes"),this.statement("SPIRV_CROSS_FLATTEN");break;case B.HintDontFlatten:this.require_extension_internal("GL_EXT_control_flow_attributes"),this.statement("SPIRV_CROSS_BRANCH");break;case B.HintUnroll:this.require_extension_internal("GL_EXT_control_flow_attributes"),this.statement("SPIRV_CROSS_UNROLL");break;case B.HintDontUnroll:this.require_extension_internal("GL_EXT_control_flow_attributes"),this.statement("SPIRV_CROSS_LOOP")}},i.prototype.to_initializer_expression=function(e){return this.to_unpacked_expression(e.initializer)},i.prototype.to_zero_initialized_expression=function(e){var t=this.ir,i=t.increase_bound_by(1);return t.make_constant_null(i,e,!1),this.constant_expression(this.get(U,i))},i.prototype.type_can_zero_initialize=function(e){if(e.pointer)return!1;if(e.array.length>0&&this.options.flatten_multidimensional_arrays)return!1;for(var t=0,i=e.array_size_literal;t<i.length;t++){if(!i[t])return!1}for(var r=0,a=e.member_types;r<a.length;r++){var o=a[r];if(!this.type_can_zero_initialize(this.get(w,o)))return!1}return!0},i.prototype.buffer_is_packing_standard=function(e,t,i,r,a){void 0===i&&(i=null),void 0===r&&(r=0),void 0===a&&(a=void 0);for(var o=0,s=1,n=this.has_decoration(e.self,te.DecorationBlock)||this.has_decoration(e.self,te.DecorationBufferBlock),c=this.ir,_=0;_<e.member_types.length;_++){var p=this.get(w,e.member_types[_]),l=et(x,c.meta,e.self).members[_].decoration_flags,u=this.type_to_packed_alignment(p,l,t),h=0;n&&_+1===e.member_types.length&&p.array.length>0||(h=this.type_to_packed_size(p,l,t));var d=this.type_struct_member_offset(e,_);if(void 0!==a&&d>=a)break;var f=Math.max(u,s);if(o=o+f-1&~(f-1),s=p.basetype!==L.Struct||p.pointer?1:u,d>=r){if(Xt(t)){if(0!=(d&f-1))return i&&(i[0]=_),!1}else if(d!==o)return i&&(i[0]=_),!1;if(p.array.length>0&&this.type_to_packed_array_stride(p,l,t)!=this.type_struct_member_array_stride(e,_))return i&&(i[0]=_),!1;var m=jt(t);if(!p.pointer&&p.member_types.length>0&&!this.buffer_is_packing_standard(p,m))return i&&(i[0]=_),!1}o=d+h}return!0},i.prototype.buffer_to_packing_standard=function(e,t){var i=this.options;if(t&&this.buffer_is_packing_standard(e,Lt.BufferPackingStd430))return"std430";if(this.buffer_is_packing_standard(e,Lt.BufferPackingStd140))return"std140";if(t&&this.buffer_is_packing_standard(e,Lt.BufferPackingStd430EnhancedLayout)){if(i.es)throw new Error("Push constant block cannot be expressed as neither std430 nor std140. ES-targets do not support GL_ARB_enhanced_layouts.");return this.set_extended_decoration(e.self,b.SPIRVCrossDecorationExplicitOffset),"std430"}if(this.buffer_is_packing_standard(e,Lt.BufferPackingStd140EnhancedLayout)){if(i.es)throw new Error("Push constant block cannot be expressed as neither std430 nor std140. ES-targets do not support GL_ARB_enhanced_layouts.");return!i.es&&/*!options.vulkan_semantics &&*/i.version<440&&this.require_extension_internal("GL_ARB_enhanced_layouts"),this.set_extended_decoration(e.self,b.SPIRVCrossDecorationExplicitOffset),"std140"}throw new Error("Buffer block cannot be expressed as any of std430, std140, scalar, even with enhanced layouts. You can try flattening this block to support a more flexible layout.")},i.prototype.type_to_packed_base_size=function(e,t){switch(e.basetype){case L.Double:case L.Int64:case L.UInt64:return 8;case L.Float:case L.Int:case L.UInt:return 4;case L.Half:case L.Short:case L.UShort:return 2;case L.SByte:case L.UByte:return 1;default:throw new Error("Unrecognized type in type_to_packed_base_size.")}},i.prototype.type_to_packed_alignment=function(e,t,i){var r=this.ir;if(e.storage===v.StorageClassPhysicalStorageBufferEXT){if(!e.pointer)throw new Error("Types in PhysicalStorageBufferEXT must be pointers.");if(r.addressing_model===$.AddressingModelPhysicalStorageBuffer64EXT)return Wt(i)&&this.type_is_array_of_pointers(e)?16:8;throw new Error("AddressingModelPhysicalStorageBuffer64EXT must be used for PhysicalStorageBufferEXT.")}if(e.array.length){var a=1;Wt(i)&&(a=16);for(var o=this.get(w,e.parent_type);o.array.length;)o=this.get(w,o.parent_type);return Math.max(a,this.type_to_packed_alignment(o,t,i))}if(e.basetype===L.Struct){for(var s=1,n=0;n<e.member_types.length;n++){var c=et(x,r.meta,e.self).members[n].decoration_flags;s=Math.max(s,this.type_to_packed_alignment(this.get(w,e.member_types[n]),c,i))}return Wt(i)&&(s=Math.max(s,16)),s}var _=this.type_to_packed_base_size(e,i);if(Qt(i))return _;if(1===e.vecsize&&1===e.columns)return _;if((2===e.vecsize||4===e.vecsize)&&1===e.columns)return e.vecsize*_;if(3===e.vecsize&&1===e.columns)return 4*_;if(t.get(te.DecorationColMajor)&&e.columns>1)return Wt(i)||3===e.vecsize?4*_:e.vecsize*_;if(t.get(te.DecorationRowMajor)&&e.vecsize>1)return Wt(i)||3===e.columns?4*_:e.columns*_;throw new Error("Did not find suitable rule for type. Bogus decorations?")},i.prototype.type_to_packed_array_stride=function(e,t,i){var r=e.parent_type;console.assert(r);var a=this.get(w,r),o=this.type_to_packed_size(a,t,i),s=this.type_to_packed_alignment(e,t,i);return o+s-1&~(s-1)},i.prototype.type_to_packed_size=function(e,t,i){if(e.array.length)return this.to_array_size_literal(e)*this.type_to_packed_array_stride(e,t,i);var r=this.ir;if(e.storage===v.StorageClassPhysicalStorageBufferEXT){if(!e.pointer)throw new Error("Types in PhysicalStorageBufferEXT must be pointers.");if(r.addressing_model===$.AddressingModelPhysicalStorageBuffer64EXT)return 8;throw new Error("AddressingModelPhysicalStorageBuffer64EXT must be used for PhysicalStorageBufferEXT.")}var a=0;if(e.basetype===L.Struct)for(var o=1,s=0;s<e.member_types.length;s++){var n=et(x,r.meta,e.self).members[s].decoration_flags,c=this.get(w,e.member_types[s]),_=this.type_to_packed_alignment(c,n,i),p=Math.max(_,o);o=c.basetype===L.Struct?_:1,a=a+p-1&~(p-1),a+=this.type_to_packed_size(c,n,i)}else{var l=this.type_to_packed_base_size(e,i);Qt(i)?a=e.vecsize*e.columns*l:(1===e.columns&&(a=e.vecsize*l),t.get(te.DecorationColMajor)&&e.columns>1&&(a=Wt(i)||3===e.vecsize?4*e.columns*l:e.columns*e.vecsize*l),t.get(te.DecorationRowMajor)&&e.vecsize>1&&(a=Wt(i)||3===e.columns?4*e.vecsize*l:e.vecsize*e.columns*l))}return a},i.prototype.bitcast_glsl_op=function(e,t){if(e.pointer||t.pointer)return 2!==e.vecsize&&2!==t.vecsize||this.require_extension_internal("GL_EXT_buffer_reference_uvec2"),this.type_to_glsl(e);if(e.basetype===t.basetype)return"";var i=this.options;console.assert(e.basetype!==L.Boolean),console.assert(t.basetype!==L.Boolean);var r=bt(e)&&bt(t),a=e.width===t.width;if(r&&a)return this.type_to_glsl(e);if(8===e.width&&t.width>=16&&r&&1===t.vecsize)return"unpack8";if(8===t.width&&16===e.width&&r&&1===e.vecsize)return"pack16";if(8===t.width&&32===e.width&&r&&1===e.vecsize)return"pack32";if(e.basetype===L.UInt&&t.basetype===L.Float){if(this.is_legacy_es())throw new Error("Float -> Uint bitcast not supported on legacy ESSL.");return!i.es&&i.version<330&&this.require_extension_internal("GL_ARB_shader_bit_encoding"),"floatBitsToUint"}if(e.basetype===L.Int&&t.basetype===L.Float){if(this.is_legacy_es())throw new Error("Float -> Int bitcast not supported on legacy ESSL.");return!i.es&&i.version<330&&this.require_extension_internal("GL_ARB_shader_bit_encoding"),"floatBitsToInt"}if(e.basetype===L.Float&&t.basetype===L.UInt){if(this.is_legacy_es())throw new Error("Uint -> Float bitcast not supported on legacy ESSL.");return!i.es&&i.version<330&&this.require_extension_internal("GL_ARB_shader_bit_encoding"),"uintBitsToFloat"}if(e.basetype===L.Float&&t.basetype===L.Int){if(this.is_legacy_es())throw new Error("Int -> Float bitcast not supported on legacy ESSL.");return!i.es&&i.version<330&&this.require_extension_internal("GL_ARB_shader_bit_encoding"),"intBitsToFloat"}return e.basetype===L.Int64&&t.basetype===L.Double?"doubleBitsToInt64":e.basetype===L.UInt64&&t.basetype===L.Double?"doubleBitsToUint64":e.basetype===L.Double&&t.basetype===L.Int64?"int64BitsToDouble":e.basetype===L.Double&&t.basetype===L.UInt64?"uint64BitsToDouble":e.basetype===L.Short&&t.basetype===L.Half?"float16BitsToInt16":e.basetype===L.UShort&&t.basetype===L.Half?"float16BitsToUint16":e.basetype===L.Half&&t.basetype===L.Short?"int16BitsToFloat16":e.basetype===L.Half&&t.basetype===L.UShort?"uint16BitsToFloat16":e.basetype===L.UInt64&&t.basetype===L.UInt&&2===t.vecsize?"packUint2x32":e.basetype===L.UInt&&t.basetype===L.UInt64&&2===e.vecsize?"unpackUint2x32":e.basetype===L.Half&&t.basetype===L.UInt&&1===t.vecsize?"unpackFloat2x16":e.basetype===L.UInt&&t.basetype===L.Half&&2===t.vecsize?"packFloat2x16":e.basetype===L.Int&&t.basetype===L.Short&&2===t.vecsize?"packInt2x16":e.basetype===L.Short&&t.basetype===L.Int&&1===t.vecsize?"unpackInt2x16":e.basetype===L.UInt&&t.basetype===L.UShort&&2===t.vecsize?"packUint2x16":e.basetype===L.UShort&&t.basetype===L.UInt&&1===t.vecsize?"unpackUint2x16":e.basetype===L.Int64&&t.basetype===L.Short&&4===t.vecsize?"packInt4x16":e.basetype===L.Short&&t.basetype===L.Int64&&1===t.vecsize?"unpackInt4x16":e.basetype===L.UInt64&&t.basetype===L.UShort&&4===t.vecsize?"packUint4x16":e.basetype===L.UShort&&t.basetype===L.UInt64&&1===t.vecsize?"unpackUint4x16":""},i.prototype.bitcast_glsl=function(e,t){var i=this.bitcast_glsl_op(e,this.expression_type(t));return""===i?this.to_enclosed_unpacked_expression(t):i+"("+this.to_unpacked_expression(t)+")"},i.prototype.bitcast_expression=function(e,t,i){if(void 0===i){if(e=e,i=this.to_expression(t),(a=this.expression_type(t)).basetype!==e){var r=a;r.basetype=e,i=this.bitcast_glsl_op(r,a)+"("+i+")"}return i}var a,o=t;return(e=e).basetype===o?i:((a=e).basetype=o,this.bitcast_glsl_op(e,a)+"("+i+")")},i.prototype.build_composite_combiner=function(e,t,i,r){for(var a=0,o="",s="",n=this.get(w,e),c=n.basetype!==L.Struct&&0===n.array.length&&1===n.columns,_=!1,p=this.backend,l=0;l<r;l++){var u=this.maybe_get(oe,t[l+i]);if(c&&u&&u.base_expression&&u.base_expression===a)console.assert(""!==u.expression&&"."===u.expression.charAt(0)),s+=u.expression.substring(1),_=!0;else{_?(p.swizzle_is_function&&(s+="()"),s=this.remove_duplicate_swizzle(s)||this.remove_unity_swizzle(a,s)||s,_=!1,o+=s=this.strip_enclosed_expression(s)):o+=s,l&&(o+=", ");var h=n.basetype===L.Struct&&this.has_member_decoration(n.self,l,te.DecorationOffset);s=this.to_composite_constructor_expression(t[l+i],h)}a=u?u.base_expression:0}return _&&(p.swizzle_is_function&&(s+="()"),s=this.remove_duplicate_swizzle(s)||this.remove_unity_swizzle(a,s)||s,s=this.strip_enclosed_expression(s)),o+=s},i.prototype.remove_duplicate_swizzle=function(e){var t=e.lastIndexOf(".");if(t<=0)return null;var i=e.substring(t+1);if(this.backend.swizzle_is_function){if(i.length<2)return null;if("()"!==i.substring(i.length-2))return null;i.substring(0,i.length-2)}for(var r=0;r<i.length;r++)if(r>=4||i[r]!==Ut[r])return null;var a=e.lastIndexOf(".",t-1);if(a<0)return e;for(r=++a;r<t;r++)if(e[r]<"w"||e[r]>"z"){if(this.backend.swizzle_is_function&&r+2===t&&"("===e[r]&&")"===e[r+1])break;return null}return t-a>=i.length&&(e=e.substring(0,a+i.length),this.backend.swizzle_is_function&&(e+="()")),e},i.prototype.remove_unity_swizzle=function(e,t){var i=t.indexOf(".");if(i<=0)return null;var r=t.substring(i+1);if(this.backend.swizzle_is_function){if(r.length<2)return null;if("()"!==r.substring(r.length-2))return null;r=r.substring(0,r.length-2)}for(var a=0;a<r.length;a++)if(a>=4||r[a]!==Ut[a])return null;var o=this.expression_type(e);return console.assert(1===o.columns&&0===o.array.length),o.vecsize===r.length&&(t=t.substring(0,i)),t},i.prototype.replace_illegal_names=function(e){var t=this;void 0===e&&(e=Vt);var i=this.ir;i.for_each_typed_id(E,(function(r,a){if(!t.is_hidden_variable(a)){var o=i.find_meta(a.self);if(o){var s=o.decoration;e.has(s.alias)&&(s.alias="_"+s.alias)}}})),i.for_each_typed_id(j,(function(t,r){var a=i.find_meta(r.self);if(a){var o=a.decoration;e.has(o.alias)&&(o.alias="_"+o.alias)}})),i.for_each_typed_id(w,(function(t,r){var a=i.find_meta(r.self);if(a){var o=a.decoration;e.has(o.alias)&&(o.alias="_"+o.alias);for(var s=0,n=a.members;s<n.length;s++){var c=n[s];e.has(c.alias)&&(c.alias="_"+c.alias)}}}))},i.prototype.emit_entry_point_declarations=function(){},i.prototype.replace_fragment_output=function(e){var t=this.ir,i=et(x,t.meta,e.self).decoration,r=0;i.decoration_flags.get(te.DecorationLocation)&&(r=i.location);var a=this.get(w,e.basetype);if(0===a.array.length)i.alias="gl_FragData[".concat(r,"]"),this.is_legacy_es()&&0!==r&&this.require_extension_internal("GL_EXT_draw_buffers");else{if(1!==a.array.length)throw new Error("Array-of-array output variable used. This cannot be implemented in legacy GLSL.");if(i.alias="gl_FragData",0!==r)throw new Error("Arrayed output variable used, but location is not 0. This is unimplemented in SPIRV-Cross.");this.is_legacy_es()&&this.require_extension_internal("GL_EXT_draw_buffers")}e.compat_builtin=!0},i.prototype.replace_fragment_outputs=function(){var e=this;this.ir.for_each_typed_id(E,(function(t,i){var r=e.get(w,i.basetype);e.is_builtin_variable(i)||i.remapped_variable||!r.pointer||i.storage!==v.StorageClassOutput||e.replace_fragment_output(i)}))},i.prototype.legacy_tex_op=function(e,t,i){var r,a=this.options;switch(t.image.dim){case Ge.Dim1D:r=t.image.arrayed&&!a.es?"1DArray":"1D";break;case Ge.Dim2D:r=t.image.arrayed&&!a.es?"2DArray":"2D";break;case Ge.Dim3D:r="3D";break;case Ge.DimCube:r="Cube";break;case Ge.DimRect:r="2DRect";break;case Ge.DimBuffer:r="Buffer";break;case Ge.DimSubpassData:r="2D";break;default:r=""}var o=!1,s=this.get_entry_point();if("textureGrad"!==e&&"textureProjGrad"!==e&&("textureLod"!==e&&"textureProjLod"!==e||s.model===Se.ExecutionModelVertex)||(this.is_legacy_es()?(o=!0,this.require_extension_internal("GL_EXT_shader_texture_lod")):this.is_legacy_desktop()&&this.require_extension_internal("GL_ARB_shader_texture_lod")),"textureLodOffset"===e||"textureProjLodOffset"===e){if(this.is_legacy_es())throw new Error(e+" not allowed in legacy ES");this.require_extension_internal("GL_EXT_gpu_shader4")}var n=this.is_depth_image(t,i);if(n&&this.is_legacy_es()){if("texture"!==e&&"textureProj"!==e)throw new Error(e+" not allowed on depth samplers in legacy ES");this.require_extension_internal("GL_EXT_shadow_samplers")}if("textureSize"===e){if(this.is_legacy_es())throw new Error("textureSize not supported in legacy ES");if(n)throw new Error("textureSize not supported on shadow sampler in legacy GLSL");this.require_extension_internal("GL_EXT_gpu_shader4")}if("texelFetch"===e&&this.is_legacy_es())throw new Error("texelFetch not supported in legacy ES");var c=this.is_legacy_es()&&n,_=n?"shadow":"texture";if("texture"===e)return c?_+r+"EXT":_+r;if("textureLod"===e)return _+r+o?"LodEXT":"Lod";if("textureProj"===e)return _+r+c?"ProjEXT":"Proj";if("textureGrad"===e)return _+r+this.is_legacy_es()?"GradEXT":this.is_legacy_desktop()?"GradARB":"Grad";if("textureProjLod"===e)return _+r+o?"ProjLodEXT":"ProjLod";if("textureLodOffset"===e)return _+r+"LodOffset";if("textureProjGrad"===e)return _+r+this.is_legacy_es()?"ProjGradEXT":this.is_legacy_desktop()?"ProjGradARB":"ProjGrad";if("textureProjLodOffset"===e)return _+r+"ProjLodOffset";if("textureSize"===e)return"textureSize"+r;if("texelFetch"===e)return"texelFetch"+r;throw new Error("Unsupported legacy texture op: "+e)},i.prototype.load_flattened_struct=function(e,t){var i=this.type_to_glsl_constructor(t);i+="(";for(var r=0;r<t.member_types.length;r++){r&&(i+=", ");var a=this.get(w,t.member_types[r]);a.basetype===L.Struct?i+=this.load_flattened_struct(this.to_flattened_struct_member(e,t,r),a):i+=this.to_flattened_struct_member(e,t,r)}return i+=")"},i.prototype.to_flattened_struct_member=function(e,t,i){var r=e+"_"+this.to_member_name(t,i);return de.sanitize_underscores(r),r},i.prototype.store_flattened_struct=function(e,t,i,r){if("number"!=typeof e){var a=Array.from(r);a.push(0);for(var o=i,s=0;s<r.length;++s){var n=r[s];o=this.get(w,o.member_types[n])}for(s=0;s<o.member_types.length;s++){a[a.length-1]=s;var c=de.sanitize_underscores(e+"_"+this.to_member_name(o,s));if(this.get(w,o.member_types[s]).basetype===L.Struct)this.store_flattened_struct(c,t,i,a);else{var _=this.to_expression(t)+this.to_multi_member_reference(i,a);this.statement(c," = ",_,";")}}}else{var p=e,l=t,u=this.expression_type(p),h=this.to_flattened_access_chain_expression(p);this.store_flattened_struct(h,l,u,[])}},i.prototype.to_flattened_access_chain_expression=function(e){var t,i=this.maybe_get(E,e);if(i)t=this.to_name(i.self);else{var r=this.maybe_get(oe,e);t=r?r.expression:this.to_expression(e)}return t},i.prototype.track_expression_read=function(e){switch(this.ir.ids[e].get_type()){case t.TypeExpression:for(var i=0,r=this.get(oe,e).implied_read_expressions;i<r.length;i++){var a=r[i];this.track_expression_read(a)}break;case t.TypeAccessChain:for(var o=0,s=this.get(ne,e).implied_read_expressions;o<s.length;o++){a=s[o];this.track_expression_read(a)}}if(this.expression_is_forwarded(e)&&!this.expression_suppresses_usage_tracking(e)){var n=et(0,this.expression_usage_counts,e);n++,this.expression_read_implies_multiple_reads(e)&&n++,n>=2&&(this.forced_temporaries.add(e),this.force_recompile())}},i.prototype.request_workaround_wrapper_overload=function(e){this.workaround_ubo_load_overload_types.indexOf(e)<0&&(this.force_recompile(),this.workaround_ubo_load_overload_types.push(e))},i.prototype.rewrite_load_for_wrapped_row_major=function(e,t,i){var r=this.maybe_get_backing_variable(i);if(!r)return e;var a=this.get(w,r.basetype);if(!(a.basetype===L.Struct&&a.storage===v.StorageClassUniform&&this.has_decoration(a.self,te.DecorationBlock)))return e;var o=this.get(w,t),s=!1;if(this.is_matrix(o)&&(o=a),o.basetype===L.Struct)for(var n=0;n<o.member_types.length;n++)if(this.combined_decoration_for_member(o,n).get(te.DecorationRowMajor)){s=!0;break}return s&&(this.request_workaround_wrapper_overload(t),e="spvWorkaroundRowMajor("+e+")"),e},i.prototype.is_legacy=function(){var e=this.options;return e.es&&e.version<300||!e.es&&e.version<130},i.prototype.is_legacy_es=function(){var e=this.options;return e.es&&e.version<300},i.prototype.is_legacy_desktop=function(){var e=this.options;return!e.es&&e.version<130},i.prototype.register_impure_function_call=function(){for(var e=0,t=this.global_variables;e<t.length;e++){var i=t[e];this.flush_dependees(this.get(E,i))}for(var r=0,a=this.aliased_variables;r<a.length;r++){var o=a[r];this.flush_dependees(this.get(E,o))}},i.prototype.register_control_dependent_expression=function(e){this.forwarded_temporaries.has(e)&&(console.assert(this.current_emitting_block),this.current_emitting_block.invalidate_expressions.push(e))},i.prototype.args_will_forward=function(e,t,i,r,a){if(this.forced_temporaries.has(e))return!1;for(var o=0;o<r;o++)if(!this.should_forward(t[o+i]))return!1;if(!a){for(var s=0,n=this.global_variables;s<n.length;s++){var c=n[s];if(!this.should_forward(c))return!1}for(var _=0,p=this.aliased_variables;_<p.length;_++){var l=p[_];if(!this.should_forward(l))return!1}}return!0},i.prototype.register_call_out_argument=function(e){this.register_write(e);var t=this.maybe_get(E,e);t&&this.flush_variable_declaration(t.self)},i.prototype.pls_decl=function(e){var t=this.get(E,e.id),i=new w;return i.vecsize=Yt(e.format),i.basetype=function(e){switch(e){case Ve.PlsRGBA8I:case Ve.PlsRG16I:return L.Int;case Ve.PlsRGB10A2UI:case Ve.PlsRGBA8UI:case Ve.PlsRG16UI:case Ve.PlsR32UI:return L.UInt;default:return L.Float}}(e.format),function(e){switch(e){case Ve.PlsR11FG11FB10F:return"layout(r11f_g11f_b10f) ";case Ve.PlsR32F:return"layout(r32f) ";case Ve.PlsRG16F:return"layout(rg16f) ";case Ve.PlsRGB10A2:return"layout(rgb10_a2) ";case Ve.PlsRGBA8:return"layout(rgba8) ";case Ve.PlsRG16:return"layout(rg16) ";case Ve.PlsRGBA8I:return"layout(rgba8i)";case Ve.PlsRG16I:return"layout(rg16i) ";case Ve.PlsRGB10A2UI:return"layout(rgb10_a2ui) ";case Ve.PlsRGBA8UI:return"layout(rgba8ui) ";case Ve.PlsRG16UI:return"layout(rg16ui) ";case Ve.PlsR32UI:return"layout(r32ui) ";default:return""}}(e.format)+this.to_pls_qualifiers_glsl(t)+this.type_to_glsl(i)+" "+this.to_name(t.self)},i.prototype.to_pls_qualifiers_glsl=function(e){return et(x,this.ir.meta,e.self).decoration.decoration_flags.get(te.DecorationRelaxedPrecision)?"mediump ":"highp "},i.prototype.emit_pls=function(){var e=this.get_entry_point(),t=this.options;if(e.model!==Se.ExecutionModelFragment)throw new Error("Pixel local storage only supported in fragment shaders.");if(!t.es)throw new Error("Pixel local storage only supported in OpenGL ES.");if(t.version<300)throw new Error("Pixel local storage only supported in ESSL 3.0 and above.");if(this.pls_inputs.length>0){this.statement("__pixel_local_inEXT _PLSIn"),this.begin_scope();for(var i=0,r=this.pls_inputs;i<r.length;i++){var a=r[i];this.statement(this.pls_decl(a),";")}this.end_scope_decl(),this.statement("")}if(this.pls_outputs.length>0){this.statement("__pixel_local_outEXT _PLSOut"),this.begin_scope();for(var o=0,s=this.pls_outputs;o<s.length;o++){var n=s[o];this.statement(this.pls_decl(n),";")}this.end_scope_decl(),this.statement("")}},i.prototype.remap_pls_variables=function(){for(var e=0,t=this.pls_inputs;e<t.length;e++){var i=t[e],r=!1;if((s=this.get(E,i.id)).storage===v.StorageClassUniformConstant)r=this.get(w,s.basetype).image.dim===Ge.DimSubpassData;if(s.storage!==v.StorageClassInput&&!r)throw new Error("Can only use in and target variables for PLS inputs.");s.remapped_variable=!0}for(var a=0,o=this.pls_outputs;a<o.length;a++){var s,n=o[a];if((s=this.get(E,n.id)).storage!==v.StorageClassOutput)throw new Error("Can only use out variables for PLS outputs.");s.remapped_variable=!0}},i.prototype.location_is_framebuffer_fetch=function(e){return!!this.inout_color_attachments.find((function(t){return t.first===e}))},i.prototype.location_is_non_coherent_framebuffer_fetch=function(e){return!!this.inout_color_attachments.find((function(t){return t.first===e&&!t.second}))},i.prototype.subpass_input_is_framebuffer_fetch=function(e){if(!this.has_decoration(e,te.DecorationInputAttachmentIndex))return!1;for(var t=this.get_decoration(e,te.DecorationInputAttachmentIndex),i=0,r=this.subpass_to_framebuffer_fetch_attachment;i<r.length;i++){if(r[i].first===t)return!0}return!1},i.prototype.emit_inout_fragment_outputs_copy_to_subpass_inputs=function(){for(var e=this,t=function(t){var r=i.find_subpass_input_by_attachment_index(t.first),a=i.find_color_output_by_location(t.second);if(!r)return"continue";if(!a)throw new Error("Need to declare the corresponding fragment output variable to be able to read from it.");if(i.is_array(i.get(w,a.basetype)))throw new Error("Cannot use GL_EXT_shader_framebuffer_fetch with arrays of color outputs.");i.get(j,i.get_entry_point().self).fixup_hooks_in.push((function(){if(e.is_legacy())e.statement(e.to_expression(r.self)," = ","gl_LastFragData[",e.get_decoration(a.self,te.DecorationLocation),"];");else{var t=e.get(w,a.basetype).vecsize;e.statement(e.to_expression(r.self),e.vector_swizzle(t,0)," = ",e.to_expression(a.self),";")}}))},i=this,r=0,a=this.subpass_to_framebuffer_fetch_attachment;r<a.length;r++){t(a[r])}},i.prototype.find_subpass_input_by_attachment_index=function(e){var t=this,i=null;return this.ir.for_each_typed_id(E,(function(r,a){t.has_decoration(a.self,te.DecorationInputAttachmentIndex)&&t.get_decoration(a.self,te.DecorationInputAttachmentIndex)===e&&(i=a)})),i},i.prototype.find_color_output_by_location=function(e){var t=this,i=null;return this.ir.for_each_typed_id(E,(function(r,a){a.storage===v.StorageClassOutput&&t.get_decoration(a.self,te.DecorationLocation)===e&&(i=a)})),i},i.prototype.add_variable=function(e,t,i){return""===i?i:(i=de.sanitize_underscores(i),de.is_globally_reserved_identifier(i,!0)?i="":this.update_name_cache(e,t,i))},i.prototype.check_function_call_constraints=function(e,t,i){for(var r=0;r<i;r++){var a=this.maybe_get(E,e[t+r]);if(a&&a.remapped_variable){var o=this.get(w,a.basetype);if(o.basetype===L.Image&&o.image.dim===Ge.DimSubpassData)throw new Error("Tried passing a remapped subpassInput variable to a function. This will not work correctly because type-remapping information is lost. To workaround, please consider not passing the subpass input as a function parameter, or use in/out variables instead which do not need type remapping information.")}}},i.prototype.handle_invalid_expression=function(e){this.forced_temporaries.add(e),this.force_recompile()},i.prototype.init=function(){var e=this.ir,t=this.options;e.source.known&&(t.es=e.source.es,t.version=e.source.version)},i.prototype.compile=function(){var e=this.ir,t=this.options,i=this.backend;e.fixup_reserved_names(),i.nonuniform_qualifier="",i.needs_row_major_load_workaround=!0,i.allow_precision_qualifiers=t.es,i.force_gl_in_out_block=!0,i.supports_extensions=!0,i.use_array_constructor=!0,i.workgroup_size_is_hidden=!0,i.support_precise_qualifier=!t.es&&t.version>=400||t.es&&t.version>=320,this.is_legacy_es()&&(i.support_case_fallthrough=!1),this.fixup_type_alias(),this.reorder_type_alias(),this.build_function_control_flow_graphs_and_analyze(),this.find_static_extensions(),this.fixup_image_load_store_access(),this.update_active_builtins(),this.analyze_image_and_sampler_usage(),this.analyze_interlocked_resource_usage(),this.inout_color_attachments.length>0&&this.emit_inout_fragment_outputs_copy_to_subpass_inputs(),e.addressing_model===$.AddressingModelPhysicalStorageBuffer64EXT&&this.analyze_non_block_pointer_types();var r=0;do{if(r>=3)throw new Error("Over 3 compilation loops detected. Must be a bug!");this.reset(),this.buffer.reset(),this.emit_header(),this.emit_resources(),this.emit_extension_workarounds(this.get_execution_model()),this.emit_function(this.get(j,e.default_entry_point),new y),r++}while(this.is_forcing_recompilation());return this.get_entry_point().name="main",this.fixup_removed_structs()},i.prototype.fixup_removed_structs=function(){var e=this,t=this.buffer.str();return this.removed_structs.forEach((function(i){var r=new RegExp(e.to_name(i)+"\\.","g");t=t.replace(r,"")})),t},i.prototype.find_static_extensions=function(){var e=this,t=this.ir,i=this.options;t.for_each_typed_id(w,(function(t,r){if(r.basetype===L.Double){if(i.es)throw new Error("FP64 not supported in ES profile.");!i.es&&i.version<400&&e.require_extension_internal("GL_ARB_gpu_shader_fp64")}else if(r.basetype===L.Int64||r.basetype===L.UInt64){if(i.es)throw new Error("64-bit integers not supported in ES profile.");i.es||e.require_extension_internal("GL_ARB_gpu_shader_int64")}else r.basetype===L.Half?e.require_extension_internal("GL_EXT_shader_explicit_arithmetic_types_float16"):r.basetype===L.SByte||r.basetype===L.UByte?e.require_extension_internal("GL_EXT_shader_explicit_arithmetic_types_int8"):r.basetype!==L.Short&&r.basetype!==L.UShort||e.require_extension_internal("GL_EXT_shader_explicit_arithmetic_types_int16")}));var r=this.get_entry_point();switch(r.model){case Se.ExecutionModelGLCompute:throw new Error("Compute shaders are not supported!");case Se.ExecutionModelGeometry:throw new Error("Geometry shaders are not supported!");case Se.ExecutionModelTessellationEvaluation:case Se.ExecutionModelTessellationControl:throw new Error("Tessellation shaders are not supported!");case Se.ExecutionModelRayGenerationKHR:case Se.ExecutionModelIntersectionKHR:case Se.ExecutionModelAnyHitKHR:case Se.ExecutionModelClosestHitKHR:case Se.ExecutionModelMissKHR:case Se.ExecutionModelCallableKHR:}if(0!==this.pls_inputs.length||0!==this.pls_outputs.length){if(r.model!==Se.ExecutionModelFragment)throw new Error("Can only use GL_EXT_shader_pixel_local_storage in fragment shaders.");this.require_extension_internal("GL_EXT_shader_pixel_local_storage")}if(0!==this.inout_color_attachments.length){if(r.model!==Se.ExecutionModelFragment)throw new Error("Can only use GL_EXT_shader_framebuffer_fetch in fragment shaders.");for(var a=!1,o=!1,s=0,n=this.inout_color_attachments;s<n.length;s++){n[s].second?a=!0:o=!0}a&&this.require_extension_internal("GL_EXT_shader_framebuffer_fetch"),o&&this.require_extension_internal("GL_EXT_shader_framebuffer_fetch_non_coherent")}if(i.separate_shader_objects&&!i.es&&i.version<410&&this.require_extension_internal("GL_ARB_separate_shader_objects"),t.addressing_model===$.AddressingModelPhysicalStorageBuffer64EXT)throw new Error("GL_EXT_buffer_reference is only supported in Vulkan GLSL.");if(t.addressing_model!==$.AddressingModelLogical)throw new Error("Only Logical and PhysicalStorageBuffer64EXT addressing models are supported.");for(var c=0,_=t.declared_capabilities;c<_.length;c++){switch(_[c]){case Le.CapabilityShaderNonUniformEXT:throw new Error("CapabilityShaderNonUniformEXT not supported");case Le.CapabilityRuntimeDescriptorArrayEXT:throw new Error("CapabilityRuntimeDescriptorArrayEXT not supported");case Le.CapabilityGeometryShaderPassthroughNV:throw new Error("GeometryShaderPassthroughNV capability not supported");case Le.CapabilityVariablePointers:case Le.CapabilityVariablePointersStorageBuffer:throw new Error("VariablePointers capability is not supported in GLSL.");case Le.CapabilityMultiView:throw new Error("MultiView capability is not supported in GLSL.");case Le.CapabilityRayQueryKHR:throw new Error("RayQuery capability is not supported.");case Le.CapabilityRayTraversalPrimitiveCullingKHR:throw new Error("RayTraversalPrimitiveCulling capability is not supported.")}}if(i.ovr_multiview_view_count)throw new Error("OVR_multiview2 is not supported")},i.prototype.emit_for_loop_initializers=function(e){if(0===e.loop_variables.length)return"";for(var i=this.ir,r=this.for_loop_initializers_are_same_type(e),a=0,o=0,s=e.loop_variables;o<s.length;o++){var n=s[o];0!==(c=this.get(E,n).static_expression)&&i.ids[c].get_type()!==t.TypeUndef||a++}if(1===e.loop_variables.length&&0===a)return this.variable_decl(this.get(E,e.loop_variables[0]));if(r&&a!==e.loop_variables.length){for(var c="",_=0,p=e.loop_variables;_<p.length;_++){m=p[_];var l=this.get(E,m).static_expression;if(0===l||i.ids[l].get_type()===t.TypeUndef)this.statement(this.variable_decl(this.get(E,m)),";");else{var u=this.get(E,m),h=this.get_variable_data_type(u);""===c?c=this.to_qualifiers_glsl(u.self)+this.type_to_glsl(h)+" ":(c+=", ",h.pointer&&(c+="* ")),c+=this.to_name(m)+" = "+this.to_pointer_expression(u.static_expression)}}return c}for(var d=0,f=e.loop_variables;d<f.length;d++){var m=f[d];this.statement(this.variable_decl(this.get(E,m)),";")}return""},i.prototype.emit_while_loop_initializers=function(e){for(var t=0,i=e.loop_variables;t<i.length;t++){var r=i[t],a=this.get(E,r);this.statement(this.variable_decl(a),";")}},i.prototype.for_loop_initializers_are_same_type=function(e){if(e.loop_variables.length<=1)return!0;for(var i=this.ir,r=0,a=new y,o=0,s=e.loop_variables;o<s.length;o++){var n=s[o],c=this.get(E,n).static_expression;if(0!==c&&i.ids[c].get_type()!==t.TypeUndef){if(0===r)r=this.get(E,n).basetype,h(this.get_decoration_bitset(n),a);else if(r!==this.get(E,n).basetype)return!1;if(!a.equals(this.get_decoration_bitset(n)))return!1}}return!0},i.prototype.optimize_read_modify_write=function(e,t,i){if(i.length<t.length+3)return!1;if(e.vecsize>1&&e.columns>1)return!1;if(0!==i.indexOf(t))return!1;for(var r=-1,a=t.length+1;a<i.length;++a){var o=i.charAt(a);if("+"===o||"-"===o||"/"===o||"*"===o||"%"===o||"|"===o||"&"===o||"^"===o){r=a;break}}if(r!==t.length+1)return!1;if(" "!==i.charAt(r+1))return!1;var s=i.charAt(r),n=i.substring(t.length+3);return"+"!==s&&"-"!==s||"1"!==n&&"uint(1)"!==n&&"1u"!==n&&"int(1u)"!==n?this.statement(t," ",s,"= ",n,";"):this.statement(t,s,s,";"),!0},i.prototype.fixup_image_load_store_access=function(){var e=this;this.options.enable_storage_image_qualifier_deduction&&this.ir.for_each_typed_id(E,(function(t,i){var r=e.expression_type(t);if(r.basetype===L.Image&&2===r.image.sampled){var a=et(x,e.ir.meta,t).decoration.decoration_flags;a.get(te.DecorationNonWritable)||a.get(te.DecorationNonReadable)||(a.set(te.DecorationNonWritable),a.set(te.DecorationNonReadable))}}))},i.prototype.type_is_empty=function(e){return e.basetype===L.Struct&&0===e.member_types.length},i.prototype.declare_undefined_values=function(){var e=this,t=!1;this.ir.for_each_typed_id(ce,(function(i,r){var a=e.get(w,r.basetype);if(a.basetype!==L.Void){var o="";e.options.force_zero_initialized_variables&&e.type_can_zero_initialize(a)&&(o=" = "+e.to_zero_initialized_expression(r.basetype)),e.statement(e.variable_decl(a,e.to_name(r.self),r.self),o,";"),t=!0}})),t&&this.statement("")},i.prototype.can_use_io_location=function(e,t){var i=this.options;if(this.get_execution_model()!==Se.ExecutionModelVertex&&e===v.StorageClassInput||this.get_execution_model()!==Se.ExecutionModelFragment&&e===v.StorageClassOutput){var r=t?440:410;if(!i.es&&i.version<r&&!i.separate_shader_objects)return!1;if(i.es&&i.version<310)return!1}if(this.get_execution_model()===Se.ExecutionModelVertex&&e===v.StorageClassInput||this.get_execution_model()===Se.ExecutionModelFragment&&e===v.StorageClassOutput){if(i.es&&i.version<300)return!1;if(!i.es&&i.version<330)return!1}if(e===v.StorageClassUniform||e===v.StorageClassUniformConstant||e===v.StorageClassPushConstant){if(i.es&&i.version<310)return!1;if(!i.es&&i.version<430)return!1}return!0},i.prototype.convert_half_to_string=function(e,t,i){var r,a=e.scalar_f16(t,i);if(isNaN(a)||a===Number.POSITIVE_INFINITY||a===Number.NEGATIVE_INFINITY){if((o=new w).basetype=L.Half,o.vecsize=1,o.columns=1,a===Number.POSITIVE_INFINITY)r=this.type_to_glsl(o)+"(1.0 / 0.0)";else if(a===Number.NEGATIVE_INFINITY)r=this.type_to_glsl(o)+"(-1.0 / 0.0)";else{if(!isNaN(a))throw new Error("Cannot represent non-finite floating point constant.");r=this.type_to_glsl(o)+"(0.0 / 0.0)"}}else{var o;(o=new w).basetype=L.Half,o.vecsize=1,o.columns=1;var s=le(a);s.indexOf(".")<0&&(s+=".0"),s=this.type_to_glsl(o)+"("+s+")"}return r},i.prototype.convert_float_to_string=function(e,t,i){var r,a=e.scalar_f32(t,i),o=this.backend;if(isNaN(a)||a===Number.POSITIVE_INFINITY||a===Number.NEGATIVE_INFINITY)if(this.is_legacy())if(a===Number.POSITIVE_INFINITY)r=o.float_literal_suffix?"(1.0f / 0.0f)":"(1.0 / 0.0)";else if(a===Number.NEGATIVE_INFINITY)r=o.float_literal_suffix?"(-1.0f / 0.0f)":"(-1.0 / 0.0)";else{if(!isNaN(a))throw new Error("Cannot represent non-finite floating point constant.");r=o.float_literal_suffix?"(0.0f / 0.0f)":"(0.0 / 0.0)"}else{var s=new w,n=new w;s.basetype=L.Float,n.basetype=L.UInt,s.vecsize=1,n.vecsize=1,s.width=32,n.width=32;var c="0x"+e.scalar(t,i)+"u",_="inf";a===Number.NEGATIVE_INFINITY?_="-inf":isNaN(a)&&(_="nan"),r=this.bitcast_glsl_op(s,n)+"(".concat(c," /* ").concat(_," */)")}else(r=le(a)).indexOf(".")<0&&(r+=".0"),o.float_literal_suffix&&(r+="f");return r},i.prototype.convert_double_to_string=function(e,t,i){var r,a=e.scalar_f64(t,i),o=this.options,s=this.backend;if(isNaN(a)||isNaN(a))if(this.is_legacy()){if(o.es)throw new Error("FP64 not supported in ES profile.");if(o.version<400&&this.require_extension_internal("GL_ARB_gpu_shader_fp64"),a===Number.POSITIVE_INFINITY)r=s.double_literal_suffix?"(1.0lf / 0.0lf)":"(1.0 / 0.0)";else if(a===Number.NEGATIVE_INFINITY)r=s.double_literal_suffix?"(-1.0lf / 0.0lf)":"(-1.0 / 0.0)";else{if(!isNaN(a))throw new Error("Cannot represent non-finite floating point constant.");r=s.double_literal_suffix?"(0.0lf / 0.0lf)":"(0.0 / 0.0)"}}else{var n=new w,c=new w;n.basetype=L.Double,c.basetype=L.UInt64,n.vecsize=1,c.vecsize=1,n.width=64,c.width=64;var _=e.scalar_u64(t,i);if(o.es)throw new Error("64-bit integers/float not supported in ES profile.");this.require_extension_internal("GL_ARB_gpu_shader_int64");var p="0x"+_.toString()+s.long_long_literal_suffix?"ull":"ul",l="inf";a===Number.POSITIVE_INFINITY?l="-inf":isNaN(a)&&(l="nan"),r=this.bitcast_glsl_op(n,c)+"(".concat(p," /* ").concat(l," */)")}else(r=le(a)).indexOf(".")<0&&(r+=".0"),s.double_literal_suffix&&(r+="lf");return r},i.prototype.convert_separate_image_to_expression=function(e){var t=this.maybe_get_backing_variable(e);if(t){var i=this.get(w,t.basetype);if(i.basetype===L.Image&&1===i.image.sampled&&i.image.dim!==Ge.DimBuffer){if(!this.dummy_sampler_id)throw new Error("Cannot find dummy sampler ID. Was build_dummy_sampler_for_combined_images() called?");return this.to_combined_image_sampler(e,this.dummy_sampler_id)}}return this.to_non_uniform_aware_expression(e)},i.prototype.cast_to_variable_store=function(e,t,i){var r=this.maybe_get_backing_variable(e);if(r&&(e=r.self),!this.has_decoration(e,te.DecorationBuiltIn))return t;var a=this.get_decoration(e,te.DecorationBuiltIn),o=i.basetype;switch(a){case m.BuiltInLayer:case m.BuiltInPrimitiveId:case m.BuiltInViewportIndex:case m.BuiltInFragStencilRefEXT:case m.BuiltInSampleMask:case m.BuiltInPrimitiveShadingRateKHR:case m.BuiltInShadingRateKHR:o=L.Int}if(o!==i.basetype){var s=i;s.basetype=o,t=this.bitcast_expression(s,i.basetype,t)}return t},i.prototype.cast_from_variable_load=function(e,t,i){if(i.array.length>0)return t;var r=this.maybe_get_backing_variable(e);if(r&&(e=r.self),!this.has_decoration(e,te.DecorationBuiltIn))return t;var a=this.get_decoration(e,te.DecorationBuiltIn),o=i.basetype;switch(a){case m.BuiltInLayer:case m.BuiltInPrimitiveId:case m.BuiltInViewportIndex:case m.BuiltInInstanceId:case m.BuiltInInstanceIndex:case m.BuiltInVertexId:case m.BuiltInVertexIndex:case m.BuiltInSampleId:case m.BuiltInBaseVertex:case m.BuiltInBaseInstance:case m.BuiltInDrawIndex:case m.BuiltInFragStencilRefEXT:case m.BuiltInInstanceCustomIndexNV:case m.BuiltInSampleMask:case m.BuiltInPrimitiveShadingRateKHR:case m.BuiltInShadingRateKHR:o=L.Int;break;case m.BuiltInGlobalInvocationId:case m.BuiltInLocalInvocationId:case m.BuiltInWorkgroupId:case m.BuiltInLocalInvocationIndex:case m.BuiltInWorkgroupSize:case m.BuiltInNumWorkgroups:case m.BuiltInIncomingRayFlagsNV:case m.BuiltInLaunchIdNV:case m.BuiltInLaunchSizeNV:o=L.UInt}return o!==i.basetype&&(t=this.bitcast_expression(i,o,t)),t},i.prototype.unroll_array_from_complex_load=function(e,t,i){if(!this.backend.force_gl_in_out_block)return i;var r=this.maybe_get(E,t);if(!r)return i;if(r.storage!==v.StorageClassInput&&r.storage!==v.StorageClassOutput)return i;var a=this.get_variable_data_type(r);if(0===a.array.length)return i;var o=this.get_decoration(r.self,te.DecorationBuiltIn),s=this.is_builtin_variable(r)&&(o===m.BuiltInPointSize||o===m.BuiltInPosition||o===m.BuiltInSampleMask),n=this.has_decoration(r.self,te.DecorationPatch),c=s&&o===m.BuiltInSampleMask;if(!n&&s){var _="_"+e+"_unrolled";this.statement(this.variable_decl(a,_,e),";");var p=void 0;if(a.array_size_literal[a.array_size_literal.length-1]){var l=a.array[a.array.length-1];if(p=le(l),0===l)throw new Error("Cannot unroll an array copy from unsized array.")}else p=this.to_expression(a.array[a.array.length-1]);if(this.statement("for (int i = 0; i < int(",p,"); i++)"),this.begin_scope(),s&&!c)this.statement(_,"[i] = gl_in[i].",i,";");else if(c){var u=new w;u.basetype=L.Int,this.statement(_,"[i] = ",this.bitcast_expression(u,a.basetype,i+"[i]"),";")}else this.statement(_,"[i] = ",i,"[i];");this.end_scope(),i=_}return i},i.prototype.unroll_array_to_complex_store=function(e,t){if(!this.backend.force_gl_in_out_block)return!1;var i=this.maybe_get(E,e);if(!i||i.storage!==v.StorageClassOutput)return!1;if(!this.is_builtin_variable(i)||this.get_decoration(i.self,te.DecorationBuiltIn)!==m.BuiltInSampleMask)return!1;var r,a=this.expression_type(t);if(a.array_size_literal[a.array_size_literal.length-1]){var o=a.array[a.array.length-1];if(r=le(o),0===o)throw new Error("Cannot unroll an array copy from unsized array.")}else r=this.to_expression(a.array[a.array.length-1]);var s=new w;return s.basetype=L.Int,this.statement("for (int i = 0; i < int(",r,"); i++)"),this.begin_scope(),this.statement(this.to_expression(e),"[i] = ",this.bitcast_expression(s,a.basetype,this.to_expression(t)+"[i]"),";"),this.end_scope(),!0},i.prototype.convert_non_uniform_expression=function(e,t){if("\0"===this.backend.nonuniform_qualifier)return e;var i=this.maybe_get_backing_variable(t);if(!i)return e;if(i.storage!==v.StorageClassUniformConstant&&i.storage!==v.StorageClassStorageBuffer&&i.storage!==v.StorageClassUniform)return e;if(0===this.get(w,i.basetype).array.length)return e;var r=e.indexOf("[");if(r<0)return e;for(var a=-1,o=1,s=r+1;s<e.length;s++)if("]"===e.charAt(s)){if(0==--o){a=s;break}}else"["===e[s]&&o++;return console.assert(0===o),r>=0||a>=0||a<r?e:(r++,e.substring(0,r)+this.backend.nonuniform_qualifier+"("+e.substring(r,a)+")"+e.substring(a))},i.prototype.disallow_forwarding_in_expression_chain=function(e){if(this.expression_is_forwarded(e.self)&&!this.expression_suppresses_usage_tracking(e.self)&&!this.forced_invariant_temporaries.has(e.self)){this.forced_temporaries.add(e.self),this.forced_invariant_temporaries.add(e.self),this.force_recompile();for(var t=0,i=e.expression_dependencies;t<i.length;t++){var r=i[t];this.disallow_forwarding_in_expression_chain(this.get(oe,r))}}},i.prototype.handle_store_to_invariant_variable=function(e,t){if(this.has_decoration(e,te.DecorationInvariant)){var i=this.maybe_get(oe,t);i&&this.disallow_forwarding_in_expression_chain(i)}},i.prototype.expression_is_constant_null=function(e){var t=this.maybe_get(U,e);return!!t&&t.constant_is_null()},i.prototype.expression_is_non_value_type_array=function(e){if(0===this.expression_type(e).array.length)return!1;if(!this.backend.array_is_value_type)return!0;var t=this.maybe_get_backing_variable(e);if(!t)return!1;var i=this.get(w,t.basetype);return!this.backend.buffer_offset_array_is_value_type&&i.basetype===L.Struct&&this.has_member_decoration(i.self,0,te.DecorationOffset)},i.prototype.emit_store_statement=function(e,t){var i=this.to_pointer_expression(t);if(""!==i){if(this.handle_store_to_invariant_variable(e,t),!this.unroll_array_to_complex_store(e,t)){var r=this.to_dereferenced_expression(e);this.has_decoration(e,te.DecorationNonUniform)&&(r=this.convert_non_uniform_expression(r,e)),i=this.cast_to_variable_store(e,i,this.expression_type(t)),this.optimize_read_modify_write(this.expression_type(t),r,i)||this.statement(r," = ",i,";")}this.register_write(e)}},i.prototype.get_integer_width_for_instruction=function(e){if(e.length<3)return 32;var t=this.stream(e);switch(e.op){case ie.OpSConvert:case ie.OpConvertSToF:case ie.OpUConvert:case ie.OpConvertUToF:case ie.OpIEqual:case ie.OpINotEqual:case ie.OpSLessThan:case ie.OpSLessThanEqual:case ie.OpSGreaterThan:case ie.OpSGreaterThanEqual:case ie.OpULessThan:case ie.OpULessThanEqual:case ie.OpUGreaterThan:case ie.OpUGreaterThanEqual:return this.expression_type(t[2]).width;default:var i=this.maybe_get(w,t[0]);return i&&bt(i)?i.width:32}},i.prototype.get_integer_width_for_glsl_instruction=function(e,t,i,r){if(r<1)return 32;switch(e){case Ue.GLSLstd450SAbs:case Ue.GLSLstd450SSign:case Ue.GLSLstd450UMin:case Ue.GLSLstd450SMin:case Ue.GLSLstd450UMax:case Ue.GLSLstd450SMax:case Ue.GLSLstd450UClamp:case Ue.GLSLstd450SClamp:case Ue.GLSLstd450FindSMsb:case Ue.GLSLstd450FindUMsb:return this.expression_type(t[i]).width;default:return 32}},i.prototype.variable_is_lut=function(e){if(e.statically_assigned&&0!==e.static_expression&&e.remapped_variable){var t=this.maybe_get(U,e.static_expression);if(t&&t.is_used_as_lut)return!0}return!1},i.prototype.fixup_type_alias=function(){var e=this,t=this.ir;t.for_each_typed_id(w,(function(i,r){r.type_alias&&(e.has_decoration(r.self,te.DecorationBlock)||e.has_decoration(r.self,te.DecorationBufferBlock)?r.type_alias=0:e.type_is_block_like(r)&&r.self===i&&(t.for_each_typed_id(w,(function(e,t){e!==i&&t.type_alias===r.type_alias&&(t.type_alias=i)})),e.get(w,r.type_alias).type_alias=i,r.type_alias=0))}))},i.prototype.reorder_type_alias=function(){for(var e=this.ir,i=e.create_loop_hard_lock(),r=e.ids_for_type[t.TypeType],a=0,o=r;a<o.length;a++){var s=o[a],n=this.get(w,s);if(0!==n.type_alias&&!this.has_extended_decoration(n.type_alias,b.SPIRVCrossDecorationBufferBlockRepacked)){var c=r.indexOf(n.type_alias);if(console.assert(c>=0),s<c){var _=e.ids_for_constant_or_type,p=_.indexOf(s),l=_.indexOf(c);console.assert(p>=0),console.assert(l>=0),Ht(_,s,c),Ht(_,p,l)}}}i.dispose()},i.prototype.vector_swizzle=function(e,t){return console.assert(e>=1&&e<=4),console.assert(t>=0&&t<4),console.assert(Ft[e-1][t]),Ft[e-1][t]},i}(dt);function Xt(e){switch(e){case Lt.BufferPackingStd140:case Lt.BufferPackingStd430:case Lt.BufferPackingScalar:return!1;default:return!0}}function jt(e){switch(e){case Lt.BufferPackingStd140EnhancedLayout:return Lt.BufferPackingStd140;case Lt.BufferPackingStd430EnhancedLayout:return Lt.BufferPackingStd430;case Lt.BufferPackingScalarEnhancedLayout:return Lt.BufferPackingScalar;default:return e}}function Wt(e){switch(e){case Lt.BufferPackingStd140:case Lt.BufferPackingStd140EnhancedLayout:return!0;default:return!1}}function Qt(e){switch(e){case Lt.BufferPackingScalar:case Lt.BufferPackingScalarEnhancedLayout:return!0;default:return!1}}function Yt(e){switch(e){default:case Ve.PlsR32F:case Ve.PlsR32UI:return 1;case Ve.PlsRG16F:case Ve.PlsRG16:case Ve.PlsRG16UI:case Ve.PlsRG16I:return 2;case Ve.PlsR11FG11FB10F:return 3;case Ve.PlsRGB10A2:case Ve.PlsRGBA8:case Ve.PlsRGBA8I:case Ve.PlsRGB10A2UI:case Ve.PlsRGBA8UI:return 4}}function Zt(e,t,i,r){for(var a=0,o=t;a<o.length;a++){var s=o[a];if(e.has_decoration(s.id,te.DecorationLocation))if(e.get_decoration(s.id,te.DecorationLocation)===i){var n=e.get_type(s.base_type_id);if(n.basetype===L.Struct){e.set_name(s.base_type_id,"SPIRV_Cross_Interface_Location"+i);for(var c=0;c<n.member_types.length;c++)e.set_member_name(s.base_type_id,c,"InterfaceMember"+c)}e.set_name(s.id,r)}}}var Jt,$t=function(e,t){this.id=e,this.format=t};function ei(e,t,i){var r=new Be(t);r.parse();var a=new Kt(r.get_parsed_ir());if(a.get_common_options().specConstPrefix=i.specializationConstantPrefix,0!==e.variable_type_remaps.length){a.set_variable_type_remap_callback((function(t,i){for(var r=0,a=e.variable_type_remaps;r<a.length;r++){var o=a[r];if(i===o.variable_name)return o.new_variable_type}return i}))}for(var o=0,s=e.masked_stage_outputs;o<s.length;o++){var n=s[o];a.mask_stage_output_by_location(n.first,n.second)}for(var c=0,_=e.masked_stage_builtins;c<_.length;c++){n=_[c];a.mask_stage_output_by_builtin(n)}for(var p=0,l=e.entry_point_rename;p<l.length;p++){var u=l[p];a.rename_entry_point(u.old_name,u.new_name,u.execution_model)}var h=a.get_entry_points_and_stages(),d=e.entry,f=Se.ExecutionModelMax;if(e.entry_stage&&e.entry_stage.length>0)if(f=function(e){if("vert"===e)return Se.ExecutionModelVertex;if("frag"===e)return Se.ExecutionModelFragment;if("comp"===e)return Se.ExecutionModelGLCompute;if("tesc"===e)return Se.ExecutionModelTessellationControl;if("tese"===e)return Se.ExecutionModelTessellationEvaluation;if("geom"===e)return Se.ExecutionModelGeometry;throw new Error("Invalid stage!")}(e.entry_stage),d&&""!==d){for(var m=!1,g=0,b=h;g<b.length;g++){if((k=b[g]).execution_model===f&&k.name===d){m=!0;break}}if(!m)throw new Error("Could not find an entry point %s with stage: ".concat(e.entry_stage))}else{for(var y=0,S=h;y<S.length;y++){if((k=S[y]).execution_model===f){d=k.name;break}}if(!d)throw new Error("Could not find an entry point with stage: ".concat(e.entry_stage))}else if(d&&""!==d){for(var I=0,x=0,O=h;x<O.length;x++){var k;(k=O[x]).name===d&&(I++,f=k.execution_model)}if(0===I)throw new Error("There is no entry point with name: ".concat(d));if(I>1)throw new Error("There is more than one entry point with name: ".concat(d,". Use --stage."))}if(d&&""!==d&&a.set_entry_point(d,f),!e.set_version&&!a.get_common_options().version)throw new Error("Didn't specify GLSL version and SPIR-V did not specify language.");var L,E=a.get_common_options();e.set_version&&(E.version=e.version),e.set_es&&(E.es=e.es),E.force_temporary=e.force_temporary,E.separate_shader_objects=e.sso,E.flatten_multidimensional_arrays=e.flatten_multidimensional_arrays,E.enable_420pack_extension=e.use_420pack_extension,E.vertex.fixup_clipspace=e.fixup,E.vertex.flip_vert_y=e.yflip,E.vertex.support_nonzero_base_instance=e.support_nonzero_baseinstance,E.emit_push_constant_as_uniform_buffer=e.glsl_emit_push_constant_as_ubo,E.emit_uniform_buffer_as_plain_uniforms=e.glsl_emit_ubo_as_plain_uniforms,E.force_flattened_io_blocks=e.glsl_force_flattened_io_blocks,E.unnamed_ubo_to_global_uniforms=e.glsl_unnamed_ubo_to_global_uniforms,E.ovr_multiview_view_count=e.glsl_ovr_multiview_view_count,E.emit_line_directives=e.emit_line_directives,E.enable_storage_image_qualifier_deduction=e.enable_storage_image_qualifier_deduction,E.force_zero_initialized_variables=e.force_zero_initialized_variables;for(var C=0,w=e.glsl_ext_framebuffer_fetch;C<w.length;C++){var T=w[C];a.remap_ext_framebuffer_fetch(T.first,T.second,!e.glsl_ext_framebuffer_fetch_noncoherent)}if(e.remove_unused){var D=a.get_active_interface_variables();L=a.get_shader_resources(D),a.set_enabled_interface_variables(D)}else L=a.get_shader_resources();if(e.flatten_ubo){for(var R=0,M=L.uniform_buffers;R<M.length;R++){var B=M[R];a.flatten_buffer_block(B.id)}for(var A=0,N=L.push_constant_buffers;A<N.length;A++){B=N[A];a.flatten_buffer_block(B.id)}}var P=ii(e.pls_in,L.stage_inputs,L.subpass_inputs),G=ii(e.pls_out,L.stage_outputs,null);a.remap_pixel_local_storage(P,G);for(var F=0,z=e.extensions;F<z.length;F++){var U=z[F];a.require_extension(U)}for(var V=0,H=e.remaps;V<H.length;V++){var q=H[V];ti(a,L.stage_inputs,q)||(ti(a,L.stage_outputs,q)||ti(a,L.subpass_inputs,q))}for(var K=0,X=e.interface_variable_renames;K<X.length;K++){if((u=X[K]).storageClass===v.StorageClassInput)Zt(a,L.stage_inputs,u.location,u.variable_name);else{if(u.storageClass!==v.StorageClassOutput)throw new Error("error at --rename-interface-variable <in|out> ...");Zt(a,L.stage_outputs,u.location,u.variable_name)}}a.build_combined_image_samplers(),e.combined_samplers_inherit_bindings&&function(e){for(var t=0,i=e.get_combined_image_samplers();t<i.length;t++){var r=i[t];if(e.has_decoration(r.image_id,te.DecorationDescriptorSet)){var a=e.get_decoration(r.image_id,te.DecorationDescriptorSet);e.set_decoration(r.combined_id,te.DecorationDescriptorSet,a)}if(e.has_decoration(r.image_id,te.DecorationBinding)){var o=e.get_decoration(r.image_id,te.DecorationBinding);e.set_decoration(r.combined_id,te.DecorationBinding,o)}}}(a);for(var j=0,W=a.get_combined_image_samplers();j<W.length;j++){q=W[j];a.set_name(q.combined_id,"SPIRV_Cross_Combined"+a.get_name(q.image_id)+a.get_name(q.sampler_id))}return a.compile()}function ti(e,t,i){var r=t.find((function(e){return e.name===i.src_name}));return!!r&&(e.set_remapped_variable_state(r.id,!0),e.set_name(r.id,i.dst_name),e.set_subpass_input_remapped_components(r.id,i.components),!0)}function ii(e,t,i){for(var r=[],a=0,o=e;a<o.length;a++){for(var s=o[a],n=!1,c=0,_=t;c<_.length;c++){if((u=_[c]).name===s.name){r.push(new $t(u.id,s.format)),n=!0;break}}if(!n&&i)for(var p=0,l=i;p<l.length;p++){var u;if((u=l[p]).name===s.name){r.push(new $t(u.id,s.format)),n=!0;break}}if(!n)throw new Error("Did not find stage input/output/target with name ".concat(s.name))}return r}function ri(e,t){return null==e?t:e}return e.Version=void 0,(Jt=e.Version||(e.Version={}))[Jt.WebGL1=100]="WebGL1",Jt[Jt.WebGL2=300]="WebGL2",e.compile=function(e,t,r){var a=new i;(r=r||{}).removeUnused=ri(r.removeUnused,!0),r.specializationConstantPrefix=ri(r.specializationConstantPrefix,"SPIRV_CROSS_CONSTANT_ID_"),r.unnamed_ubo_to_global_uniforms=ri(r.unnamed_ubo_to_global_uniforms,!0),a.version=t,a.set_version=!0,a.es=!0,a.set_es=!0,a.remove_unused=r.removeUnused,a.glsl_unnamed_ubo_to_global_uniforms=!0;var o=new Uint32Array(e);if(a.reflect&&""!==a.reflect)throw new Error("Reflection not yet supported!");return ei(a,o,r)},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
